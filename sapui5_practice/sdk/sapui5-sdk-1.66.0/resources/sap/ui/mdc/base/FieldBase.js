/*!
 * SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/thirdparty/jquery','sap/ui/Device','sap/ui/mdc/library','./FieldBaseRenderer','./FilterOperatorConfig','./Condition','./type/ConditionType','./type/ConditionsType','sap/ui/core/library','sap/ui/core/Control','sap/base/util/ObjectPath','sap/base/util/deepEqual','sap/base/util/merge','sap/ui/dom/containsOrEquals','sap/ui/model/base/ManagedObjectModel','sap/ui/base/ManagedObjectObserver','sap/ui/events/KeyCodes'],function(q,D,l,F,a,C,b,c,d,f,O,g,m,h,M,j,K){"use strict";var E=l.EditMode;var k=l.FieldDisplay;var V=d.ValueState;var n=d.CalendarType;var o=f.extend("sap.ui.mdc.base.FieldBase",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.mdc",properties:{dataType:{type:"string",group:"Data",defaultValue:'sap.ui.model.type.String'},dataTypeConstraints:{type:"object",group:"Data",defaultValue:null},dataTypeFormatOptions:{type:"object",group:"Data",defaultValue:null},editMode:{type:"sap.ui.mdc.EditMode",group:"Data",defaultValue:E.Editable},required:{type:"boolean",group:"Data",defaultValue:false},display:{type:"sap.ui.mdc.FieldDisplay",defaultValue:k.Value},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:sap.ui.core.TextAlign.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:sap.ui.core.TextDirection.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},multipleLines:{type:"boolean",group:"Appearance",defaultValue:false},maxConditions:{type:"int",group:"Behavior",defaultValue:-1},conditions:{type:"object[]",group:"Data",defaultValue:[],byValue:true},label:{type:"string",group:"Misc",defaultValue:""},_fieldHelpEnabled:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"},_onlyEEQ:{type:"boolean",group:"Appearance",defaultValue:false,visibility:"hidden"}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},contentEdit:{type:"sap.ui.core.Control",multiple:false},contentDisplay:{type:"sap.ui.core.Control",multiple:false},_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},fieldInfo:{type:"sap.ui.mdc.base.FieldInfoBase",multiple:false}},associations:{fieldHelp:{type:"sap.ui.mdc.base.FieldHelpBase",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{liveChange:{parameters:{value:{type:"string"},escPressed:{type:"boolean"},previousValue:{type:"string"}}},press:{}},publicMethods:[],defaultAggregation:"content"},_oManagedObjectModel:null});var p={"default":{edit:"sap/m/Input",editMulti:"sap/m/MultiInput",editMultiLine:"sap/m/TextArea",display:"sap/m/Text",createEdit:U,createEditMulti:X,createEditMultiLine:Y,createDisplay:Z},search:{edit:"sap/m/SearchField",display:"sap/m/Text",createEdit:W,createDisplay:Z},date:{edit:"sap/m/DatePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:$,createEditMulti:X,createDisplay:Z},time:{edit:"sap/m/TimePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:$,createEditMulti:X,createDisplay:Z},dateTime:{edit:"sap/m/DateTimePicker",editMulti:"sap/m/MultiInput",display:"sap/m/Text",createEdit:$,createEditMulti:X,createDisplay:Z},link:{edit:"sap/m/Input",editMulti:"sap/m/MultiInput",editMultiLine:"sap/m/TextArea",display:"sap/m/Link",createEdit:U,createEditMulti:X,createEditMultiLine:Y,createDisplay:a1},bool:{edit:"sap/m/Input",display:"sap/m/Text",createEdit:b1,createDisplay:Z}};var r={};var s={bool:{name:"sap/ui/mdc/base/BoolFieldHelp",id:"BoolDefaultHelp",control:undefined}};o.prototype.init=function(){this._oManagedObjectModel=new M(this);this._oObserver=new j(this._observeChanges.bind(this));this._oObserver.observe(this,{properties:["display","editMode","dataType","multipleLines","maxConditions","conditions","_onlyEEQ"],aggregations:["fieldInfo","content","contentEdit","contentDisplay"],associations:["fieldHelp"]});this._oDatePickerRequested={};this.attachEvent("modelContextChange",this._handleModelContextChange,this);};o.prototype.exit=function(){var e=this.getFieldInfo();if(e){e.detachEvent("dataUpdate",x1,this);}var i=this.getContent();if(i){Q.call(this,i);}var B1=this.getContentEdit();if(B1){Q.call(this,B1);}var C1=this.getContentDisplay();if(C1){Q.call(this,C1);}this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;this._oObserver.disconnect();this._oObserver=undefined;if(this._oFilterOperatorConfig){this._oFilterOperatorConfig.destroy();delete this._oFilterOperatorConfig;}if(this._oConditionType){this._oConditionType.destroy();this._oConditionType=undefined;}if(this._oConditionsType){this._oConditionsType.destroy();this._oConditionsType=undefined;}var D1=I.call(this);if(D1){D1.removeFilterField(this);}var E1=n1.call(this);if(E1){E1.detachEvent("dataUpdate",s1,this);if(this._bConnected){t1.call(this);E1.connect();}}if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);}};o.prototype.onBeforeRendering=function(){R.call(this);};o.prototype.onAfterRendering=function(){if(n1.call(this)&&this.getEditMode()!=E.Display){var e=this.getAggregation("_content");if(e){var i=e.getFocusDomRef();q(i).attr("autocomplete","off");}}};o.prototype.onfocusin=function(e){u1.call(this);};o.prototype.onsapup=function(e){var i=n1.call(this);if(i){e.preventDefault();e.stopPropagation();i.navigate(-1);}};o.prototype.onsapdown=function(e){var i=n1.call(this);if(i){e.preventDefault();e.stopPropagation();i.navigate(1);}};o.prototype.clone=function(i,e){this.detachEvent("modelContextChange",this._handleModelContextChange,this);var B1=this.getContent();if(B1){Q.call(this,B1);}var C1=this.getContentEdit();if(C1){Q.call(this,C1);}var D1=this.getContentDisplay();if(D1){Q.call(this,D1);}var E1=this.getFieldInfo();if(E1){E1.detachEvent("dataUpdate",x1,this);}var F1=f.prototype.clone.apply(this,arguments);this.attachEvent("modelContextChange",this._handleModelContextChange,this);if(B1){P.call(this,B1);}if(C1){P.call(this,C1);}if(D1){P.call(this,D1);}if(E1){E1.attachEvent("dataUpdate",x1,this);}return F1;};o.prototype.getFieldPath=function(){var e=this.getBindingPath("conditions");if(e&&e.startsWith("/conditions/")){return e.slice(12);}else{return"";}};o.prototype._fireChange=function(e,i,B1){};o.mapEdmTypes={"Edm.Boolean":"sap.ui.model.odata.type.Boolean","Edm.Byte":"sap.ui.model.odata.type.Byte","Edm.Date":"sap.ui.model.odata.type.Date","Edm.DateTime":"sap.ui.model.odata.type.DateTime","Edm.DateTimeOffset":"sap.ui.model.odata.type.DateTimeOffset","Edm.Decimal":"sap.ui.model.odata.type.Decimal","Edm.Double":"sap.ui.model.odata.type.Double","Edm.Float":"sap.ui.model.odata.type.Single","Edm.Guid":"sap.ui.model.odata.type.Guid","Edm.Int16":"sap.ui.model.odata.type.Int16","Edm.Int32":"sap.ui.model.odata.type.Int32","Edm.Int64":"sap.ui.model.odata.type.Int64","Edm.SByte":"sap.ui.model.odata.type.SByte","Edm.Single":"sap.ui.model.odata.type.Single","Edm.String":"sap.ui.model.odata.type.String","Edm.Time":"sap.ui.model.odata.type.Time","Edm.TimeOfDay":"sap.ui.model.odata.type.TimeOfDay"};function _(e){var i=t.call(this,e);if(i){return new i(x.call(this,e,this.getDataTypeFormatOptions(),this.getDataTypeConstraints()),this.getDataTypeConstraints());}else{return null;}}function t(e){var i;while(!i){i=O.get(e||"");if(!i){e=o.mapEdmTypes[e];if(!e){break;}}}return i;}function u(){if(!this._oDataType){this._oDataType=this.getDataType();if(typeof this._oDataType==="string"){this._oDataType=_.call(this,this._oDataType);}}return this._oDataType;}o.prototype._initDataType=function(){if(this._oDataType){this._oDataType.destroy();this._oDataType=undefined;}if(this._oDateOriginalType){this._oDateOriginalType.destroy();this._oDateOriginalType=undefined;}};o.prototype._getDataType=function(){return u.call(this);};function v(){if(this._oDataType&&typeof this._oDataType==="object"){return this._oDataType.getMetadata().getName();}else{return this.getDataType();}}function w(){if(this._oDataType&&typeof this._oDataType==="object"&&this._oDataType.oConstraints){return this._oDataType.oConstraints;}else{return this.getDataTypeConstraints();}}function x(e,i,B1){if(this.getMaxConditions()!==1||this.getEditMode()===E.Display){return i;}switch(e){case"Edm.Date":case"sap.ui.model.type.Date":case"sap.ui.model.odata.type.Date":this._sValueFormat="yyyy-MM-dd";break;case"Edm.DateTime":case"sap.ui.model.odata.type.DateTime":if(B1&&(B1.displayFormat==="Date"||B1.isDateOnly)){this._sValueFormat="yyyy-MM-dd";}else{this._sValueFormat="yyyy-MM-dd'T'HH:mm:ss";}break;case"Edm.DateTimeOffset":case"sap.ui.model.type.DateTime":case"sap.ui.model.odata.type.DateTimeOffset":this._sValueFormat="yyyy-MM-dd'T'HH:mm:ss";break;case"Edm.TimeOfDay":case"sap.ui.model.type.Time":case"sap.ui.model.odata.type.TimeOfDay":this._sValueFormat="HH:mm:ss";break;default:return i;}this._sDisplayFormat="medium";if(i){i=m({},i);if(i.style){this._sDisplayFormat=i.style;delete i.style;}else if(i.pattern){this._sDisplayFormat=i.pattern;}if(i.calendarType){this._sCalendarType=i.calendarType;}i.pattern=this._sValueFormat;i.calendarType=n.Gregorian;}else{i={pattern:this._sValueFormat,calendarType:n.Gregorian};}return i;}function y(){var e=u.call(this);var i=e.getMetadata().getName();var B1=e.oFormatOptions;var C1=e.oConstraints;if(!B1||B1.style||!B1.pattern||B1.pattern!==this._sValueFormat||!B1.calendarType||B1.calendarType!==n.Gregorian){if(C1&&C1.isDateOnly){C1=m({},C1);delete C1.isDateOnly;C1.displayFormat="Date";}var D1=O.get(i);this._oDateOriginalType=this._oDataType;this._oDataType=new D1(x.call(this,i,B1,C1),C1);y1.call(this);}}function z(e,i){var B1=n1.call(this);if(B1&&this._bConnected){o1.call(this,e,B1);}}o.prototype._getContent=function(){var e=this.getContent();if(!e){if(this.getEditMode()===E.Display){e=this.getContentDisplay();}else{e=this.getContentEdit();}}return e||this.getAggregation("_content");};function A(e){if(e&&e===E.Editable){return true;}else{return false;}}function B(e){if(e&&e!==E.Disabled){return true;}else{return false;}}function G(e){if(e&&e!==E.Editable){return true;}else{return false;}}function H(){var e=v.call(this);if(e==="Edm.Boolean"||e==="sap.ui.model.type.Boolean"||e==="sap.ui.model.odata.type.Boolean"||e==="sap.ui.mdc.base.type.Boolean"){return true;}else{return this.getProperty("_onlyEEQ");}}o.prototype._getOnlyEEQ=function(){return H.call(this);};o.prototype._handleModelContextChange=function(e){if(!this._bFFAdded){var i=I.call(this);if(i){i.addFilterField(this);this._bFFAdded=true;}}};function I(){var e=this.getBinding("conditions");if(e){var i=e.getModel();if(i.isA("sap.ui.mdc.base.ConditionModel")){return i;}}return undefined;}o.prototype._getFilterOperatorConfig=function(){var e=I.call(this);if(e){return e.getFilterOperatorConfig();}else if(this._oFilterOperatorConfig){return this._oFilterOperatorConfig;}else{this._oFilterOperatorConfig=a.getFor();return this._oFilterOperatorConfig;}};function J(e){var i=I.call(this);if(i){i.setUIMessage(this.getFieldPath(),e);}else{this.setValueState(V.Error);this.setValueStateText(e);}}function L(){var e=I.call(this);if(e){e.removeUIMessage(this.getFieldPath());}else{this.setValueState(V.None);this.setValueStateText();}}o.prototype._observeChanges=function(e){if(e.name==="editMode"){if(this.getAggregation("_content")){R.call(this);}}if(e.name==="multipleLines"){if(this.getAggregation("_content")){R.call(this);}}if(e.name==="dataType"){if(this._oDataType){var i=t.call(this,e.current);if(!(this._oDataType instanceof i)){this._oDataType.destroy();this._oDataType=undefined;delete this._sDisplayFormat;delete this._sValueFormat;delete this._sCalendarType;this.destroyAggregation("_content");y1.call(this);}}}if(e.name==="maxConditions"){if(this.getAggregation("_content")){R.call(this);}y1.call(this);}if(e.name==="conditions"){this._bParseError=false;z.call(this,e.current,e.old);}if(e.name==="display"){this.destroyAggregation("_content");y1.call(this);}if(e.name==="fieldHelp"&&e.ids){m1.call(this,e.ids,e.mutation);y1.call(this);}if(e.name==="fieldInfo"&&e.child){w1.call(this,e.child,e.mutation);}if(e.name==="content"&&e.child){N.call(this,e.child,e.mutation);}if(e.name==="contentEdit"&&e.child){N.call(this,e.child,e.mutation);}if(e.name==="contentDisplay"&&e.child){N.call(this,e.child,e.mutation);}if(e.name==="_onlyEEQ"){y1.call(this);}};o.prototype.getFocusDomRef=function(){var e=this._getContent();if(e){return e.getFocusDomRef();}else{return this.getDomRef();}};o.prototype.getIdForLabel=function(){var i;var e=this._getContent();if(e){i=e.getIdForLabel();}else{i=this.getId();}return i;};o.prototype.enhanceAccessibilityState=function(e,i){var B1=this.getParent();if(B1&&B1.enhanceAccessibilityState){B1.enhanceAccessibilityState(this,i);}return i;};o.prototype.connectLabel=function(e){T.call(this,e);e.bindProperty("text",{path:"$field>/label"});e.setLabelFor(this);return this;};function N(e,i){if(i==="remove"){Q.call(this,e);d1.call(this,e);}else if(i==="insert"){c1.call(this,e);T.call(this,e);P.call(this,e);if(this.getAggregation("_content")){this.destroyAggregation("_content");}var B1;var C1;for(C1 in e.getMetadata().getAllProperties()){if(e.getBindingPath(C1)==="/conditions"){B1=e.getBindingInfo(C1);if(B1&&B1.type&&B1.type instanceof c){this._oConditionsType=B1.type;y1.call(this);}this._sBoundProperty=C1;}if(C1==="editable"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/editMode",formatter:A});}if(C1==="enabled"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/editMode",formatter:B});}if(C1==="displayOnly"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/editMode",formatter:G});}if(C1==="required"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/required"});}if(C1==="textAlign"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/textAlign"});}if(C1==="textDirection"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/textDirection"});}if(C1==="valueState"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/valueState"});}if(C1==="valueStateText"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/valueStateText"});}if(C1==="placeholder"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/placeholder"});}if(C1==="tooltip"&&!e.getBindingPath(C1)&&e.isPropertyInitial(C1)){e.bindProperty(C1,{path:"$field>/tooltip"});}}for(var D1 in e.getMetadata().getAllAggregations()){if(e.getBindingPath(D1)==="/conditions"){B1=e.getBindingInfo(D1);if(B1&&B1.template){for(C1 in B1.template.getMetadata().getAllProperties()){var E1=B1.template.getBindingInfo(C1);if(E1&&E1.type&&E1.type instanceof b){this._oConditionType=E1.type;y1.call(this);break;}}}break;}}}}function P(e){if(e.getMetadata().getEvents().change){e.attachEvent("change",i1,this);}if(e.getMetadata().getEvents().liveChange){e.attachEvent("liveChange",j1,this);}if(e.getMetadata().getEvents().press){e.attachEvent("press",k1,this);}}function Q(e){if(e.getMetadata().getEvents().change){e.detachEvent("change",i1,this);}if(e.getMetadata().getEvents().liveChange){e.detachEvent("liveChange",j1,this);}if(e.getMetadata().getEvents().press){e.detachEvent("press",k1,this);}}function R(){var e=this.getEditMode();if(this.getContent()||this._bIsBeingDestroyed||(e===E.Display&&this.getContentDisplay())||(e!==E.Display&&this.getContentEdit())){this.destroyAggregation("_content");return;}var i=v.call(this);var B1=w.call(this);var C1=this.getMaxConditions();var D1;var E1;var F1;var G1=this.getAggregation("_content");var H1;if(G1){H1=G1.getMetadata().getName().replace(/\./g,"/");}switch(i){case"Edm.Date":case"sap.ui.model.type.Date":case"sap.ui.model.odata.type.Date":D1=p.date;break;case"Edm.DateTime":case"sap.ui.model.odata.type.DateTime":if(B1&&(B1.displayFormat==="Date"||B1.isDateOnly)){D1=p.date;}else{D1=p.dateTime;}break;case"Edm.DateTimeOffset":case"sap.ui.model.type.DateTime":case"sap.ui.model.odata.type.DateTimeOffset":D1=p.dateTime;break;case"Edm.TimeOfDay":case"sap.ui.model.type.Time":case"sap.ui.model.odata.type.TimeOfDay":D1=p.time;break;case"Edm.Boolean":case"sap.ui.model.type.Boolean":case"sap.ui.model.odata.type.Boolean":case"sap.ui.mdc.base.type.Boolean":D1=p.bool;break;default:if(this.getFieldInfo()&&this._bTriggerable){D1=p.link;}else{var I1=new RegExp("^\\*(.*)\\*|\\$search$");if(I1.test(this.getFieldPath())&&this.getMaxConditions()===1){D1=p.search;}else{D1=p.default;}}break;}if(e===E.Display){E1=D1.display;F1=D1.createDisplay;}else if(C1!==1){E1=D1.editMulti;F1=D1.createEditMulti;}else if(this.getMultipleLines()){E1=D1.editMultiLine;F1=D1.createEditMultiLine;}else{E1=D1.edit;F1=D1.createEdit;}if(!E1){throw new Error("No control defined for type "+i+" in "+this);}if(E1!==H1){this._bHideOperator=false;if(G1){this.destroyAggregation("_content");if(G1.isA("sap.m.DateTimeField")){this._initDataType();}y1.call(this);}if(!r[E1]){r[E1]={};}var J1=r[E1].control;if(!J1){if(r[E1].promise){r[E1].promise.then(R.bind(this));return;}else{J1=sap.ui.require(E1);if(J1){r[E1].control=J1;}else{r[E1].promise=new Promise(function(M1){r[E1].resolve=M1;sap.ui.require([E1],S.bind(this));}.bind(this)).then(R.bind(this));return;}}}var K1=this.getId()+"-inner";var L1=F1.call(this,J1,K1);L1.attachEvent("parseError",g1,this);L1.attachEvent("validationError",h1,this);c1.call(this,L1);T.call(this,L1);this.setAggregation("_content",L1);}}function S(e){var i=e.getMetadata().getName();i=i.replace(/\./g,"/");r[i].control=e;r[i].resolve();delete r[i].resolve;}function T(e){e.setModel(this._oManagedObjectModel,"$field");}function U(e,i){var B1=A1.call(this);var C1=new e(i,{value:{path:"$field>/conditions",type:B1},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:A},enabled:{path:"$field>/editMode",formatter:B},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"100%",tooltip:"{$field>/tooltip}",change:i1.bind(this),liveChange:j1.bind(this),valueHelpRequest:p1.bind(this),showSuggestion:true});v1.call(this,C1);this._sBoundProperty="value";return C1;}function W(e,i){this._bHideOperator=true;var B1=z1.call(this);var C1=new e(i,{value:{path:"$field>/conditions/0",type:B1,mode:"OneWay"},placeholder:"{$field>/placeholder}",width:"100%",tooltip:"{$field>/tooltip}",search:i1.bind(this)});return C1;}function X(e,i){var B1=sap.ui.require("sap/m/Token");if(!B1){throw new Error("sap.m.Token not loaded "+this);}var C1=z1.call(this);var D1=new B1(i+"-token",{text:{path:'$field>',type:C1}});var E1=new e(i,{placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:A},enabled:{path:"$field>/editMode",formatter:B},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",showValueHelp:"{$field>/_fieldHelpEnabled}",width:"100%",tooltip:"{$field>/tooltip}",tokens:{path:"$field>/conditions",template:D1},dependents:[D1],change:i1.bind(this),liveChange:j1.bind(this),tokenUpdate:l1.bind(this),valueHelpRequest:p1.bind(this)});v1.call(this,E1);return E1;}function Y(e,i){var B1=A1.call(this);var C1=new e(i,{value:{path:"$field>/conditions",type:B1},placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:A},enabled:{path:"$field>/editMode",formatter:B},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:i1.bind(this),liveChange:j1.bind(this)});this._sBoundProperty="value";return C1;}function Z(e,i){var B1=A1.call(this);var C1=new e(i,{text:{path:"$field>/conditions",type:B1},textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",wrapping:"{$field>/multipleLines}",width:"100%",tooltip:"{$field>/tooltip}"});this._sBoundProperty="text";return C1;}function $(e,i){this._bHideOperator=true;var B1=A1.call(this);y.call(this);var C1=new e(i,{value:{path:"$field>/conditions",type:B1},displayFormat:this._sDisplayFormat,valueFormat:this._sValueFormat,placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:A},enabled:{path:"$field>/editMode",formatter:B},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",change:i1.bind(this)});if(C1.setDisplayFormatType){C1.setDisplayFormatType(this._sCalendarType);}this._sBoundProperty="value";return C1;}function a1(e,i){var B1=A1.call(this);var C1=new e(i,{text:{path:"$field>/conditions",type:B1},textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",tooltip:"{$field>/tooltip}",press:k1.bind(this)});this._sBoundProperty="text";return C1;}function b1(e,i){if(!this.getFieldHelp()){e1.call(this,"bool");}return U.call(this,e,i);}function c1(e){if(e.onsapprevious){e._origOnsapprevious=e.onsapprevious;e.onsapprevious=function(i){var B1=n1.call(this);if(i.keyCode!==K.ARROW_UP&&(!B1||!B1.isOpen())){var e=this._getContent();e._origOnsapprevious(i);}}.bind(this);}if(e.onsapnext){e._origOnsapnext=e.onsapnext;e.onsapnext=function(i){var B1=n1.call(this);if(i.keyCode!==K.ARROW_DOWN&&(!B1||!B1.isOpen())){var e=this._getContent();e._origOnsapnext(i);}}.bind(this);}if(e.onsapup){e._origOnsapup=e.onsapup;e.onsapup=function(i){var B1=n1.call(this);if(!B1||!B1.isOpen()){var e=this._getContent();e._origOnsapup(i);}}.bind(this);}if(e.onsapdown){e._origOnsapdown=e.onsapdown;e.onsapdown=function(i){var B1=n1.call(this);if(!B1||!B1.isOpen()){var e=this._getContent();e._origOnsapdown(i);}}.bind(this);}if(e.onsapbackspace){e._origOnsapbackspace=e.onsapbackspace;e.onsapbackspace=function(i){var B1=n1.call(this);if(!B1||!B1.isOpen()){var e=this._getContent();e._origOnsapbackspace(i);}}.bind(this);}}function d1(e){if(e._origOnsapprevious){e.onsapprevious=e._origOnsapprevious;delete e._origOnsapprevious;}if(e._origOnsapnext){e.onsapnext=e._origOnsapnext;delete e._origOnsapnext;}if(e._origOnsapup){e.onsapup=e._origOnsapup;delete e._origOnsapup;}if(e._origOnsapdown){e.onsapdown=e._origOnsapdown;delete e._origOnsapdown;}if(e._origOnsapbackspace){e.onsapbackspace=e._origOnsapbackspace;delete e._origOnsapbackspace;}}function e1(e){this.setProperty("_fieldHelpEnabled",true,true);this._sDefaultFieldHelp=s[e].id;var i=s[e].control;if(!i){if(s[e].promise){s[e].promise.then(f1.bind(this));}var B1=sap.ui.require(s[e].name);if(!B1&&!s[e].promise){s[e].promise=new Promise(function(C1){s[e].resolve=C1;sap.ui.require([s[e].name],function(D1){e1.call(this,e);}.bind(this));}.bind(this)).then(f1.bind(this));}if(B1){i=new B1(s[e].id);s[e].control=i;i.connect(this);if(s[e].resolve){s[e].resolve();delete s[e].resolve;}if(!s[e].promise){f1.call(this);}}}}function f1(){m1.call(this,"BoolDefaultHelp","insert");v1.call(this,this.getAggregation("_content"));}function g1(e){this._bParseError=true;}function h1(e){this._bParseError=true;}function i1(e){var i=this.getMaxConditions();var B1=this.getConditions();var C1;var D1=true;var E1;var F1;if("valid"in e.getParameters()){D1=e.getParameter("valid");if(!D1&&"value"in e.getParameters()){E1=e.getParameter("value");}}var G1=false;var H1=this._sBoundProperty&&e.oSource.getBindingInfo(this._sBoundProperty);if(H1&&H1.binding&&H1.binding.sPath==="/conditions"&&D1){F1=B1[0];C1=B1[0]&&B1[0].values[0];}else if("value"in e.getParameters()){C1=e.getParameter("value");if(D1){G1=true;}}else if("query"in e.getParameters()){C1=e.getParameter("query");G1=true;}else{F1=B1[0];C1=B1[0]&&B1[0].values[0];}if(G1){L.call(this);if(this._oNavigateCondition){F1=this._oNavigateCondition;D1=true;}else{var I1=z1.call(this);try{F1=I1.parseValue(C1);I1.validateValue(F1);}catch(J1){D1=false;E1=C1;J.call(this,J1.message);}}if(D1){if(F1){if(C.indexOfCondition(F1,B1)>=0){D1=false;E1=C1;C1=undefined;}else{if(i>0&&i<=B1.length){B1.splice(0,B1.length-i+1);}B1.push(F1);}}else if(i===1){B1=[];}if(!g(B1,this.getConditions())){this.setProperty("conditions",B1,true);}}}else if(this._oNavigateCondition){B1[0]=this._oNavigateCondition;if(!g(B1,this.getConditions())){this.setProperty("conditions",B1,true);}}else if(!("valid"in e.getParameters())&&this._bParseError){E1=e.getParameter("value");D1=false;}if(i!==1&&D1){e.getSource().setValue("");}var K1=n1.call(this);if(K1&&this._bConnected){if(sap.ui.getCore().getCurrentFocusedControlId()===e.getSource().getId()){K1.close();}K1.setFilterValue("");o1.call(this,B1,K1);if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);}}if(this._oNavigateCondition){K1.onFieldChange();this._oNavigateCondition=undefined;}this._fireChange(B1,D1,E1);}function j1(e){var i;var B1;var C1=false;this._oNavigateCondition=undefined;if("value"in e.getParameters()){i=e.getParameter("value");}if("escPressed"in e.getParameters()){C1=e.getParameter("escPressed");}if("previousValue"in e.getParameters()){B1=e.getParameter("previousValue");}else{var D1=this.getConditions();B1=D1[0]&&D1[0].values[0];}var E1=n1.call(this);if(E1&&E1.openByTyping()){var F1;if(i[0]==="="&&i[1]==="="){F1=i.slice(2);}else if(i[0]==="="){F1=i.slice(1);}else{F1=i;}var G1=this.getDisplay();if(G1!==k.Value){var H1=this._getFilterOperatorConfig().getOperator("EEQ");var I1=H1.splitText(F1,G1);F1="";if(I1[0]){F1=I1[0];if(I1[1]){F1=F1+" ";}}if(I1[1]){F1=F1+I1[1];}}var J1=u.call(this);if(J1&&(J1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||J1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"||J1.getMetadata().getName()==="sap.ui.model.type.Unit"||J1.getMetadata().getName()==="sap.ui.model.type.Currency")){var rx=new RegExp(/^([,.\d]+)\s(.+)$/i);var L1=F1.match(rx);if(L1){F1=L1[2];}else{rx=new RegExp(/^(.+)\s([,.\d]+)$/i);L1=F1.match(rx);if(L1){F1=L1[1];}else if(/\d/.test(F1)){F1=undefined;}}}if(this.iLiveChangeTimer){clearTimeout(this.iLiveChangeTimer);delete this.iLiveChangeTimer;}this.iLiveChangeTimer=setTimeout(function(){if(this._bConnected&&this._getContent()&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent().getId()){E1.setFilterValue(F1);if(E1.getConditions().length>0){E1.setConditions([]);}E1.open(true);}}.bind(this),300);}this.fireLiveChange({value:i,escPressed:C1,previousValue:B1});}function k1(e){var i=this.getFieldInfo();if(i){i.getTriggerHref().then(function(B1){if(B1){window.location.href=B1;}else{i.open(this._getContent());}}.bind(this));}this.firePress();}function l1(e){if(e.getParameter("type")==="removed"){var B1=e.getParameter("removedTokens");var C1=this.getConditions();var i;for(i=0;i<B1.length;i++){var D1=B1[i];var E1=D1.getBindingContext("$field").sPath;var F1=parseInt(E1.slice(E1.lastIndexOf("/")+1));C1[F1].delete=true;}for(i=C1.length-1;i>=0;i--){if(C1[i].delete){C1.splice(i,1);}}this.setProperty("conditions",C1,true);this._fireChange(C1,true);}}function m1(i,e){var B1=sap.ui.getCore().byId(i);if(e==="remove"){B1.detachEvent("select",q1,this);B1.detachEvent("navigate",r1,this);B1.detachEvent("dataUpdate",s1,this);B1.detachEvent("disconnect",t1,this);this.setProperty("_fieldHelpEnabled",false,true);}else if(e==="insert"){if(B1){B1.attachEvent("dataUpdate",s1,this);this.setProperty("_fieldHelpEnabled",true,true);}}z.call(this,this.getConditions());}function n1(){var i=this.getFieldHelp();var e;if(!i&&this._sDefaultFieldHelp){i=this._sDefaultFieldHelp;}if(i){e=sap.ui.getCore().byId(i);}return e;}function o1(e,B1){if(!B1){B1=n1.call(this);}var C1=u.call(this);if(C1&&(C1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||C1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"||C1.getMetadata().getName()==="sap.ui.model.type.Unit"||C1.getMetadata().getName()==="sap.ui.model.type.Currency")){var D1=[];for(var i=0;i<e.length;i++){var E1=e[i];if(E1.values[0]&&E1.values[0][1]){var F1=C.createItemCondition(E1.values[0][1],undefined,E1.outParameters);D1.push(F1);}}B1.setConditions(D1);}else{B1.setConditions(e);}}function p1(e){var i=n1.call(this);if(i){i.setFilterValue("");var B1=this.getConditions();o1.call(this,B1,i);i.toggleOpen(false);}}function q1(e){var B1=this.getConditions();var C1=e.getParameter("conditions");var D1=e.getParameter("add");var E1=e.oSource;var F1=this.getMaxConditions();var G1=H.call(this);var H1;var I1=u.call(this);var J1=this._getContent();var K1;var rx=new RegExp(/^([,.\d]+)\s(.+)$/i);var M1=new RegExp(/^(.+)\s([,.\d]+)$/i);var N1;var O1="";if(!D1){B1=[];}if(I1&&(I1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||I1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"||I1.getMetadata().getName()==="sap.ui.model.type.Unit"||I1.getMetadata().getName()==="sap.ui.model.type.Currency")&&F1===1){if(C1.length>0){var P1;if(I1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||I1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"){P1=C1[0].values[0];}else{P1=C1[0].values[1];}K1=J1.getDOMValue&&J1.getDOMValue();N1=K1.match(rx);if(N1){O1=N1[1]+" "+P1;}else{N1=K1.match(M1);if(N1){O1=P1+" "+N1[2];}else if(K1&&/\d/.test(K1)){O1=K1.trim()+" "+P1;}else{O1="0 "+P1;}}N1=I1.parseValue(O1,"string");H1=C.createItemCondition(N1,undefined,C1[0].outParameters);B1.push(H1);}}else{for(var i=0;i<C1.length;i++){H1=C1[i];if(G1&&H1.operator!=="EQ"&&H1.operator!=="EEQ"){continue;}if(!D1||C.indexOfCondition(H1,B1)===-1){B1.push(H1);}}}if(F1>0&&F1<B1.length){B1.splice(0,B1.length-F1);}if(g(B1,this.getConditions())){if(J1&&J1.setDOMValue&&F1===1&&B1.length>0){if(this._oConditionType){K1=this._oConditionType.formatValue(B1[0]);}else if(this._oConditionsType){K1=this._oConditionsType.formatValue(B1);}J1.setDOMValue(K1);}}else{if(J1&&J1.setDOMValue){if(F1!==1){J1.setDOMValue("");}}this.setProperty("conditions",B1,true);E1.onFieldChange();this._fireChange(B1,true);}}function r1(i){var B1=i.getParameter("value");var C1=i.getParameter("key");var D1=i.getParameter("condition");var E1;var F1;var G1=this._getContent();if(D1){this._oNavigateCondition=m({},D1);C1=D1.values[0];B1=D1.values[1];}else{this._oNavigateCondition=C.createItemCondition(C1,B1);}var H1=u.call(this);if(H1&&(H1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||H1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"||H1.getMetadata().getName()==="sap.ui.model.type.Unit"||H1.getMetadata().getName()==="sap.ui.model.type.Currency")){if(H1.getMetadata().getName()==="sap.ui.model.odata.type.Unit"||H1.getMetadata().getName()==="sap.ui.model.odata.type.Currency"){B1=C1;}F1=G1.getDOMValue&&G1.getDOMValue();var rx=new RegExp(/^([,.\d]+)\s(.+)$/i);var J1;var K1=F1.match(rx);if(K1){J1=K1[1];E1=J1+" "+B1;}else{rx=new RegExp(/^(.+)\s([,.\d]+)$/i);K1=F1.match(rx);if(K1){J1=K1[2];E1=B1+" "+J1;}else if(F1&&/\d/.test(F1)){J1=F1.trim();E1=J1+" "+B1;}else{E1="0 "+B1;}}F1=E1;try{this._oNavigateCondition.values[0]=H1.parseValue(E1,"string");this._oNavigateCondition.values[1]=undefined;}catch(e){this._oNavigateCondition=undefined;}}else if(this.getDisplay()!==k.Value){E1=C1;}else if(B1){E1=B1;}else{E1=C1;}if(G1&&G1.setDOMValue){if(!F1){if(this._oConditionType){F1=this._oConditionType.formatValue(this._oNavigateCondition);}else if(this._oConditionsType){F1=this._oConditionsType.formatValue([this._oNavigateCondition]);}else{F1=B1||C1;}}G1.setDOMValue(F1);G1._doSelect();}this.fireLiveChange({value:E1});}function s1(e){var i=this.getEditMode()===E.Editable&&this._getContent()&&sap.ui.getCore().getCurrentFocusedControlId()===this._getContent().getId();if(!i&&this.getConditions().length>0&&(this.getMaxConditions()!==1||(this.getDisplay()!==k.Value&&!this._bParseError))){this._oManagedObjectModel.checkUpdate(true);}}function t1(e){var i=n1.call(this);i.detachEvent("select",q1,this);i.detachEvent("navigate",r1,this);i.detachEvent("disconnect",t1,this);this._bConnected=false;}function u1(){var e=n1.call(this);if(e&&!this._bConnected){e.connect(this);this._bConnected=true;e.attachEvent("select",q1,this);e.attachEvent("navigate",r1,this);e.attachEvent("disconnect",t1,this);var i=this.getConditions();o1.call(this,i,e);var B1=this._getContent();if(B1&&!B1.orgOnsapfocusleave&&B1.onsapfocusleave){B1.orgOnsapfocusleave=B1.onsapfocusleave;B1.onsapfocusleave=function(C1){var e=n1.call(this.getParent());if(e){var D1=sap.ui.getCore().byId(C1.relatedControlId);if(D1&&h(e.getDomRef(),D1.getFocusDomRef())){C1.stopPropagation();return;}}this.orgOnsapfocusleave(C1);};}}}function v1(e){var i=n1.call(this);if(i&&e&&e.addEndIcon){var B1=i.getIcon();var C1=e.getAggregation("_endIcon",[])[0];if(C1){C1.setSrc(B1);}else{e.addEndIcon({id:e.getId()+"-vhi",src:B1,useIconTooltip:false,noTabStop:true,press:function(D1){if(!this.getValueHelpOnly()){var E1;if(D.support.touch){E1=this.$('inner');E1.attr('readonly','readonly');this.focus();E1.removeAttr('readonly');}else{this.focus();}this.bValueHelpRequested=true;this.fireValueHelpRequest({fromSuggestions:false});}}.bind(e)});}}}function w1(e,i){if(i==="remove"){e.detachEvent("dataUpdate",x1,this);}else if(i==="insert"){e.attachEvent("dataUpdate",x1,this);x1.call(this);}}function x1(){var e=this.getFieldInfo();var i=this;e.isTriggerable().then(function(B1){i._bTriggerable=B1;if(i.getAggregation("_content")&&i.getEditMode()===E.Display){R.call(i);}});}o.prototype._getFormatOptions=function(){return{onlyEEQ:H.call(this),valueType:u.call(this),originalDateType:this._oDateOriginalType,display:this.getDisplay(),fieldHelpID:this.getFieldHelp()||this._sDefaultFieldHelp,filterOperatorConfig:this._getFilterOperatorConfig(),hideOperator:this._bHideOperator,maxConditions:this.getMaxConditions()};};function y1(){if(this._oConditionType||this._oConditionsType){var e=this._getFormatOptions();if(this._oConditionType){this._oConditionType.setFormatOptions(e);}if(this._oConditionsType){this._oConditionsType.setFormatOptions(e);}}}function z1(){if(!this._oConditionType){this._oConditionType=new b();y1.call(this);}return this._oConditionType;}function A1(){if(!this._oConditionsType){this._oConditionsType=new c();y1.call(this);}return this._oConditionsType;}return o;},true);
