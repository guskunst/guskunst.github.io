/*
 * ! SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(["./library","sap/ui/core/Element"],function(L,E){"use strict";var T=L.TableType;var C=E.extend("sap.ui.mdc.CreationRow",{metadata:{library:"sap.ui.mdc",properties:{visible:{type:"boolean",group:"Appearance",defaultValue:true},applyEnabled:{type:"boolean",group:"Behavior",defaultValue:true}},events:{apply:{allowPreventDefault:true}}}});C.prototype.init=function(){this._sTableType="";this._oInnerCreationRow=null;this._mBindingContexts={};};C.prototype.exit=function(){if(this._oInnerCreationRow){this._oInnerCreationRow.destroy();this._oInnerCreationRow=null;}this._mBindingContexts=null;};C.prototype.setBindingContext=function(c,m){E.prototype.setBindingContext.call(this,c,m);this._mBindingContexts[m]={context:c,modelName:m};if(this._oInnerCreationRow){this._oInnerCreationRow.setBindingContext(c,m);}return this;};C.prototype.setApplyEnabled=function(e){this.setProperty("applyEnabled",e,true);if(this._oInnerCreationRow){this._oInnerCreationRow.setApplyEnabled(e);}return this;};C.prototype.setVisible=function(v){this.setProperty("visible",v,true);if(this._oInnerCreationRow){this._oInnerCreationRow.setVisible(v);}return this;};C.prototype._onInnerApply=function(e){if(!this.fireApply()){e.preventDefault();}};C.prototype.update=function(){return this._updateInnerCreationRow();};C.prototype._updateInnerCreationRow=function(){var t=this._getTable();var n=t?t._getStringType():"";var p;if(this._sTableType===n||!t||!t._oTable){return Promise.resolve();}this._sTableType=n;if(n===T.Table){p=this._createGridTableCreationRow();}else{p=this._createResponsiveTableCreationRow();}return p.then(function(I){i(t,I);});};function g(m){return new Promise(function(r,a){sap.ui.require([m],function(C){r(C);},function(e){a(e);});});}C.prototype._createGridTableCreationRow=function(){return g("sap/ui/table/CreationRow").then(function(C){this._oInnerCreationRow=new C({visible:this.getVisible(),applyEnabled:this.getApplyEnabled(),apply:[this._onInnerApply,this]});for(var m in this._mBindingContexts){var b=this._mBindingContexts[m];this._oInnerCreationRow.setBindingContext(b.context,b.modelName);}return this._oInnerCreationRow;}.bind(this));};C.prototype._createResponsiveTableCreationRow=function(){if(this._oInnerCreationRow){this._oInnerCreationRow.destroy();this._oInnerCreationRow=null;}return Promise.resolve();};function i(m,I){if(m&&m._oTable&&I){m._oTable.setCreationRow(I);}}C.prototype._getTable=function(){var p=this.getParent();return p&&p.isA("sap.ui.mdc.Table")?p:null;};return C;},true);
