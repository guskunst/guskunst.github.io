/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2017 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/fe/controllerextensions/Transaction","sap/fe/controllerextensions/Routing","sap/fe/controllerextensions/EditFlow",'sap/fe/actions/messageHandling','sap/ui/mdc/base/ConditionModel','sap/base/Log'],function(q,C,J,T,R,E,m,a,L){"use strict";return C.extend("sap.fe.templates.ListReport.ListReportController",{transaction:T,routing:R,editFlow:E,messageHandling:m,onInit:function(){this.getView().setModel(new J(),"sap.fe.templates.ListReport");this.getView().setModel(this.transaction.getUIModel(),"ui");},onAfterBinding:function(b){var t=this,s,v=this.getView(),M=v.getModel(),f=this.byId('fe::fb::'+this.getView().getViewData().entitySetName),l=f.data('listBindingNames');M.getBindingForReference(l).then(function(o){s=t.routing.getDirtyState();if(Object.keys(s).length>0){o.refresh();t.routing.resetDirtyState();}});},setShareModel:function(){var g=q.sap.getObject("sap.ushell.Container.getUser");var s={bookmarkTitle:document.title,bookmarkCustomUrl:function(){var h=hasher.getHash();return h?("#"+h):window.location.href;},isShareInJamActive:!!g&&g().isJamActive()};var t=this.getOwnerComponent().getModel("_templPriv");t.setProperty("/listReport/share",s);},handlers:{onShareListReportActionButtonPress:function(e){var l=this.getView().getModel("sap.fe.i18n").getResourceBundle();if(!this._oShareActionButton){this._oShareActionButton=sap.ui.xmlfragment("sap.fe.templates.ListReport.ShareSheet",{shareEmailPressed:function(){sap.m.URLHelper.triggerEmail(null,l.getText("SAPFE_EMAIL_SUBJECT",[document.title]),document.URL);},shareJamPressed:function(){}});this.getView().addDependent(this._oShareActionButton);}this._oShareActionButton.openBy(e.getSource());},onSearch:function(e){var M=this.getView().getModel(),c=e.getParameter('conditions'),f=e.getSource(),l=f.data('listBindingNames'),o;M.getBindingForReference(l).then(function(b){o=a.getFor(b);o.removeAllConditions();o.setConditions(c);o.applyFilters(b,true);});}}});});
