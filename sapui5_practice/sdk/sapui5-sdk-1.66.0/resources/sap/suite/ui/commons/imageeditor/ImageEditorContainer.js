sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/core/Control","sap/suite/ui/commons/library","sap/ui/core/library","sap/m/library","./ImageEditor","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarToggleButton","sap/m/OverflowToolbarLayoutData","sap/m/ToggleButton","sap/m/ToolbarSeparator","sap/m/Label","sap/m/Slider","sap/m/Input","sap/m/CheckBox","sap/ui/model/json/JSONModel","sap/m/MenuButton","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/Select","sap/m/Button","sap/ui/core/Item","sap/m/ResponsivePopover","sap/m/List","sap/m/StandardListItem","sap/m/CustomListItem","sap/m/FlexBox","sap/m/FlexItemData","sap/m/IconTabBar","sap/m/IconTabFilter","sap/ui/core/Icon","sap/ui/core/HTML","./ImageEditorContainerRenderer"],function(q,C,l,a,M,I,O,b,c,d,T,e,L,S,f,g,J,h,i,j,k,B,m,R,n,o,p,F,r,s,t,u,H){"use strict";var v=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var w=M.InputType,x=M.ListType,y=l.ImageEditorMode,z=l.ImageEditorContainerMode,V=a.ValueState,A=M.ListMode,D=M.ButtonType,E=M.FlexDirection,G=M.FlexRendertype,K=M.FlexJustifyContent,N=M.FlexAlignItems,P=M.IconTabDensityMode,Q=M.BackgroundDesign,U=a.TextAlign,W=Object.freeze({ZOOM:{min:I.LIMITS.ZOOM_MIN,max:I.LIMITS.ZOOM_MAX,callback:"_setZoom"},WIDTH:{min:I.LIMITS.WIDTH_MIN,max:I.LIMITS.WIDTH_MAX,callback:"_setWidth"},HEIGHT:{min:I.LIMITS.HEIGHT_MIN,max:I.LIMITS.HEIGHT_MAX,callback:"_setHeight"},ROTATION:{min:I.LIMITS.ROTATION_MIN,max:I.LIMITS.ROTATION_MAX,callback:"_rotate"},FILTER:{callback:"_applyCurrentFilter"}}),X=Object.freeze({CUSTOMSIZE:"sap-icon://write-new-document",ORIGINALSIZE:"sap-icon://table-view",ROTATELEFT:"sap-icon://response",ROTATERIGHT:"sap-icon://forward",CROPRECTANGLE:"sap-icon://color-fill",CROPELLIPSE:"sap-icon://circle-task-2",CROPCUSTOM:"sap-icon://add-favorite",TRANSFORM:"sap-icon://draw-rectangle",FILTER:"sap-icon://palette",CROP:"sap-icon://crop",UNDO:"sap-icon://undo",DROPDOWN:"sap-icon://slim-arrow-down",ZONES:"sap-icon://tag",LOCK:"sap-icon://locked",RESET:"sap-icon://reset",FLIPVERTICAL:"sap-icon://resize-vertical",FLIPHORIZONTAL:"sap-icon://resize-horizontal"});var Y=C.extend("sap.suite.ui.commons.imageeditor.ImageEditorContainer",{metadata:{library:"sap.suite.ui.commons",properties:{mode:{type:"sap.suite.ui.commons.ImageEditorContainerMode",defaultValue:z.Filter}},defaultAggregation:"imageEditor",aggregations:{imageEditor:{type:"sap.suite.ui.commons.imageeditor.ImageEditor",multiple:false,singularName:"imageEditor"},customResizeItems:{type:"sap.suite.ui.commons.imageeditor.CustomSizeItem",multiple:true,singularName:"customResizeItem"},customRectangleCropItems:{type:"sap.suite.ui.commons.imageeditor.CustomSizeItem",multiple:true,singularName:"customRectangleCropItem"},customEllipseCropItems:{type:"sap.suite.ui.commons.imageeditor.CustomSizeItem",multiple:true,singularName:"customEllipseCropItem"}}}});var Z=Object.freeze({NUM_KEPT_ITEMS:2});Y.prototype.init=function(){var $={blocked:true,mode:null,transform:{keepAspectRatio:true,width:null,height:null,widthValueState:V.None,widthValueStateText:null,heightValueState:V.None,heightValueStateText:null,rotate:0,rotateValueState:V.None,rotateValueStateText:null,selectedTypeKey:"Resize",flipVertical:false,flipHorizontal:false,resizes:[{key:"custom",text:v.getText("IMGEDITOR_CUSTOM_SIZE"),icon:X.CUSTOMSIZE,unlockRatio:true},{key:"original",text:v.getText("IMGEDITOR_ORIGINAL_SIZE"),icon:X.ORIGINALSIZE}],rotates:[{key:"90left",text:v.getText("IMGEDITOR_ROTATE_90LEFT"),rotate:-90,icon:X.ROTATELEFT},{key:"90right",text:v.getText("IMGEDITOR_ROTATE_90RIGHT"),rotate:90,icon:X.ROTATERIGHT},{key:"45left",text:v.getText("IMGEDITOR_ROTATE_45LEFT"),rotate:-45,icon:X.ROTATELEFT},{key:"45right",text:v.getText("IMGEDITOR_ROTATE_45RIGHT"),rotate:45,icon:X.ROTATERIGHT}],flips:[{key:"vertical",text:v.getText("IMGEDITOR_FLIP_VERTICAL"),icon:X.FLIPVERTICAL,flipVertical:true,flipHorizontal:false},{key:"horizontal",text:v.getText("IMGEDITOR_FLIP_HORIZONTAL"),icon:X.FLIPHORIZONTAL,flipVertical:false,flipHorizontal:true}]},crop:{zoom:100,zoomValueState:V.None,zoomValueStateText:null,width:null,widthValueState:V.None,widthValueStateText:null,height:null,heightValueState:V.None,heightValueStateText:null,keepAspectRatio:true,selectedTypeKey:"Rectangle",selectedType:null,blocked:false,areaRectangle:{x:10,y:10,width:80,height:80},types:[{key:"Rectangle",text:"\ue17b",icon:X.CROPRECTANGLE,apply:"applyVisibleCrop"},{key:"Ellipse",text:"\ue255",icon:X.CROPELLIPSE,apply:"applyVisibleCrop"},{key:"Custom",text:"\ue057",icon:X.CROPCUSTOM,apply:"applyVisibleCrop"}],ratiosRectangle:[{key:"custom",text:v.getText("IMGEDITOR_CUSTOM_SIZE"),icon:X.CUSTOMSIZE,unlockRatio:true,relative:true},{key:"original",text:v.getText("IMGEDITOR_CROP_RATIO_ORIGINAL"),width:null,height:null,icon:X.ORIGINALSIZE,relative:true}],ratiosCircle:[{key:"custom",text:v.getText("IMGEDITOR_CUSTOM_SIZE"),icon:X.CUSTOMSIZE,unlockRatio:true,relative:true},{key:"original",text:v.getText("IMGEDITOR_CROP_RATIO_ORIGINAL"),width:null,height:null,icon:X.ORIGINALSIZE,relative:true}]},filter:{filterValueState:V.None,filterValueStateText:null,selectedFilter:null,filters:[{text:v.getText("IMGEDITOR_FILTER_BRIGHTNESS"),type:"brightness",value:100,defaultValue:100,unit:"%",min:I.LIMITS.BRIGHTNESS_MIN,max:I.LIMITS.BRIGHTNESS_MAX},{text:v.getText("IMGEDITOR_FILTER_CONTRAST"),type:"contrast",value:100,defaultValue:100,unit:"%",min:I.LIMITS.CONTRAST_MIN,max:I.LIMITS.CONTRAST_MAX},{text:v.getText("IMGEDITOR_FILTER_SATURATION"),type:"saturate",value:100,defaultValue:100,unit:"%",min:I.LIMITS.SATURATE_MIN,max:I.LIMITS.SATURATE_MAX},{text:v.getText("IMGEDITOR_FILTER_GRAYSCALE"),type:"grayscale",value:0,defaultValue:0,unit:"%",min:I.LIMITS.GRAYSCALE_MIN,max:I.LIMITS.GRAYSCALE_MAX},{text:v.getText("IMGEDITOR_FILTER_INVERT"),type:"invert",value:0,defaultValue:0,unit:"%",min:I.LIMITS.INVERT_MIN,max:I.LIMITS.INVERT_MAX},{text:v.getText("IMGEDITOR_FILTER_SEPIA"),type:"sepia",value:0,defaultValue:0,unit:"%",min:I.LIMITS.SEPIA_MIN,max:I.LIMITS.SEPIA_MAX}]},history:[],historyIndex:0};this._oModel=new J($);this._oThumbnailCanvas=document.createElement("canvas");this._initHeaderToolbar();this["_setMode"+this.getMode()]();};Y.prototype.setMode=function($){this.setProperty("mode",$,true);this["_setMode"+this.getMode()]();return this;};Y.prototype.setImageEditor=function($){this._detachEditorEvents(this.getImageEditor());this.setAggregation("imageEditor",$);this._attachEditorEvents($);if($&&$.getLoaded()){this._onImageLoaded();}};Y.prototype.destroyImageEditor=function(){this._detachEditorEvents(this.getImageEditor());this.destroyAggregation("imageEditor");this._oModel.setProperty("/blocked",true);};Y.prototype.getToolbar=function(){return this._getHeaderToolbar();};Y.prototype.getToolbarIds=function(){return{filter:this.getId()+"-filterButton",crop:this.getId()+"-cropButton",transform:this.getId()+"-transformButton",undo:this.getId()+"-undoButton",history:this.getId()+"-historyButton",separator:this.getId()+"-separator"};};Y.prototype._attachEditorEvents=function($){if(!$){return;}$.attachLoaded(this._onImageLoaded,this);$.attachError(this._onImageError,this);$.attachCropAreaChanged(this._onCropAreaChange,this);$.attachHistoryChanged(this._onHistoryChange,this);$.attachSizeChanged(this._onSizeChange,this);$.attachZoomChanged(this._onZoomChange,this);};Y.prototype._detachEditorEvents=function($){if(!$){return;}$.detachLoaded(this._onImageLoaded,this);$.detachError(this._onImageError,this);$.detachCropAreaChanged(this._onCropAreaChange,this);$.detachHistoryChanged(this._onHistoryChange,this);$.detachSizeChanged(this._onSizeChange,this);$.detachZoomChanged(this._onZoomChange,this);};Y.prototype._refreshImageSize=function(){if(!this.getImageEditor()||!this.getImageEditor().getLoaded()){return;}var $=this.getImageEditor().getWidth(),_=this.getImageEditor().getHeight();this._oModel.setProperty("/transform/resizes/1/width",$);this._oModel.setProperty("/transform/resizes/1/height",_);this._oModel.setProperty("/crop/ratiosRectangle/1/width",$);this._oModel.setProperty("/crop/ratiosRectangle/1/height",_);this._oModel.setProperty("/crop/ratiosCircle/1/width",$);this._oModel.setProperty("/crop/ratiosCircle/1/height",_);this._updateCurrentSize($,_);};Y.prototype._refreshCropAreaSize=function(){var $=this.getImageEditor().getCropArea();if(!$){return;}this._updateCropSize(Math.round($.width),Math.round($.height));};Y.prototype._onImageLoaded=function(){var $=this.getImageEditor();this._resetValueStates();this._oModel.setProperty("/blocked",!$.getSrc());if(!$.getSrc()){return;}this._refreshImageSize();this._oModel.setProperty("/history",[]);this._oModel.setProperty("/historyIndex",0);this._oModel.setProperty("/crop/zoom",100);this._updateOrigThumbnail();this._resetCurrentPanel();};Y.prototype._onImageError=function(){this._resetValueStates();this._oModel.setProperty("/blocked",true);};Y.prototype._onCropAreaChange=function($){this._resetValueStates();this._updateCropSize(Math.round($.getParameter("cropArea").width),Math.round($.getParameter("cropArea").height));};Y.prototype._onHistoryChange=function($){var _=$.getParameter("history"),a1=$.getParameter("index");this._resetValueStates();this._refreshImageSize();_.push({noChange:"NoChange"});this._oModel.setProperty("/history",_);this._oModel.setProperty("/historyIndex",a1);};Y.prototype._onSizeChange=function($){this._resetValueStates();this._updateCurrentSize($.getParameter("width"),$.getParameter("height"));this._selectResizeCustomSizeItem(this.getImageEditor().getKeepResizeAspectRatio());};Y.prototype._onZoomChange=function($){var _=$.getParameter("zoom");this._oModel.setProperty("/crop/zoom",_);this._refreshCropAreaSize();};Y.prototype._updateCropSize=function($,_){this._oModel.setProperty("/crop/width",$);this._oModel.setProperty("/crop/height",_);};Y.prototype._updateCurrentSize=function($,_){this._oModel.setProperty("/transform/width",$);this._oModel.setProperty("/transform/height",_);};Y.prototype._updateOrigThumbnail=function(){var $=this.$("origThumbnail"),_=this.getImageEditor(),a1,b1,c1=this._oThumbnailCanvas.getContext("2d");if(_.getWidth()>=_.getHeight()){a1=300;b1=Math.round(_.getHeight()*a1/_.getWidth());}else{b1=300;a1=Math.round(_.getWidth()*b1/_.getHeight());}this._oThumbnailCanvas.width=a1;this._oThumbnailCanvas.height=b1;c1.clearRect(0,0,a1,b1);c1.drawImage(_._oCanvas,0,0,a1,b1);$.attr({"href":this._oThumbnailCanvas.toDataURL(),"viewbox":a1+" "+b1});};Y.prototype._getHeaderToolbar=function(){if(!this._headerToolbar){this._headerToolbar=new O({blocked:"{/blocked}"}).addStyleClass("sapSuiteUiCommonsImageEditorContainerToolbar");this._headerToolbar.setModel(this._oModel);this.addDependent(this._headerToolbar);}return this._headerToolbar;};Y.prototype._initHeaderToolbar=function(){var $=this._getHeaderToolbar();this._getHistoryItems().forEach(function(_){$.addContent(_);});$.addContent(this._getFilterButton());$.addContent(this._getCropButton());$.addContent(this._getTransformButton());};Y.prototype._getHistoryPopover=function(){var $=this;if(!this._oHistoryPopover){this._oHistoryPopover=new R({title:{path:"/history",formatter:function(_){return v.getText("IMGEDITOR_HISTORY_TITLE",String(_.length-1));}},endButton:new B({text:v.getText("IMGEDITOR_HISTORY_CLOSE"),press:function(){$._oHistoryPopover.close();}}),afterOpen:function(){var _=$._oModel.getProperty("/historyIndex"),a1=$._oHistoryList.getItems()[_];$._oHistoryList.setSelectedItem(a1);a1.focus();}});this._oHistoryList=new n({mode:A.SingleSelectMaster,selectionChange:function(_){var a1=_.getParameter("listItem"),b1=a1.getParent().indexOfItem(a1);$._jumpToHistory(b1);},items:{path:"/history",factory:this._historyItemFactory.bind(this)}});this._oHistoryPopover.setModel(this._oModel);this._oHistoryPopover.addContent(this._oHistoryList);this.addDependent(this._oHistoryPopover);}return this._oHistoryPopover;};Y.prototype._historyItemFactory=function($,_){var a1=this._oModel.getProperty("/history").indexOf(_.getProperty()),b1=_.getProperty(),c1,d1,e1,f1;switch(b1.noChange||b1.getMetadata().getName()){case"sap.suite.ui.commons.imageeditor.RotateHistoryItem":{d1=v.getText("IMGEDITOR_ROTATE");e1=b1.getDegrees();f1=X.TRANSFORM;break;}case"sap.suite.ui.commons.imageeditor.ResizeHistoryItem":{d1=v.getText("IMGEDITOR_RESIZE");e1=v.getText("IMGEDITOR_HISTORY_TEXT",[b1.getOldWidth()+" x "+b1.getOldHeight(),b1.getWidth()+" x "+b1.getHeight()]);f1=X.TRANSFORM;break;}case"sap.suite.ui.commons.imageeditor.FlipHistoryItem":{d1=v.getText("IMGEDITOR_FLIP");if(b1.getVertical()&&b1.getHorizontal()){e1=v.getText("IMGEDITOR_FLIP_BOTH");f1=X.FLIPHORIZONTAL;}else{e1=b1.getVertical()?v.getText("IMGEDITOR_FLIP_VERTICAL"):v.getText("IMGEDITOR_FLIP_HORIZONTAL");f1=b1.getVertical()?X.FLIPVERTICAL:X.FLIPHORIZONTAL;}break;}case"sap.suite.ui.commons.imageeditor.FilterHistoryItem":{d1=b1.getType();d1=d1[0].toUpperCase()+d1.slice(1);e1=b1.getValue();f1=X.FILTER;break;}case"sap.suite.ui.commons.imageeditor.CropRectangleHistoryItem":case"sap.suite.ui.commons.imageeditor.CropEllipseHistoryItem":{d1=v.getText("IMGEDITOR_CROP");e1=v.getText("IMGEDITOR_HISTORY_TEXT",[b1.getOldWidth()+" x "+b1.getOldHeight(),b1.getWidth()+" x "+b1.getHeight()]);f1=X.CROP;break;}case"NoChange":{d1=v.getText("IMGEDITOR_HISTORY_ORIGINAL");e1=v.getText("IMGEDITOR_HISTORY_ORIGINAL_TEXT");f1=X.RESET;break;}default:{break;}}c1=new o({title:d1,description:e1,icon:f1,selected:{path:"/historyIndex",formatter:function(g1){return a1===g1;}}});return c1;};Y.prototype._getHistoryItems=function(){if(!this._aHistoryItems){this._aHistoryItems=[this._getUndoButton(),this._getHistoryArrowButton(),this._getToolbarSeparator()];}return this._aHistoryItems;};Y.prototype._getUndoButton=function(){var $=this;if(!this._oHistoryButton){this._oHistoryButton=new B({id:this.getId()+"-undoButton",type:D.Transparent,icon:X.UNDO,enabled:{parts:["/history","/historyIndex"],formatter:function(_,a1){return _.length>1&&a1<_.length-1;}},press:function(){$._undo();},tooltip:v.getText("IMGEDITOR_PANEL_UNDO")});this.addDependent(this._oHistoryButton);}return this._oHistoryButton;};Y.prototype._getHistoryArrowButton=function(){var $=this;if(!this._oHistoryArrowButton){this._oHistoryArrowButton=new B({id:this.getId()+"-historyButton",type:D.Transparent,icon:X.DROPDOWN,enabled:{path:"/history",formatter:function(_){return _.length>1;}},press:function(){$._resetValueStates();$._getHistoryPopover().openBy($._oHistoryArrowButton);},tooltip:v.getText("IMGEDITOR_PANEL_HISTORY")});this.addDependent(this._oHistoryArrowButton);}return this._oHistoryArrowButton;};Y.prototype._getToolbarSeparator=function(){if(!this._oSeparator){this._oSeparator=new e({id:this.getId()+"-separator"});this.addDependent(this._oSeparator);}return this._oSeparator;};Y.prototype._getTransformButton=function(){if(!this._oTransformButton){this._oTransformButton=new c({id:this.getId()+"-transformButton",icon:X.TRANSFORM,type:D.Transparent,pressed:{path:"/mode",formatter:function($){return $===z.Transform;}},enabled:{path:"/mode",formatter:function($){return $!==z.Transform;}},press:this._onButtonPress.bind(this,this._setModeTransform.bind(this)),tooltip:v.getText("IMGEDITOR_PANEL_TRANSFORM")});this.addDependent(this._oTransformButton);}return this._oTransformButton;};Y.prototype._getCropButton=function(){if(!this._oCropButton){this._oCropButton=new c({id:this.getId()+"-cropButton",icon:X.CROP,type:D.Transparent,pressed:{path:"/mode",formatter:function($){return $===z.Crop;}},enabled:{path:"/mode",formatter:function($){return $!==z.Crop;}},press:this._onButtonPress.bind(this,this._setModeCrop.bind(this)),tooltip:v.getText("IMGEDITOR_PANEL_CROP")});this.addDependent(this._oCropButton);}return this._oCropButton;};Y.prototype._getFilterButton=function(){if(!this._oFilterButton){this._oFilterButton=new c({id:this.getId()+"-filterButton",icon:X.FILTER,type:D.Transparent,pressed:{path:"/mode",formatter:function($){return $===z.Filter;}},enabled:{path:"/mode",formatter:function($){return $!==z.Filter;}},press:this._onButtonPress.bind(this,this._setModeFilter.bind(this)),tooltip:v.getText("IMGEDITOR_PANEL_FILTER")});this.addDependent(this._oFilterButton);}return this._oFilterButton;};Y.prototype._changeOptionsPanelContent=function($){var _=this._getOptionsPanel(),a1=$();_.removeAllItems();a1.forEach(function(b1){_.addItem(b1);});};Y.prototype._onButtonPress=function($){this.getImageEditor()._cancelPreview();this._setZoom(100);$();};Y.prototype._setModeTransform=function($){this._changeOptionsPanelContent(this._getTransformPanelContent.bind(this));if(this.getImageEditor()){this.getImageEditor().setMode(y.Resize);}if(this.getMode()!==z.Transform){this.setProperty("mode",z.Transform,true);}this._setTransformTypeByKey($||"Resize");this._oModel.setProperty("/mode",z.Transform);};Y.prototype._setModeCrop=function($){this._changeOptionsPanelContent(this._getCropPanelContent.bind(this));if(this.getImageEditor()){this._setCropTypeByKey($||"Rectangle");}if(this.getMode()!==z.Crop){this.setProperty("mode",z.Crop,true);}this._oModel.setProperty("/mode",z.Crop);};Y.prototype._setModeFilter=function(){this._changeOptionsPanelContent(this._getFilterPanelContent.bind(this));if(this.getImageEditor()){this.getImageEditor().setMode(y.Default);}if(this.getMode()!==z.Filter){this.setProperty("mode",z.Filter,true);}this._resetFilterValues();this._selectFilterItem(0);this._oModel.setProperty("/mode",z.Filter);};Y.prototype._constraintValue=function($,_,a1){var b1=a1.getBinding("value"),c1=a1.getBinding("valueState"),d1=a1.getBinding("valueStateText"),e1;if(isNaN($)||$<_.min||$>_.max){e1=v.getText("IMGEDITOR_BAD_NUMBER",[_.min,_.max]);$=this._oModel.getProperty(b1.getPath());}if(e1){this._oModel.setProperty(c1.getPath(),V.Warning);this._oModel.setProperty(d1.getPath(),e1);}this._oModel.setProperty(b1.getPath(),$);a1.setValue($);return $;};Y.prototype._onNumberInputChange=function($,_){var a1=_.getParameter("value"),b1=_.getParameter("newValue"),c1;this._resetValueStates();if(typeof a1==="number"){c1=a1;}else if(typeof b1==="number"){c1=b1;}else{c1=parseInt(_.getParameter("value")||_.getParameter("newValue"),10);}c1=this._constraintValue(c1,$,_.getSource());this[$.callback](c1);};Y.prototype._setRatio=function($,_){if(!this.getImageEditor()||!this.getImageEditor().getLoaded()){return;}this.getImageEditor().setCropAreaByRatio($,_);this._refreshCropAreaSize();};Y.prototype._setCropAreaBySize=function($,_){this.getImageEditor().setCropAreaBySize($,_);this._refreshCropAreaSize();};Y.prototype._setRatioByKey=function($){if($==="Rectangle"){this._setRatio(this._oModel.getProperty("/crop/ratiosRectangle/1/width"),this._oModel.getProperty("/crop/ratiosRectangle/1/height"));}else if($==="Ellipse"){this._setRatio(1,1);}};Y.prototype._setTransformTypeByKey=function($){var _=$==="Resize"?y.Resize:y.Default;if($==="Resize"){this._refreshImageSize();this._selectResizeCustomSizeItem();}else if($==="Rotate"){this._oModel.setProperty("/transform/rotate",0);}else if($==="Flip"){this._resetFlips();}this._oModel.setProperty("/transform/selectedTypeKey",$);this._resetValueStates();if(this.getImageEditor()){this.getImageEditor()._cancelPreview();this.getImageEditor().setMode(_);}};Y.prototype._setCropTypeByKey=function($,_){var a1=this._oModel.getProperty("/crop/types").filter(function(b1){return b1.key===$;})[0];this._setRatioByKey($);this._oModel.setProperty("/crop/selectedTypeKey",$);this._oModel.setProperty("/crop/selectedType",a1);this["_select"+$+"CropCustomSizeItem"](_);this.getImageEditor().setMode("Crop"+$);this._resetValueStates();};Y.prototype._resetCurrentPanel=function(){this.getImageEditor().cancelPreview();switch(this.getMode()){case z.Transform:{this._setTransformTypeByKey(this._oModel.getProperty("/transform/selectedTypeKey"));break;}case z.Crop:{this._setCropTypeByKey(this._oModel.getProperty("/crop/selectedTypeKey"));break;}case z.Filter:{this._selectFilterItem(this._getSelectedFilterIndex());break;}default:break;}this._resetValueStates();};Y.prototype._undo=function(){this.getImageEditor().undo();this._resetCurrentPanel();};Y.prototype._redo=function(){this.getImageEditor().redo();this._resetCurrentPanel();};Y.prototype._jumpToHistory=function($){this.getImageEditor().jumpToHistory($);this._resetCurrentPanel();};Y.prototype._setZoom=function($){this._oModel.setProperty("/crop/zoom",$);this.getImageEditor().zoom($);this._refreshCropAreaSize();};Y.prototype._setWidth=function($){this.getImageEditor().setWidth($,true);this._oModel.setProperty("/transform/height",this.getImageEditor().getPreviewHeight());this._selectResizeCustomSizeItem(this.getImageEditor().getKeepResizeAspectRatio());};Y.prototype._setHeight=function($){this.getImageEditor().setHeight($,true);this._oModel.setProperty("/transform/width",this.getImageEditor().getPreviewWidth());this._selectResizeCustomSizeItem(this.getImageEditor().getKeepResizeAspectRatio());};Y.prototype._setSize=function($,_,a1){if(a1){$=this.getImageEditor().getWidth()*$;_=this.getImageEditor().getHeight()*_;}this._updateCurrentSize($,_);if(this.getImageEditor().getPreviewWidth()===$&&this.getImageEditor().getPreviewHeight()===_){return;}this.getImageEditor().setSize($,_,true);};Y.prototype._rotate=function($){$=$>I.LIMITS.ROTATION_MAX?I.LIMITS.ROTATION_MAX:$;$=$<I.LIMITS.ROTATION_MIN?I.LIMITS.ROTATION_MIN:$;this._oModel.setProperty("/transform/rotate",$);this.getImageEditor().rotate($,true);};Y.prototype._flip=function($,_){this.getImageEditor().flip($,_,true);};Y.prototype._setKeepResizeAspectRatio=function($){this._oModel.setProperty("/transform/keepAspectRatio",$);if(this.getImageEditor()){this.getImageEditor().setKeepResizeAspectRatio($);}};Y.prototype._getKeepCropAspectRatio=function(){return this._oModel.getProperty("/crop/keepAspectRatio");};Y.prototype._setKeepCropAspectRatio=function($){this._oModel.setProperty("/crop/keepAspectRatio",$);if(this.getImageEditor()){this.getImageEditor().setKeepCropAspectRatio($);}};Y.prototype._applyCurrentFilter=function($){var _=this._oModel.getProperty("/filter/selectedFilter");if(typeof $!=="undefined"){this._oModel.setProperty("/filter/selectedFilter/value",$);}this.getImageEditor()[_.type](_.value,true);};Y.prototype._resetFilterValues=function(){var $=this._oModel.getProperty("/filter/filters");$.forEach(function(_,a1){this._oModel.setProperty("/filter/filters/"+a1+"/value",_.defaultValue);},this);};Y.prototype._resetValueStates=function(){var $=["/transform/widthValueState","/transform/heightValueState","/transform/rotateValueState","/crop/zoomValueState","/crop/widthValueState","/crop/heightValueState","/filter/filterValueState"];$.forEach(function(_){this._oModel.setProperty(_,V.None);},this);};Y.prototype._resetFlips=function(){this._oModel.setProperty("/transform/flipVertical",false);this._oModel.setProperty("/transform/flipHorizontal",false);};Y.prototype._applyPreview=function(){this.getImageEditor().applyPreview();this._resetValueStates();switch(this.getMode()){case z.Transform:{switch(this._oModel.getProperty("/transform/selectedTypeKey")){case"Resize":{this._refreshImageSize();break;}case"Rotate":{this._oModel.setProperty("/transform/rotate",0);this._refreshImageSize();break;}case"Flip":{this._resetFlips();break;}default:break;}break;}case z.Crop:{var $=this._oModel.getProperty("/crop/selectedType/apply");if($){this.getImageEditor()[$]();}this._refreshImageSize();this._setRatioByKey(this._oModel.getProperty("/crop/selectedTypeKey"));this._deselectCropItem();this._setZoom(100);this.getImageEditor().setMode(y.Default);break;}case z.Filter:{this._resetFilterValues();break;}default:break;}};Y.prototype._createGridList=function($,_,a1){var b1=this;var c1=new n({width:"auto",mode:"SingleSelectMaster",itemPress:function(d1){b1._resetValueStates();a1.call(b1,d1);},items:{path:$,factory:_.bind(this)}}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridList");c1.setModel(this._oModel);if(!c1._oItemNavigation){c1._startItemNavigation();}c1._oItemNavigation.setColumns(2);return c1;};Y.prototype._selectResizeCustomSizeItem=function($){var _=this._getResizeGridList(),a1=_.getItems()[0];_.setSelectedItem(a1);this._setKeepResizeAspectRatio(!!$);};Y.prototype._deselectCropItem=function(){this._getRectangleCropGridList().removeSelections();this._getEllipseCropGridList().removeSelections();this._blockCrop();};Y.prototype._blockCrop=function(){this._oModel.setProperty("/crop/blocked",true);};Y.prototype._unblockCrop=function(){if(this._oModel.getProperty("/crop/blocked")){this._oModel.setProperty("/crop/blocked",false);}};Y.prototype._selectRectangleCropCustomSizeItem=function($){var _=this._getRectangleCropGridList(),a1=_.getItems()[0];_.setSelectedItem(a1);this._setKeepCropAspectRatio(!!$);this._unblockCrop();};Y.prototype._selectEllipseCropCustomSizeItem=function($){var _=this._getEllipseCropGridList(),a1=_.getItems()[0];_.setSelectedItem(a1);this._setKeepCropAspectRatio(!!$);this._unblockCrop();};Y.prototype._selectFilterItem=function($){var _=this._getFilterGridList(),a1=_.getItems()[$];this._oModel.setProperty("/filter/selectedFilter",a1.getBindingContext().getProperty());this._oModel.setProperty("/filter/selectedFilter/value",this._oModel.getProperty("/filter/selectedFilter/defaultValue"));_.setSelectedItem(a1);};Y.prototype._getSelectedFilterIndex=function(){var $=this._oModel.getProperty("/filter/selectedFilter"),_=$?this._oModel.getProperty("/filter/filters").indexOf($):0;return _;};Y.prototype._getResizeGridList=function(){if(!this._oGridListResize){this._oGridListResize=this._createGridList("/transform/resizes",this._gridRectShapeItemFactory,this._onResizeGridListSelectionChange);}return this._oGridListResize;};Y.prototype._onResizeGridListSelectionChange=function($){var _=$.getParameter("listItem"),a1=_.getBindingContext();if(a1.getProperty("width")){this._setSize(a1.getProperty("width"),a1.getProperty("height"),a1.getProperty("relative"));}this._setKeepResizeAspectRatio(!a1.getProperty("unlockRatio"));};Y.prototype._getRotateGridList=function(){if(!this._oGridListRotate){this._oGridListRotate=this._createGridList("/transform/rotates",this._gridRectShapeItemFactory,this._onRotateGridListSelectionChange);}return this._oGridListRotate;};Y.prototype._onRotateGridListSelectionChange=function($){var _=$.getParameter("listItem"),a1=_.getBindingContext();this._getRotateGridList().removeSelections();this._rotate(this._oModel.getProperty("/transform/rotate")+a1.getProperty("rotate"));};Y.prototype._getFlipGridList=function(){if(!this._oGridListFlip){this._oGridListFlip=this._createGridList("/transform/flips",this._gridRectShapeItemFactory,this._onFlipGridListSelectionChange);}return this._oGridListFlip;};Y.prototype._onFlipGridListSelectionChange=function($){var _=$.getParameter("listItem"),a1=_.getBindingContext(),b1=this._oModel.getProperty("/transform/flipVertical"),c1=this._oModel.getProperty("/transform/flipHorizontal");this._getFlipGridList().removeSelections();b1=b1!==a1.getProperty("flipVertical");c1=c1!==a1.getProperty("flipHorizontal");this._oModel.setProperty("/transform/flipVertical",b1);this._oModel.setProperty("/transform/flipHorizontal",c1);this._flip(b1,c1);};Y.prototype._getRectangleCropGridList=function(){if(!this._oGridListRectCrop){this._oGridListRectCrop=this._createGridList("/crop/ratiosRectangle",this._gridRectShapeItemFactory,this._onRectCropGridListSelectionChange);}return this._oGridListRectCrop;};Y.prototype._onRectCropGridListSelectionChange=function($){var _=$.getParameter("listItem"),a1=_.getBindingContext();this.getImageEditor().setMode(y.CropRectangle);if(a1.getProperty("width")&&a1.getProperty("relative")){this._setRatio(a1.getProperty("width"),a1.getProperty("height"));}else if(a1.getProperty("width")&&!a1.getProperty("relative")){this._setCropAreaBySize(a1.getProperty("width"),a1.getProperty("height"));}this._unblockCrop();this._setKeepCropAspectRatio(!a1.getProperty("unlockRatio"));};Y.prototype._getEllipseCropGridList=function(){if(!this._oGridListEllipseCrop){this._oGridListEllipseCrop=this._createGridList("/crop/ratiosCircle",this._gridCircleShapeItemFactory,this._onEllipseCropGridListSelectionChange);}return this._oGridListEllipseCrop;};Y.prototype._onEllipseCropGridListSelectionChange=function($){var _=$.getParameter("listItem"),a1=_.getBindingContext();this.getImageEditor().setMode(y.CropEllipse);if(a1.getProperty("width")&&a1.getProperty("relative")){this._setRatio(a1.getProperty("width"),a1.getProperty("height"));}else if(a1.getProperty("width")&&!a1.getProperty("relative")){this._setCropAreaBySize(a1.getProperty("width"),a1.getProperty("height"));}this._unblockCrop();this._setKeepCropAspectRatio(!a1.getProperty("unlockRatio"));};Y.prototype._getFilterGridList=function(){if(!this._oGridListFilter){this._oGridListFilter=this._createGridList("/filter/filters",this._gridFilterItemFactory,this._onFilterGridListSelectionChange);}return this._oGridListFilter;};Y.prototype._onFilterGridListSelectionChange=function($){var _=$.getParameter("listItem"),a1=_.getBindingContext();this._resetFilterValues();this._oModel.setProperty("/filter/selectedFilter",a1.getProperty());this.getImageEditor().cancelPreview();this.getImageEditor()[a1.getProperty("type")](a1.getProperty("value"),true);};Y.prototype._gridRectShapeItemFactory=function($,_){var a1;if(_.getProperty("icon")){a1=new F({renderType:G.Bare,alignItems:N.Center,justifyContent:K.Center,items:[new u({src:"{icon}"})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridItemIcon");}else{a1=this._createGridItemRectShape(_.getProperty("width"),_.getProperty("height"));}return this._createGridListItem(a1);};Y.prototype._gridCircleShapeItemFactory=function($,_){var a1;if(_.getProperty("icon")){a1=new F({renderType:G.Bare,alignItems:N.Center,justifyContent:K.Center,items:[new u({src:"{icon}"})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridItemIcon");}else{a1=this._createGridItemCircleShape(_.getProperty("width"),_.getProperty("height"));}return this._createGridListItem(a1);};Y.prototype._refreshGridListsItems=function(){var $=this,_=[{path:"/transform/resizes",fnGetItems:this.getCustomResizeItems.bind(this)},{path:"/crop/ratiosRectangle",fnGetItems:this.getCustomRectangleCropItems.bind(this)},{path:"/crop/ratiosCircle",fnGetItems:this.getCustomEllipseCropItems.bind(this)}];_.forEach(function(a1){var b1=$._oModel.getProperty(a1.path),c1=b1.slice(0,Z.NUM_KEPT_ITEMS);a1.fnGetItems().forEach(function(d1){if(d1.getWidth()>0&&d1.getHeight()>0){c1.push({width:d1.getWidth(),height:d1.getHeight(),text:d1.getLabel(),icon:d1.getIcon(),relative:d1.getRelative()});}});$._oModel.setProperty(a1.path,c1);});};Y.prototype._createGridListItem=function($){return new p({type:x.Active,content:[$,new L({text:"{text}",wrapping:false,textAlign:U.Center,layoutData:[new r({growFactor:0,shrinkFactor:0,baseSize:"auto"})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridItemLabel")]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerGridItem");};Y.prototype._createGridItemRectShape=function($,_){var a1,b1;if($<100){$*=10;_*=10;}else if($>100){$/=10;_/=10;}a1=document.createElementNS("http://www.w3.org/2000/svg","svg");a1.setAttribute("class","sapSuiteUiCommonsImageEditorContainerGridItemHeaderContent");a1.setAttribute("viewBox","-1 -1 "+($+2)+" "+(_+2));b1=document.createElement("rect");b1.setAttribute("x","0");b1.setAttribute("y","0");b1.setAttribute("width",$);b1.setAttribute("height",_);a1.appendChild(b1);return new H({content:new XMLSerializer().serializeToString(a1)});};Y.prototype._createGridItemCircleShape=function($,_){var a1,b1;$*=100;_*=100;a1=document.createElementNS("http://www.w3.org/2000/svg","svg");a1.setAttribute("class","sapSuiteUiCommonsImageEditorContainerGridItemHeaderContent");a1.setAttribute("viewBox","-"+($+2)+" -"+(_+2)+" "+($*2+4)+" "+(_*2+4));b1=document.createElement("ellipse");b1.setAttribute("cx","0");b1.setAttribute("cy","0");b1.setAttribute("rx",$);b1.setAttribute("ry",_);a1.appendChild(b1);return new H({content:new XMLSerializer().serializeToString(a1)});};Y.prototype._gridFilterItemFactory=function($,_){var a1,b1,c1;b1=document.createElementNS("http://www.w3.org/2000/svg","svg");b1.setAttribute("class","sapSuiteUiCommonsImageEditorContainerGridItemHeaderContent sapSuiteUiCommonsImageEditorContainerGridItemHeaderFilterContent");c1=document.createElementNS("http://www.w3.org/2000/svg","use");c1.setAttribute("href","#"+this.getId()+"-origThumbnail");c1.setAttribute("filter","url(#"+this.getId()+"-"+_.getProperty("type")+")");b1.appendChild(c1);a1=new H({content:new XMLSerializer().serializeToString(b1)});return this._createGridListItem(a1);};Y.prototype._getTransformPanelContent=function(){var $=this;if(!this._oTransformToolbarContent){this._oTransformToolbarContent=[new s({tabDensityMode:P.Compact,backgroundDesign:Q.Transparent,headerBackgroundDesign:Q.Transparent,expandable:false,select:function(_){var a1=_.getParameter("key");$._setTransformTypeByKey(a1);},selectedKey:"{/transform/selectedTypeKey}",items:[new t({key:"Resize",text:v.getText("IMGEDITOR_RESIZE"),content:[this._getResizeGridList(),new F({renderType:G.Bare,direction:E.Column,items:[new F({renderType:G.Bare,justifyContent:K.SpaceBetween,items:[new F({renderType:G.Bare,direction:E.Column,items:[new L({text:v.getText("IMGEDITOR_WIDTH"),labelFor:this.getId()+"-transformWidth"}),new f({id:this.getId()+"-transformWidth",type:w.Number,textAlign:U.Right,change:this._onNumberInputChange.bind(this,W.WIDTH),value:{path:"/transform/width",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/transform/widthValueState}",valueStateText:"{/transform/widthValueStateText}",width:"5.9375rem",fieldWidth:"4.375rem",description:v.getText("IMGEDITOR_PX")})]}),new F({renderType:G.Bare,direction:E.Column,justifyContent:K.End,items:[new T({tooltip:v.getText("IMGEDITOR_LOCK_RATIO"),icon:X.LOCK,type:D.Transparent,pressed:{path:"/transform/keepAspectRatio"},press:function(_){$._resetValueStates();$.getImageEditor().setKeepResizeAspectRatio(_.getParameter("pressed"));$._selectResizeCustomSizeItem(_.getParameter("pressed"));}})]}),new F({renderType:G.Bare,direction:E.Column,items:[new L({text:v.getText("IMGEDITOR_HEIGHT"),labelFor:this.getId()+"-transformHeight"}),new f({id:this.getId()+"-transformHeight",type:w.Number,textAlign:U.Right,change:this._onNumberInputChange.bind(this,W.HEIGHT),value:{path:"/transform/height",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/transform/heightValueState}",valueStateText:"{/transform/heightValueStateText}",width:"5.9375rem",fieldWidth:"4.375rem",description:v.getText("IMGEDITOR_PX")})]})]}),new B({width:"50%",text:v.getText("IMGEDITOR_APPLY"),type:D.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")]}),new t({key:"Rotate",text:v.getText("IMGEDITOR_ROTATE"),content:[this._getRotateGridList(),new F({renderType:G.Bare,direction:E.Column,items:[new L({id:this.getId()+"-transformAngle",text:v.getText("IMGEDITOR_TRANSFORM_ANGLE")}),new S({min:I.LIMITS.ROTATION_MIN,max:I.LIMITS.ROTATION_MAX,value:{path:"/transform/rotate",mode:"OneWay"},liveChange:this._onNumberInputChange.bind(this,W.ROTATION),progress:true,ariaLabelledBy:[this.getId()+"-transformAngle"]}),new f({type:w.Number,textAlign:U.Right,width:"50%",fieldWidth:"50%",description:v.getText("IMGEDITOR_TRANSFORM_DEG"),change:this._onNumberInputChange.bind(this,W.ROTATION),value:{path:"/transform/rotate",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/transform/rotateValueState}",valueStateText:"{/transform/rotateValueStateText}",ariaLabelledBy:[this.getId()+"-transformAngle"]}),new B({width:"50%",text:v.getText("IMGEDITOR_APPLY"),type:D.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")]}),new t({key:"Flip",text:v.getText("IMGEDITOR_FLIP"),content:[this._getFlipGridList(),new F({renderType:G.Bare,direction:E.Column,items:[new B({width:"50%",text:v.getText("IMGEDITOR_APPLY"),type:D.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")]})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerTabBar")];this._oTransformToolbarContent.forEach(function(_){this.addDependent(_);},this);}return this._oTransformToolbarContent;};Y.prototype._getCropPanelContent=function(){var $=this;if(!this._oCropToolbarContent){this._oCropToolbarContent=[new s({tabDensityMode:P.Compact,backgroundDesign:Q.Transparent,headerBackgroundDesign:Q.Transparent,expandable:false,select:function(_){var a1=_.getParameter("key");$._setCropTypeByKey(a1);},selectedKey:"{/crop/selectedTypeKey}",items:[new t({tooltip:v.getText("IMGEDITOR_CROP_RECTANGLE"),key:"Rectangle",text:"\ue17b",content:[this._getRectangleCropGridList()]}),new t({tooltip:v.getText("IMGEDITOR_CROP_ELLIPSE"),key:"Ellipse",text:"\ue255",content:[this._getEllipseCropGridList()]})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerTabBar").addStyleClass("sapSuiteUiCommonsImageEditorContainerFilterIcons"),new F({renderType:G.Bare,direction:E.Column,blocked:"{/crop/blocked}",items:[new F({renderType:G.Bare,justifyContent:K.SpaceBetween,items:[new F({renderType:G.Bare,direction:E.Column,items:[new L({text:v.getText("IMGEDITOR_WIDTH"),labelFor:this.getId()+"-cropWidth"}),new f({id:this.getId()+"-cropWidth",type:w.Number,textAlign:U.Right,value:{path:"/crop/width",mode:"OneWay",type:"sap.ui.model.type.Integer"},valueState:"{/crop/widthValueState}",valueStateText:"{/crop/widthValueStateText}",width:"5.9375rem",fieldWidth:"4.375rem",description:v.getText("IMGEDITOR_PX"),change:function(_){var a1=$._oModel.getProperty("/crop/width"),b1=$._oModel.getProperty("/crop/height"),c1=$._getKeepCropAspectRatio(),d1=parseInt(_.getParameter("value"),10),e1,f1,g1;$._resetValueStates();d1=isNaN(d1)?0:d1;e1=c1?d1*b1/a1:b1;f1=$.getImageEditor()._getMaxCropAreaWidth(d1,e1);g1=$.getImageEditor()._getMinCropAreaWidth(d1,e1);if(d1>f1||d1<g1){this.setValue(a1);$._oModel.setProperty("/crop/widthValueState",V.Warning);$._oModel.setProperty("/crop/widthValueStateText",v.getText("IMGEDITOR_BAD_NUMBER",[g1,f1]));}else{$._setCropAreaBySize(d1,e1);}}})]}),new F({renderType:G.Bare,direction:E.Column,justifyContent:K.End,items:[new T({tooltip:v.getText("IMGEDITOR_LOCK_RATIO"),icon:X.LOCK,type:D.Transparent,pressed:{path:"/crop/keepAspectRatio"},press:function(_){var a1=$.getImageEditor().getMode(),b1,c1;$._resetValueStates();if($._oModel.getProperty("/crop/selectedTypeKey")==="Rectangle"){b1=y.CropRectangle;c1=$._selectRectangleCropCustomSizeItem.bind($);}else{b1=y.CropEllipse;c1=$._selectEllipseCropCustomSizeItem.bind($);}if(a1!==b1){$.getImageEditor().setMode(b1);}c1(_.getParameter("pressed"));}})]}),new F({renderType:G.Bare,direction:E.Column,items:[new L({text:v.getText("IMGEDITOR_HEIGHT"),labelFor:this.getId()+"-cropHeight"}),new f({id:this.getId()+"-cropHeight",type:w.Number,textAlign:U.Right,value:{path:"/crop/height",mode:"OneWay",type:"sap.ui.model.type.Integer"},valueState:"{/crop/heightValueState}",valueStateText:"{/crop/heightValueStateText}",width:"5.9375rem",fieldWidth:"4.375rem",description:v.getText("IMGEDITOR_PX"),change:function(_){var a1=$._oModel.getProperty("/crop/width"),b1=$._oModel.getProperty("/crop/height"),c1=$._getKeepCropAspectRatio(),d1=parseInt(_.getParameter("value"),10),e1,f1,g1;$._resetValueStates();d1=isNaN(d1)?0:d1;e1=c1?d1*a1/b1:a1;f1=$.getImageEditor()._getMaxCropAreaHeight(true);g1=$.getImageEditor()._getMinCropAreaHeight(true);if(d1>f1||d1<g1){this.setValue(b1);$._oModel.setProperty("/crop/heightValueState",V.Warning);$._oModel.setProperty("/crop/heightValueStateText",v.getText("IMGEDITOR_BAD_NUMBER",[g1,f1]));}else{$._setCropAreaBySize(e1,d1);}}})]})]}),new F({renderType:G.Bare,alignItems:N.Center,justifyContent:K.SpaceBetween,items:[new L({id:this.getId()+"-cropZoom",text:v.getText("IMGEDITOR_CROP_SIZE")}),new f({type:w.Number,textAlign:U.Right,width:"5.9375rem",fieldWidth:"4.375rem",description:"%",change:this._onNumberInputChange.bind(this,W.ZOOM),value:{path:"/crop/zoom",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/crop/zoomValueState}",valueStateText:"{/crop/zoomValueStateText}",ariaLabelledBy:[this.getId()+"-cropZoom"]})]}),new S({min:I.LIMITS.ZOOM_MIN,max:I.LIMITS.ZOOM_MAX,value:{path:"/crop/zoom",mode:"OneWay"},liveChange:this._onNumberInputChange.bind(this,W.ZOOM),progress:true,ariaLabelledBy:[this.getId()+"-cropZoom"]}),new B({width:"50%",text:v.getText("IMGEDITOR_APPLY"),type:D.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")];this._oCropToolbarContent.forEach(function(_){this.addDependent(_);},this);}return this._oCropToolbarContent;};Y.prototype._getFilterPanelContent=function(){var $=this;if(!this._oFilterToolbarContent){this._oFilterToolbarContent=[this._getFilterGridList(),new S({min:"{/filter/selectedFilter/min}",max:"{/filter/selectedFilter/max}",value:{path:"/filter/selectedFilter/value",mode:"OneWay"},liveChange:this._onNumberInputChange.bind(this,W.FILTER),progress:true,ariaLabelledBy:[this.getId()+"-filterValue"]}),new F({renderType:G.Bare,direction:E.Column,items:[new L({id:this.getId()+"-filterValue",text:v.getText("IMGEDITOR_FILTER_VALUE")}),new f({type:w.Number,textAlign:U.Right,width:"5.9375rem",fieldWidth:"4.375rem",description:"{/filter/selectedFilter/unit}",change:function(_){$._onNumberInputChange(q.extend(W.FILTER,$._oModel.getProperty("/filter/selectedFilter")),_);},value:{path:"/filter/selectedFilter/value",type:"sap.ui.model.type.Integer",mode:"OneWay"},valueState:"{/filter/filterValueState}",valueStateText:"{/filter/filterValueStateText}",ariaLabelledBy:[this.getId()+"-filterValue"]}),new B({width:"50%",text:v.getText("IMGEDITOR_APPLY"),type:D.Emphasized,press:this._applyPreview.bind(this)})]}).addStyleClass("sapSuiteUiCommonsImageEditorContainerPanelArea")];this._oFilterToolbarContent.forEach(function(_){this.addDependent(_);},this);}return this._oFilterToolbarContent;};Y.prototype._getOptionsPanel=function(){if(!this._oOptionsPanel){this._oOptionsPanel=new F({renderType:G.Bare,direction:E.Column,blocked:"{/blocked}"});this._oOptionsPanel.addStyleClass("sapSuiteUiCommonsImageEditorContainerPanel");this._oOptionsPanel.setModel(this._oModel);this.addDependent(this._oOptionsPanel);}return this._oOptionsPanel;};Y.prototype.onkeydown=function($){var _=this;function a1(){return _._oModel.getProperty("/historyIndex")<_._oModel.getProperty("/history").length-1;}if($.ctrlKey&&$.key!=="Control"&&$.shiftKey&&$.key!=="Shift"){switch($.key){case"z":case"Z":if(a1()){this.getImageEditor().undo();if(a1()){this._getUndoButton().focus();}else{this._getHistoryArrowButton().focus();}}$.preventDefault();break;case"y":case"Y":if(this._oModel.getProperty("/historyIndex")>0){this.getImageEditor().redo();this._getUndoButton().focus();}$.preventDefault();break;case"h":case"H":if(this._oModel.getProperty("/history").length>1){this._getHistoryArrowButton().focus();this._getHistoryPopover().openBy(this._oHistoryArrowButton);}$.preventDefault();break;default:break;}}else if($.ctrlKey&&$.key!=="Control"&&!$.shiftKey){switch($.key){case"u":case"U":this._focusOnToolbar();$.preventDefault();break;case"g":case"G":this._focusOnPanel();$.preventDefault();break;case"i":case"I":this._focusOnImageEditor();$.preventDefault();break;case"e":case"E":this._setModeTransform("Resize");this._focusOnItem(this._getResizeGridList().getItems()[0]);$.preventDefault();break;case"r":case"R":this._setModeTransform("Rotate");this._focusOnItem(this._getRotateGridList().getItems()[0]);$.preventDefault();break;case"f":case"F":this._setModeTransform("Flip");this._focusOnItem(this._getFlipGridList().getItems()[0]);$.preventDefault();break;case"j":case"J":this._setModeCrop("Rectangle");this._focusOnItem(this._getRectangleCropGridList().getItems()[0]);$.preventDefault();break;case"s":case"S":this._setModeFilter();this._focusOnItem(this._getFilterGridList().getItems()[0]);$.preventDefault();break;case"Enter":this._applyPreview();break;default:break;}}else if($.altKey&&$.key!=="Alt"){switch($.key){case"Enter":this._switchFocusPanelImage();$.preventDefault();break;default:break;}}};Y.prototype._focusFirstTabbable=function($){var _=$.find(":tabbable").get(0);if(_){_.focus();}};Y.prototype._focusOnToolbar=function(){this._focusFirstTabbable(this._getHeaderToolbar().$());};Y.prototype._focusOnPanel=function(){this._focusFirstTabbable(this._getOptionsPanel().$());};Y.prototype._focusOnImageEditor=function(){this._focusFirstTabbable(this.getImageEditor().$());};Y.prototype._focusOnItem=function($){if($.getDomRef()){if(!this._getHistoryPopover().isOpen()){$.focus();}}else{var _={onAfterRendering:function(){$.removeEventDelegate(_);$.focus();if($.getParent()&&$.getParent().isA("sap.m.List")){$.getParent()._startItemNavigation();}}};$.addEventDelegate(_);}};Y.prototype._switchFocusPanelImage=function(){var $=document.activeElement;if(this._getOptionsPanel().getDomRef().contains($)){this._focusOnImageEditor();}else{this._focusOnPanel();}};return Y;});
