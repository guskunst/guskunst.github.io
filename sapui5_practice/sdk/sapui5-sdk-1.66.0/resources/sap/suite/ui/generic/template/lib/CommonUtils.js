sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/base/Event","sap/ui/core/mvc/ControllerExtension","sap/ui/model/Context","sap/ui/model/Filter","sap/m/Table","sap/m/ListBase","sap/m/MessageBox","sap/ui/generic/app/navigation/service/NavigationHandler","sap/ui/generic/app/navigation/service/NavError","sap/suite/ui/generic/template/lib/testableHelper","sap/base/Log","sap/ui/model/analytics/odata4analytics"],function(q,B,E,C,a,F,R,L,M,N,b,t,c,o){"use strict";var d=sap.ui.getCore();function f(e,P){var i=sap.ui.require(P);return typeof i==="function"&&(e instanceof i);}function g(e){return f(e,"sap/ui/comp/smarttable/SmartTable");}function h(e){return f(e,"sap/ui/comp/smartchart/SmartChart");}function l(e){return f(e,"sap/ui/table/Table");}function m(e){return f(e,"sap/ui/table/AnalyticalTable");}function n(e){return f(e,"sap/ui/table/TreeTable");}function p(e){return f(e,"sap/m/Table");}function r(e){if(h(e)||g(e)){return e.getEntitySet();}else if(g(e.getParent())){return e.getParent().getEntitySet();}}function s(e){var T=e&&sap.ui.getCore().byId(e);if(T){T.focus();}}var g=t.testableStatic(g,"CommonUtils_isSmartTable");function u(v,S,w){var x;var y=Object.create(null);function z(e){var i,j,k,M1;i=e.getEntitySet();j=v.getOwnerComponent().getModel().getMetaModel();k=j.getODataEntitySet(i);M1=j.getODataEntityType(k.entityType);return M1;}function A(e,i,j){var k=e instanceof E?e.getSource():e;var M1=k.getId();var N1=y[M1];if(!N1){if(j){return null;}N1={control:k,infoObject:Object.create(null),categories:[]};(i||q.noop)(N1.infoObject,N1.categories,k);y[M1]=N1;}return N1.infoObject;}function D(e,i){for(var j in y){var k=y[j];if(k.categories.indexOf(e)>=0){i(k.infoObject,k.control);}}}function G(e){S.oApplication.attachControlToParent(e,v.getView());}function H(e){if(e.getVisible&&!e.getVisible()){return null;}return e.getParent()||e.oContainer;}function I(e){var i=v.getView();var j=false;for(var k=i.getVisible()&&d.byId(e);k&&!j;k=H(k)){j=k===i;}return j;}function J(e){for(var i=0;i<e.length;i++){var j=e[i];if(I(j)){return j;}}return"";}function K(e,i,j,k){return S.oApplication.getDialogFragmentForView(v.getView(),e,i,j,k);}var O;function P(){var e=v.getOwnerComponent();O=O||e.getModel("i18n").getResourceBundle();return O.getText.apply(O,arguments);}function Q(k,e,i,j){var M1,N1,O1,P1;var Q1=v.getOwnerComponent();var R1=e.indexOf("::"+Q1.getEntitySet()+"--")+2;M1=e.substring(R1,e.lastIndexOf("::"));M1=M1.replace(/--/g,"|").replace(/::/g,"|");N1=k+"|"+M1;O1=i||k;P1=P(N1,j);if(P1===N1){P1=P(O1,j);}return P1;}function T(e,i){var i=i||e.getSelectionBehavior();if(i==="DATAPOINT"){return{"dataPoints":e.getSelectedDataPoints().dataPoints,"count":e.getSelectedDataPoints().count};}else if(i==="CATEGORY"){return{"dataPoints":e.getSelectedCategories().categories,"count":e.getSelectedCategories().count};}else if(i==="SERIES"){return{"dataPoints":e.getSelectedSeries().series,"count":e.getSelectedSeries().count};}}function U(e,j,k){var M1=[];if(g(e)){e=e.getTable();}else if(h(e)){e=e.getChart();if(e&&e.getMetadata().getName()==="sap.chart.Chart"){var N1=false;j=j||e.getSelectionBehavior();k=k||T(e,j);if(k&&k.count>0){if(j==="DATAPOINT"){N1=true;}var O1=k.dataPoints;var P1=[];for(var i=0;i<O1.length;i++){if(N1){if(O1[i].context){M1.push(O1[i].context);}}else{P1.push(O1[i].dimensions);}}if(!N1){M1[0]=P1;}}}}if(e instanceof L){M1=e.getSelectedContexts();}else if(l(e)){var Q1=e.getSelectedIndices();if(Q1){for(var i=0;i<Q1.length;i++){M1.push(e.getContextByIndex(Q1[i]));}}}return M1;}function V(e){var i={};if(e instanceof sap.ui.core.Element){e.getCustomData().forEach(function(j){i[j.getKey()]=j.getValue();});}return i;}function W(e){var k,M1,N1,O1;var P1=g1(e);if(!g(P1)&&!h(P1)){P1=P1.getParent();}var Q1=U(P1);var R1=P1.getModel();M1=d1(P1);b1(M1,Q1,R1,P1);if(g(P1)){k=P1.getCustomToolbar()&&P1.getCustomToolbar().getContent();}else if(h(P1)){k=P1.getToolbar()&&P1.getToolbar().getContent();}if(k&&k.length>0){for(var i=0;i<k.length;i++){N1=k[i];if(N1.getMetadata().getName()==="sap.m.Button"){X(N1,R1,Q1,P1);}else if(N1.getMetadata().getName()==="sap.m.MenuButton"){O1=N1.getMenu().getItems();if(O1&&O1.length>0){for(var j=0;j<O1.length;j++){N1=O1[j];if(N1.getVisible()){X(N1,R1,Q1,P1);}}}}}}}function X(e,i,j,k){var M1,N1;var O1=V(e);var P1=v.getView();if(O1&&O1.Type){if(O1.originalButtonId){M1=P1.getLocalId(O1.originalButtonId);e=P1.byId(M1);}else{M1=P1.getLocalId(e.getId());}if(O1.Type==="CRUDActionDelete"){N1=_(i,j,k);k.getModel("_templPriv").setProperty("/listReport/deleteEnabled",N1);}else if(O1.Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||O1.Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){var Q1=i.getMetaModel();N1=$(i,Q1,j,O1.Type,O1.Action,k);}}if(/generic\/controlProperties/.test(e.getBindingPath("enabled"))&&N1!==undefined){Z(M1,"enabled",N1);}}function Y(e){var i;var j=g1(e);var k=U(j);var M1=e.getModel();i=e1();b1(i,k,M1,j);}function Z(i,e,j){var k=v.getView().getModel("_templPriv");var M1=k.getProperty("/generic/controlProperties/"+i);if(!M1){M1={};M1[e]=j;k.setProperty("/generic/controlProperties/"+i,M1);}else{k.setProperty("/generic/controlProperties/"+i+"/"+e,j);}}function $(e,i,k,M1,N1,O1){var P1,Q1,R1,S1;var T1=false;if(M1==="com.sap.vocabularies.UI.v1.DataFieldForAction"){P1=i.getODataFunctionImport(N1);R1=P1&&P1["sap:action-for"];if(R1&&R1!==""&&R1!==" "){if(k.length>0){S1=P1["sap:applicable-path"];if(S1&&S1!==""&&S1!==" "){for(var j=0;j<k.length;j++){if(!k[j]){continue;}Q1=e.getObject(k[j].getPath());if(Q1&&Q1[S1]){T1=true;break;}}}else{T1=true;}}}else{T1=true;}}else if(M1==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(k.length>0||(h(O1)&&O1.getDrillStackFilters().length>0)){T1=true;}}return T1;}function _(e,i,j){if(i.length===0){return false;}var k=a1(j);var M1=k&&k.Deletable&&k.Deletable.Path;return i.some(function(N1){var O1=e.getObject(N1.getPath()+"/DraftAdministrativeData");var P1=!(O1&&O1.InProcessByUser&&!O1.DraftIsProcessedByMe);return P1&&!(M1&&!e.getProperty(M1,N1));});}function a1(e){var i=e.getModel()&&e.getModel().getMetaModel();var j=i&&i.getODataEntitySet(e.getEntitySet());var k=j&&j["Org.OData.Capabilities.V1.DeleteRestrictions"];return k;}function b1(e,i,j,k){var M1=f1(k);var N1=v.getView().getModel("_templPriv");var O1=N1.getProperty("/generic/listCommons/breakoutActionsEnabled");if(M1){var P1=v.byId("template::IconTabBar");var Q1="";if(P1){Q1=P1.getSelectedKey();}c1(O1,M1,e,i,j,Q1,k);}N1.setProperty("/generic/listCommons/breakoutActionsEnabled",O1);}function c1(e,i,j,k,M1,N1,O1){var P1;for(var Q1 in i){P1=true;var R1=i[Q1].id+((N1&&!i[Q1].determining)?"-"+N1:"");if(O1&&O1.getId().indexOf("AnalyticalListPage")>-1){P1=!!e[R1].enabled;}if(i[Q1].requiresSelection){if(k.length>0){if(O1&&h(O1)){if(i[Q1].filter==="chart"){P1=true;}}else if(O1&&g(O1)){if(i[Q1].filter!=="chart"){P1=true;}}if(i[Q1].applicablePath!==undefined&&i[Q1].applicablePath!==""){P1=false;for(var S1=0;S1<k.length;S1++){var T1="";var U1=i[Q1].applicablePath.split("/");if(U1.length>1){for(var V1=0;V1<U1.length-1;V1++){T1+="/"+U1[V1];}}var W1=M1.getObject(k[S1].getPath()+T1);var X1=U1[U1.length-1];if(W1[X1]===true){P1=true;break;}}}}else if(h(O1)){if((O1.getId().indexOf("AnalyticalListPage")>-1?i[Q1].filter==="chart":true)){if(O1.getDrillStackFilters().length>0){P1=true;}else{P1=false;}}}else{if(i[Q1].filter!=="chart"){P1=false;}}}e[R1]={enabled:P1};}}function d1(e){var i=[];var j=f1(e);for(var k in j){i.push(j[k].id);}return i;}function e1(){var e=[];var i=f1();for(var j in i){if(i[j].determining){e.push(j);}}return e;}function f1(e){var i=v.getOwnerComponent();var j=i.getAppComponent().getManifestEntry("sap.ui5");var k=j.extends&&j.extends.extensions&&j.extends.extensions["sap.ui.controllerExtensions"];k=k&&k[i.getTemplateName()];k=k&&k["sap.ui.generic.app"];var M1=i.getEntitySet();var N1=V(e).sectionId;if(!N1){return k&&k[M1]&&k[M1]["Actions"];}else{var O1=k&&k[M1]&&k[M1]["Sections"];return O1&&O1[N1]&&O1[N1].Actions;}}function g1(e){var i=e;while(i){if(i instanceof R||l(i)||g(i)||h(i)){return i;}i=i.getParent&&i.getParent();}return null;}function h1(e){if(g(e)){e=e.getTable();}if(l(e)){return e.getBindingInfo("rows");}else if(e instanceof R){return e.getBindingInfo("items");}return null;}function i1(e){var i=h1(e);if(i&&i.binding){i.binding.refresh();}else if(e&&e.rebindTable){e.rebindTable();}}function j1(e){var i=v.getOwnerComponent();var j=i.getModel();var k,M1;var N1=!S.oApplication.checkEtags();if(N1){M1=h1(e);if(M1){k=M1.path;var O1=e.getEntitySet();var P1=j.getMetaModel();var Q1=P1.getODataEntitySet(O1);if(v.getMetadata().getName()==='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage'&&k1(j,Q1)){j.invalidateEntityType(Q1.entityType);}else{j.invalidate(l1.bind(null,k));}var R1=i.getId();var S1=Object.create(null);S1[R1]=true;S.oApplication.refreshAllComponents(S1);}}}function k1(e,i){var j=new o.Model(o.Model.ReferenceByModel(e));var k=j.findQueryResultByName(i.name);var M1=k&&k.getParameterization();return!!M1;}function l1(e,k,i){var j=e[0]==="/"?e.substr(1):e;if(k.split("(")[0]===j){return true;}else{return false;}}function m1(e,i){var j=e.getPath();var k=v.getOwnerComponent();var M1=k.getComponentContainer().getElementBinding();var N1=M1?M1.getPath():"";var O1=null;if(j.indexOf(N1)!==0){O1=h1(i).path;}var P1=!S.oApplication.isNewHistoryEntryRequired(e,O1);var Q1;if(w.isDraftEnabled()){Q1=S.oDraftController.isActiveEntity(e)?1:6;}else{Q1=k.getModel("ui").getProperty("/editable")?6:1;}var R1=w.getViewLevel();if(R1===0){var S1=S.oApplication.getForwardNavigationProperty(R1);}if(S1){var T1=new Promise(function(V1){e.getModel().createBindingContext(S1,e,null,function(W1){if(W1){S.oNavigationController.navigateToContext(W1,O1,P1,Q1);V1();}else{w.navigateToDataLoadedFailedPage();V1();}});});var U1=S.oApplication.getBusyHelper();U1.setBusy(T1);}else{S.oNavigationController.navigateToContext(e,O1,P1,Q1);}}function n1(e,i){if(e instanceof a){S.oNavigationController.navigateToContext(e,i&&i.navigationProperty,i&&i.replaceInHistory);return;}var j=i&&i.routeName;if(j){w.navigateRoute(j,e,null,i&&i.replaceInHistory);return;}c.warning("navigateToContext called without context or route");}function o1(e){if(e instanceof b){if(e.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){M.show(P("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:P("ST_GENERIC_ERROR_TITLE")});}else{M.show(e.getErrorCode(),{title:P("ST_GENERIC_ERROR_TITLE")});}}}function p1(e,i){D1(function(){x=K1();var j={semanticObject:e.semanticObject,action:e.action};var k=x.mixAttributesAndSelectionVariant(e.parameters);v.adaptNavigationParameterExtension(k,j);x.navigate(e.semanticObject,e.action,k.toJSONString(),null,o1);},q.noop,i,"LeavePage");}function q1(e){var M1=[],N1,O1,P1;var Q1=v.getOwnerComponent();var R1=Q1.getModel().getMetaModel();if(!e){return{};}var S1=Q1.getAppComponent().getConfig().pages[0];if(!S1){return{};}var T1=function(i){P1=R1.getODataEntitySet(i.entitySet).entityType;O1=R1.getODataEntityType(P1);N1={};N1={entitySet:i.entitySet,aKeys:R1.getODataEntityType(P1).key.propertyRef,navigationProperty:i.navigationProperty};for(var j=0,V1=N1.aKeys.length;j<V1;j++){var k=0,W1=O1.property.length;for(k;k<W1;k++){if(N1.aKeys[j].name===O1.property[k].name){N1.aKeys[j].type=O1.property[k].type;break;}}}};var U1=function(e,S1){if(!S1.pages){return M1;}for(var i=0,j=S1.pages.length;i<j;i++){if(!S1.pages[i]){break;}if(e===S1.pages[i].entitySet){T1(S1.pages[i]);M1.splice(0,0,N1);break;}M1=U1(e,S1.pages[i]);if(M1.length>0){T1(S1.pages[i]);M1.splice(0,0,N1);}}return M1;};return U1(e,S1);}function r1(k,e){var M1,N1,i,O1;for(i=0,O1=k.length;i<O1;i++){if(k[i].navigationProperty){N1+="/"+k[i].navigationProperty;}else{N1="/"+k[i].entitySet;}for(var j=0,P1=k[i].aKeys.length;j<P1;j++){if(j===0){N1+="(";M1="";}else{M1=",";}switch(k[i].aKeys[j].type){case"Edm.Guid":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){N1+=M1+k[i].aKeys[j].name+"="+"guid'"+e.DraftAdministrativeData[k[i].aKeys[j].name]+"'";}else{N1+=M1+k[i].aKeys[j].name+"="+"guid'"+e[k[i].aKeys[j].name]+"'";}break;case"Edm.Boolean":if(e.DraftAdministrativeData&&e.DraftAdministrativeData.DraftIsCreatedByMe){N1+=M1+k[i].aKeys[j].name+"="+false;}else{N1+=M1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;default:if(typeof e[k[i].aKeys[j].name]==="string"){N1+=M1+k[i].aKeys[j].name+"="+"'"+e[k[i].aKeys[j].name]+"'";}else{N1+=M1+k[i].aKeys[j].name+"="+e[k[i].aKeys[j].name];}break;}if(j===(P1-1)){N1+=")";}}}return N1;}function s1(e,k,v){var M1,N1,O1,P1,Q1,R1,S1;var T1={semanticObject:"",action:""};x=K1();M1=x.mixAttributesAndSelectionVariant({},k);for(P1 in e.semanticAttributesOfSemanticObjects){for(O1 in e.semanticAttributesOfSemanticObjects[P1]){if(!M1.getSelectOption(O1)){M1.addParameter(O1,"");}}Q1=M1.getPropertyNames();T1.semanticObject=P1;v.adaptNavigationParameterExtension(M1,T1);R1=M1.getSelectOptionsPropertyNames();S1=M1.getParameterNames();for(var i=0,U1=Q1.length;i<U1;i++){if(R1.indexOf(Q1[i])<0&&S1.indexOf(Q1[i])<0){delete e.semanticAttributesOfSemanticObjects[P1][Q1[i]];M1.removeSelectOption(Q1[i]);}}if(P1===e.semanticObject){var V1=e.semanticAttributesOfSemanticObjects[""];for(var j=0,U1=S1.length;j<U1;j++){M1.removeParameter(S1[j]);if(!(S1[j]in V1)){var W1=e.semanticAttributesOfSemanticObjects[e.semanticObject][S1[j]];W1=(typeof W1==="undefined"||W1===null)?"":String(W1);M1.addParameter(S1[j],W1);}}M1=x.mixAttributesAndSelectionVariant(e.semanticAttributesOfSemanticObjects[P1],M1.toJSONString());N1=M1.toJSONString();}}delete e.semanticAttributes;x.processBeforeSmartLinkPopoverOpens(e,N1);}function t1(e,j){var k=function(Q1){for(var i=0;i<Q1.length;i++){j(Q1[i].name);}};var M1=v.getView().getModel().getMetaModel();var N1=M1.getODataEntitySet(e,false);var O1=M1.getODataEntityType(N1.entityType,false);k(O1.key.propertyRef);var P1=S.oDraftController.getDraftContext();if(P1.isDraftEnabled(e)){k(P1.getSemanticKey(e));j("IsActiveEntity");j("HasDraftEntity");j("HasActiveEntity");}}function u1(e,i){if(!w.isDraftEnabled()||!e){return;}var j=e.getControlByKey("EditState");var k=j&&j.getSelectedKey()||"";switch(k){case"1":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("HasDraftEntity","EQ",false));break;case"2":i.filters.push(new F("IsActiveEntity","EQ",false));break;case"3":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));i.filters.push(new F("DraftAdministrativeData/InProcessByUser","NE",""));break;case"4":i.filters.push(new F("IsActiveEntity","EQ",true));i.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));i.filters.push(new F("DraftAdministrativeData/InProcessByUser","EQ",""));break;default:var M1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(i.filters[0]&&i.filters[0].aFilters){var N1=i.filters[0];i.filters[0]=new F([N1,M1],true);}else{i.filters.push(M1);}break;}}function v1(e,i){if(i){e.filters.push(new F("IsActiveEntity","EQ",true));}else{var j=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(e.filters[0]&&e.filters[0].aFilters){var k=e.filters[0];e.filters[0]=new F([k,j],true);}else{e.filters.push(j);}}}function w1(i,j,k){if(j&&i&&i.getAnalyticBindingPath&&i.getConsiderAnalyticalParameters()){try{var M1=i.getAnalyticBindingPath();if(M1){j(M1);}}catch(e){c.warning("Mandatory parameters have no values","",k);}}}function x1(e,j,k){for(var i=0;i<j.length;i++){var M1=j[i];var N1=M1.lastIndexOf("/");var O1;if(N1<0){if(S.oApplication.getNavigationProperty(e,M1)){O1=M1;}else{continue;}}else{O1=M1.substring(0,N1);}if(k.indexOf(O1)===-1){k.push(O1);}}}function y1(e,i,j){var k=e.getParameter("bindingParams"),M1=e.getSource().getId();k.parameters=k.parameters||{};var N1=w.getTemplatePrivateModel();var O1=N1.getProperty("/listReport/vDraftState");var P1=N1.getProperty("/listReport/activeObjectEnabled");var Q1=function(X1,Y1,M1){if(i&&i[X1]){var Z1=true;var $1=function(){var _1=arguments[0];if(!(_1 instanceof C)){throw new Error("Please provide a valid ControllerExtension in order to execute extension "+X1);}if(!Z1){throw new Error("Extension "+X1+" must be executed synchronously");}var a2=Array.prototype.slice.call(arguments,1);Y1.apply(null,a2);};i[X1]($1,M1);Z1=false;}};var R1=function(X1){if(!M1||v.byId(M1)===e.getSource()){k.filters.push(X1);}};if((v.getMetadata().getName()!=='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage')||(v.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details')){if(O1=="0"&&w.isDraftEnabled()){v1(k,P1);}else{u1(j,k);}}Q1("addExtensionFilters",R1,M1);if(v.getMetadata().getName()!=='sap.suite.ui.generic.template.ObjectPage.view.Details'){w1(j,i.setBindingPath,i.isAnalyticalListPage?"AnalyticalListPage":"ListReport");}var S1=e.getSource();var T1=S1.getEntitySet();var U1=k.parameters.select&&k.parameters.select.split(",")||[];var V1=k.parameters.expand&&k.parameters.expand.split(",")||[];var W1=function(X1,M1){if(X1&&(!M1||v.byId(M1)===e.getSource())){var Y1=X1.split(',');Y1.forEach(function(Z1){if(Z1&&q.inArray(Z1,U1)===-1){U1.push(Z1);}});}};if(!i.isAnalyticalListPage){t1(T1,W1);}Q1("ensureExtensionFields",W1,M1);(i.addNecessaryFields||q.noop)(U1,W1,T1);x1(T1,U1,V1);if(V1.length>0){k.parameters.expand=V1.join(",");}if(U1.length>0){k.parameters.select=U1.join(",");}}function z1(e,i,j){if(!e){return P("DRAFT_OBJECT");}else if(i){return P(j?"LOCKED_OBJECT":"UNSAVED_CHANGES");}else{return"";}}function A1(){var e=K("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",{formatText:function(){var i=Array.prototype.slice.call(arguments,1);var k=arguments[0];if(!k){return"";}if(i.length>0&&(i[0]===null||i[0]===undefined||i[0]==="")){if(i.length>3&&(i[3]===null||i[3]===undefined||i[3]==="")){return(i.length>2&&(i[1]===null||i[1]===undefined||i[1]===""))?"":i[2];}else{return P(k,i[3]);}}else{return P(k,i[0]);}},closeDraftAdminPopover:function(){e.close();},formatDraftLockText:z1},"admin");return e;}function B1(e,i,j,k,M1,N1){var O1=S.oApplication.getBusyHelper();if(!M1&&O1.isBusy()){return;}if(!w.isDraftEnabled()){var P1=false;if(j&&j.aUnsavedDataCheckFunctions){P1=j.aUnsavedDataCheckFunctions.some(function(T1){return T1();});}var Q1=v.getView();var R1=Q1.getModel();if(P1||R1.hasPendingChanges()){var S1;F1(function(){Q1.setBindingContext(null);R1.resetChanges();Q1.setBindingContext();w.fire(v,"AfterCancel",{});S1=e();},function(){S1=i();},k,N1);return S1;}}return e();}function C1(e,i,j,k){var M1=false;if(j&&j.aUnsavedDataCheckFunctions){M1=j.aUnsavedDataCheckFunctions.some(function(O1){return O1();});}if(M1||v.getView().getModel().hasPendingChanges()){var N1;H1(function(){v.getView().getModel().resetChanges();w.fire(v,"AfterCancel",{});N1=e();},function(){N1=i();},k);return N1;}return e();}function D1(e,i,j,k,M1,N1){if(M1){return B1(e,i,j,k,true,N1);}S.oApplication.performAfterSideEffectExecution(B1.bind(null,e,i,j,k,false,N1));}var E1;function F1(e,i,j,k){var M1;E1=e;if(!j||!k){var N1=K("sap.suite.ui.generic.template.fragments.DataLoss",{onDataLossOK:function(){N1.close();E1();},onDataLossCancel:function(){N1.close();i();}},"dataLoss");if(!j){j="LeavePage";}M1=N1.getModel("dataLoss");M1.setProperty("/mode",j);N1.open();}else{var O1=K("sap.suite.ui.generic.template.fragments.DiscardDraftPopover",{onDiscardConfirm:function(){E1();}},"discard");M1=O1.getModel("discard");M1.setProperty("/placement",sap.m.PlacementType.Top);if(j!=="Proceed"){M1.setProperty("/isCreateDraft",true);}else{M1.setProperty("/isCreateDraft",false);}M1.setProperty("/mode",j);O1.openBy(k.getSource());}}var G1;function H1(e,i,j){G1=e;if(!j){j="LeavePage";}var k=K("sap.suite.ui.generic.template.fragments.DataLossTechnicalError",{onDataLossOK:function(){k.close();G1();},onDataLossCancel:function(){k.close();i();}},"dataLoss");var M1=k.getModel("dataLoss");M1.setProperty("/mode",j);k.open();}function I1(e,i,j,k,M1,N1){if(i.busy.check&&k.isBusy()){N1();return;}var O1=i.busy.set?function(){k.setBusy(Promise.resolve(),false,{actionLabel:i.sActionLabel});return e();}:e;var P1=i.mConsiderObjectsAsDeleted?function(R1){S.oApplication.prepareDeletion(i.mConsiderObjectsAsDeleted);return O1();}:O1;var Q1=(i.dataloss.popup?D1(P1,N1,j,(i.dataloss.navigation?"LeavePage":"Proceed"),true):P1());if(Q1 instanceof Promise){Q1.then(M1,N1);}else{M1();}}function J1(e,i,j){i=q.extend(true,{busy:{set:true,check:true},dataloss:{popup:true,navigation:false}},i);var k=S.oApplication.getBusyHelper();var M1=new Promise(function(N1,O1){S.oApplication.performAfterSideEffectExecution(I1.bind(null,e,i,j,k,N1,O1));});if(i.busy.set){k.setBusy(M1,false,{actionLabel:i.sActionLabel});}return M1;}function K1(){x=x||new N(v);return x;}function L1(e){var j;var k=w.getTemplatePrivateModel();var M1=v.getOwnerComponent();var N1,O1,P1,Q1,R1,S1=[],T1=[],i,U1,V1,W1,X1,Y1,Z1;var $1,_1;N1=M1.getAppComponent();O1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");P1=k.getProperty("/generic/supportedIntents/");if(h(e)){j=e.getToolbar();}else if(g(e)){j=e.getCustomToolbar();}Q1=j.getContent();R1=Q1.length;for(i=0;i<R1;i++){U1=V(Q1[i]);if(U1.hasOwnProperty("SemanticObject")&&U1.hasOwnProperty("Action")){V1=U1.SemanticObject;W1=U1.Action;X1={semanticObject:V1,action:W1,ui5Component:N1};S1.push([X1]);Y1=q.extend({},X1);Y1.bLinkIsSupported=false;T1.push(Y1);}}if(S1.length>0&&O1){Z1=O1.getLinks(S1);Z1.done(function(a2){P1=k.getProperty("/generic/supportedIntents/");$1=a2.length;for(i=0;i<$1;i++){if(a2[i][0].length>0){T1[i].bLinkIsSupported=true;}V1=T1[i].semanticObject;W1=T1[i].action;_1=k.getProperty("/generic/supportedIntents/"+V1);if(!_1){P1[V1]={};P1[V1][W1]={"visible":T1[i].bLinkIsSupported};}else if(!_1[W1]){_1[W1]={"visible":T1[i].bLinkIsSupported};}else{_1[W1]["visible"]=T1[i].bLinkIsSupported;}}k.updateBindings();});}}var K1=t.testable(K1,"getNavigationHandler");var b1=t.testable(b1,"fillEnabledMapForBreakoutActions");var d1=t.testable(d1,"getBreakoutActionIds");var g1=t.testable(g1,"getOwnerControl");var U=t.testable(U,"getSelectedContexts");return{isSmartTable:g,isSmartChart:h,isUiTable:l,isAnalyticalTable:m,isTreeTable:n,isMTable:p,getPositionableControlId:J,getCurrentEntitySetName:r,getMetaModelEntityType:z,getText:P,getContextText:Q,getNavigationHandler:K1,getNavigationKeyProperties:q1,mergeNavigationKeyPropertiesWithValues:r1,executeGlobalSideEffect:function(){if(w.isDraftEnabled()){var e=v.getView();e.attachBrowserEvent("keydown",function(i){var j=(i.target.type==="search")?true:false;var k=(i.target.type==="textarea")?true:false;if(i.keyCode===13&&i.ctrlKey!==true&&e.getModel("ui").getProperty("/editable")&&!j&&!k){var M1=v.getOwnerComponent().getAppComponent().getConfig();var N1=M1.settings&&M1.settings.forceGlobalRefresh;var O1;S.oApplication.addSideEffectPromise(new Promise(function(P1){O1=P1;}));setTimeout(function(){var P1=S.oApplicationController.executeSideEffects(e.getBindingContext(),null,null,N1);P1.then(function(){O1();setTimeout(function(){document.getElementById(i.target.id).focus();});});});}});}},setEnabledToolbarButtons:W,setEnabledFooterButtons:Y,fillEnabledMapForBreakoutActions:b1,getBreakoutActions:f1,getSelectedContexts:U,getSelectionPoints:T,getDeleteRestrictions:a1,setPrivateModelControlProperty:Z,navigateFromListItem:m1,navigateToContext:n1,navigateExternal:p1,semanticObjectLinkNavigation:s1,getCustomData:function(e){var j=e.getSource().getCustomData();var k={};for(var i=0;i<j.length;i++){k[j[i].getKey()]=j[i].getValue();}return k;},onBeforeRebindTableOrChart:y1,formatDraftLockText:z1,showDraftPopover:function(e,i){var j=A1();var k=j.getModel("admin");k.setProperty("/IsActiveEntity",e.getProperty("IsActiveEntity"));k.setProperty("/HasDraftEntity",e.getProperty("HasDraftEntity"));j.bindElement({path:e.getPath()+"/DraftAdministrativeData"});if(j.getBindingContext()){j.openBy(i);}else{j.getObjectBinding().attachDataReceived(function(){j.openBy(i);});}},getContentDensityClass:function(){return S.oApplication.getContentDensityClass();},attachControlToView:G,getDialogFragment:K,processDataLossConfirmationIfNonDraft:D1,processDataLossTechnicalErrorConfirmation:C1,securedExecution:J1,getOwnerControl:g1,getTableBindingInfo:h1,refreshSmartTable:i1,refreshModel:j1,getElementCustomData:V,triggerAction:function(e,i,j,k,M1){D1(function(){S.oCRUDManager.callAction({functionImportPath:j.Action,contexts:e,sourceControl:k,label:j.Label,operationGrouping:"",navigationProperty:""}).then(function(N1){if(N1&&N1.length>0){var O1=N1[0];if(O1.response&&O1.response.context&&(!O1.actionContext||O1.actionContext&&O1.response.context.getPath()!==O1.actionContext.getPath())){S.oApplication.getBusyHelper().getUnbusy().then(S.oViewDependencyHelper.setMeToDirty.bind(null,v.getOwnerComponent(),i));}}});},q.noop,M1,"Proceed");},checkToolbarIntentsSupported:L1,getControlInformation:A,executeForAllInformationObjects:D,focusControl:s};}return B.extend("sap.suite.ui.generic.template.lib.CommonUtils",{constructor:function(e,S,i){q.extend(this,u(e,S,i));}});});
