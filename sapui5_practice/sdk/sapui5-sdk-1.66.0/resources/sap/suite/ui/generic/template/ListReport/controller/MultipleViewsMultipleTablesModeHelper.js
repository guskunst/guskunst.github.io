sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device"],function(q,B,D){"use strict";var P="/listReport/multipleViews";var a=P+"/selectedKey";var b=P+"/msgVisibility";var c=P+"/finalMessage";function g(Q,s,C,t,S,I,d){var e;var f,u=[];var T=t.oComponentUtils.getTemplatePrivateModel();function o(i){var j=i.getParameter("itemContexts")&&i.getParameter("itemContexts")[0];t.oCommonEventHandlers.onListNavigate(i,s,undefined,j);}function h(i){var j,V;j=i.getSource();V=j.getParent();s.updateControlOnSelectionChange(V);}function r(i){var j,V;V=i.getSource();j=V.getChart();j.attachSelectData(h);j.attachDeselectData(h);}function k(i){var j,V,W={};for(j in I){V=I[j].implementingControl;W[V.getId()]=V.getCurrentVariantId()||"";}return{selectedTab:i,tableVariantIds:W};}function l(i){var j,V,W;if(i){if(i.tableVariantIds){for(j in I){V=I[j].implementingControl;W=i.tableVariantIds[V.getId()];if(W){V.setCurrentVariantId(W);}}}return i.selectedTab;}}function m(i,j,V){for(var W in I){var X=I[W].implementingControl;if((j||V)&&X.getTable){X.setCurrentVariantId(j||V);}else if((i||V)&&X.getChart){X.setCurrentVariantId(i||V);}}}function n(){return e;}function p(i){var j=t.oCommonUtils.getMetaModelEntityType(i);return j.property;}function v(i){s.oSmartTable=I[i].implementingControl;}function w(){var i=s.oSmartTable;var T=t.oComponentUtils.getTemplatePrivateModel();var j=G();var V=JSON.parse(j.getValue());if(j){i.removeCustomData(j);}i.addCustomData(new sap.ui.core.CustomData({"key":"activeButtonTableState","value":!V}));T.setProperty("/listReport/activeObjectEnabled",!V);}function G(){var i=s.oSmartTable;var j;var V=i.getCustomData();for(var W=0;W<V.length;W++){if(V[W].getKey()&&V[W].getKey()==="activeButtonTableState"){j=V[W];break;}}return j;}function R(){var i=s.oSmartTable;var T=t.oComponentUtils.getTemplatePrivateModel();var j=T.getProperty("/listReport/activeObjectEnabled");var V=G();if(V){i.removeCustomData(V);}i.addCustomData(new sap.ui.core.CustomData({"key":"activeButtonTableState","value":j}));}function F(i,j){var V,W,X=[];var Y=I[T.getProperty(a)];if(Y&&Y.entitySet===j.getEntitySet()&&(Y.implementingControl.getMetadata().getElementName()===j.getMetadata().getElementName())){for(var Z in i){V=J(i[Z],j);W=V["sap:label"]?V["sap:label"]:V.name;if(!X.includes(W)){X.push(W);}}f=z(j);L(X,f);}N(X);}function x(i,j){var V;V=M(i);if(V){i.removeCustomData(V);}i.addCustomData(new sap.ui.core.CustomData({"key":"multiTabMessageInfo","value":j}));}function y(i){var j,V=[];for(j in I){if(I[j].implementingControl!==i){V.push(I[j].properties);}}return V;}function z(i){var j;var V=T.getProperty(a);var W=C.getOwnerComponent().getAppComponent().getConfig();var X=W&&W.pages[0]&&W.pages[0].component&&W.pages[0].component.settings;for(var Y in X.quickVariantSelectionX.variants){if(X.quickVariantSelectionX.variants[Y].key===V){j=X.quickVariantSelectionX.variants[Y];break;}}var Z=t.oCommonUtils.getMetaModelEntityType(i);var $=j?Z[j.annotationPath]:null;if($&&$.Text){if($.Text.String.indexOf("i18n")!==-1){var _=$.Text.String;_=_.substring(1,_.length-1).split(">").pop();return t.oCommonUtils.getText(_);}else{return($.Text.String);}}}function A(i){if(i&&i.length>0){T.setProperty(b,true);}else{T.setProperty(b,false);}}function E(){var i=s.oSmartTable;var j=M(i);if(j){var V={"filters":j.getValue().filters,"selectedKey":j.getValue().selectedKey,"isClosed":true};x(i,V);A();}}function H(u){var i=false;var j=s.oSmartTable;var V=M(j);if(V&&V.getValue().isClosed){if(V.getValue().filters.length===u.length){if(JSON.stringify(V.getValue().filters)===JSON.stringify(u)){i=true;}}}V={"filters":u,"selectedKey":f};if(i){A();V.isClosed=true;}else{A(u);V.isClosed=false;}x(j,V);}function J(i,j){var V;var W=y(j);for(var X in W){var V=K(W[X],i);if(V){break;}}return V;}function K(i,j){return i.filter(function(V){return V.name===j;})[0];}function L(i,f){var j="";if(i&&i.length>0){if((D.system.tablet||D.system.phone)&&!D.system.desktop){if(i.length>1){j=t.oCommonUtils.getText("MESSAGE_MULTIPLE_VALUES_S_FORM",[i.join(", "),f]);}else{j=t.oCommonUtils.getText("MESSAGE_SINGLE_VALUE_S_FORM",[i[0],f]);}}else{if(i.length>1){j=t.oCommonUtils.getText("MESSAGE_MULTIPLE_VALUES_L_FORM",[i.join(", "),f]);}else{j=t.oCommonUtils.getText("MESSAGE_SINGLE_VALUE_L_FORM",[i[0],f]);}}}T.setProperty(c,j);}function U(i){var j;j=M(i);if(j){var V=j.getValue();L(V.filters,V.selectedKey);A(V.filters);}else{A(u);}}function M(i){var j;var V=I[T.getProperty(a)];if(V.entitySet===i.getEntitySet()&&(V.implementingControl.getMetadata().getElementName()===i.getMetadata().getElementName())){var W=i.getCustomData();for(var X=0;X<W.length;X++){if(W[X].getKey()&&W[X].getKey()==="multiTabMessageInfo"){j=W[X];break;}}}return j;}function N(i){u=i;}function O(){return u;}(function(){var j=C.byId("template::IconTabBar");if(!j){return;}var V=C.getOwnerComponent().getEntitySet();var W=j.getItems();e=false;for(var i=0;i<W.length;i++){var X=W[i].getKey();if(i===0){S(X);}var Y=C.byId("listReport-"+X);if(!s.oSmartTable){s.oSmartTable=Y;}I[X]={id:Y.getId(),entitySet:Y.getEntitySet(),properties:p(Y)};e=e||I[X].entitySet!==V;d(X,Y,Y.getEntitySet());}s.oSmartFilterbar.attachSearch(function(Z){s.oMultipleViewsHandler.refreshOperation(3);});})();return{fnRegisterToChartEvents:r,onDetailsActionPress:o,getContentForIappState:k,getSelectedKeyAndRestoreFromIappState:l,onSelectedKeyChanged:v,getIsDifferentEntitySets:n,setActiveButtonState:w,restoreActiveButtonState:R,getActiveButtonStateCustomData:G,formatNotAppliedFilters:F,onMessageCloseActionPress:E,fnCheckForMessageDisplay:H,fnSetMessageVisibility:A,fnSetNotAppliedFilter:N,fnGetNotAppliedFilter:O,fnUpdateMessageForFilter:U,setControlVariant:m};}return B.extend("sap.suite.ui.generic.template.ListReport.controller.MultipleViewsMultipleTablesModeHelper",{constructor:function(Q,s,C,t,S,i,d){q.extend(this,g(Q,s,C,t,S,i,d));}});});
