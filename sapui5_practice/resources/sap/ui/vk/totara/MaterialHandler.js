sap.ui.define(["./TotaraUtils","./AnnotationHandler"],function(T,A){"use strict";var M=function(){};M.setMaterial=function(s,c){if(T.checkError(c)){return c;}var m=c.materials;var r=new Map();for(var i=0;i<m.length;i++){var a=m[i];var t=s.sceneBuilder.createMaterial(a);var b=s.sceneBuilder.getMaterial(a.id);if(!b.userData){b.userData={};}if(!b.userData.idsOfImagesToRead){b.userData.idsOfImagesToRead=new Set();}else{b.userData.idsOfImagesToRead.clear();}var d=new Set();r.set(a.id,d);if(t.length){for(var e=0;e<t.length;e++){var p=t[e];var f=s.texturesToUpdate;var g=f.get(p.imageId);if(!g){g=[];f.set(p.imageId,g);}g.push({textureType:p.textureType,materialId:a.id});d.add(p.imageId);b.userData.idsOfImagesToRead.add(p.imageId);}}var v=s.contextMap.values();var h=v.next();while(!h.done){var k=h.value;h=v.next();var n=k.materialIdNodeListMapForOpacityUpdate.get(a.id);if(n){for(var j=0;j<n.length;j++){s.sceneBuilder.applyNodeOpacityToSubmeshes(n[j],k.sceneId,a.id);}k.materialIdNodeListMapForOpacityUpdate.delete(a.id);}}s.materialIdsRequested.delete(a.id);}A.updateMaterials(s,c);return r;};M.updateTexture=function(s,a){var t=s.texturesToUpdate.get(a);if(t){for(var i=0,b=t.length;i<b;i++){var c=t[i];s.sceneBuilder.updateTextureMap(c.materialId,c.textureType);}s.texturesToUpdate.delete(a);}};return M;});
