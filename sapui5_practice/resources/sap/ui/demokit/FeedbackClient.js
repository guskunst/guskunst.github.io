/*!
 * OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/core/IconPool','sap/ui/core/library','sap/ui/layout/HorizontalLayout','sap/ui/layout/VerticalLayout','sap/ui/layout/form/SimpleForm','sap/ui/layout/library','sap/ui/commons/Button','sap/ui/commons/CheckBox','sap/ui/commons/FormattedTextView','sap/ui/commons/Label','sap/ui/commons/Link','sap/ui/commons/SegmentedButton','sap/ui/commons/TextArea','sap/ui/commons/TextView','sap/ui/ux3/ToolPopup'],function(q,I,c,H,V,S,l,B,C,F,L,a,b,T,d,e){"use strict";var f=l.form.SimpleFormLayout;var g=c.ValueState;var h=function(){};h.prototype.updateFeedbackContextText=function(){if(this._oIncludeFeedbackContextCB.getChecked()){u.call(this);}else{i.call(this);}function u(){this._oFeedbackContextText.setText("Location: "+this._getCurrentPageRelativeURL()+"\n"+this._getUI5Distribution()+" Version: "+sap.ui.getVersionInfo().version);}function i(){this._oFeedbackContextText.setText(this._getUI5Distribution()+" Version: "+sap.ui.getVersionInfo().version);}};h.prototype._getUI5Distribution=function(){var v=sap.ui.getVersionInfo();var u="SAPUI5";if(v&&v.gav&&/openui5/i.test(v.gav)){u="OpenUI5";}return u;};h.prototype._getCurrentPageRelativeURL=function(){var p=window.location;return p.pathname+p.hash+p.search;};h.prototype.createFeedbackPopup=function(){this._oFeedbackContextText=new d("oFeedbackContextText");this._oIncludeFeedbackContextCB=new C("includePageCB");var t=this;var o=q.sap.loadResource('sap/ui/demokit/configuration/properties.json');var s=o["FeedbackServiceURL"];var i='Describe what you like or what needs to be improved. You can share your feedback for the overall Demokit experience or for the specific page you are currently viewing.';var j,k,m,n,r,p,u,v,w,x;function y(R){A();R.addContent(w);j.removeAllContent();j.addContent(R);}function z(){j.setBusyIndicatorDelay(0);j.setBusy(true);u.setValueState(g.None);u.setPlaceholder(i);}function A(){j.setBusy(false);n.setText("");p.setSelectedButton();u.setValue('');t._oIncludeFeedbackContextCB.setChecked(false);t._oIncludeFeedbackContextCB.fireChange();t._oFeedbackContextText.setVisible(false);v.setText("Show context data");v.setTooltip("Show context data");x.setEnabled(false);}function D(){I.addIcon("icon-face-very-bad","FeedbackRatingFaces",{fontFamily:"FeedbackRatingFaces",content:"E086",suppressMirroring:true});I.addIcon("icon-face-bad","FeedbackRatingFaces",{fontFamily:"FeedbackRatingFaces",content:"E087",suppressMirroring:true});I.addIcon("icon-face-neutral","FeedbackRatingFaces",{fontFamily:"FeedbackRatingFaces",content:"E089",suppressMirroring:true});I.addIcon("icon-face-happy","FeedbackRatingFaces",{fontFamily:"FeedbackRatingFaces",content:"E08B",suppressMirroring:true});I.addIcon("icon-face-very-happy","FeedbackRatingFaces",{fontFamily:"FeedbackRatingFaces",content:"E08C",suppressMirroring:true});}function E(){var R=new F("feedbackRateYourExperienceLabel");R.setHtmlText("<span class='feedbackAsterisk'>*</span>Rate your experience:");n=new L("feedbackRatingLabel",{});return new H('feedbackRatingHeader',{content:[R,n]});}function G(){D();p=new b({id:"feedbackRatingButton",buttons:[R("icon-face-very-bad","Very Poor",1),R("icon-face-bad","Poor",2),R("icon-face-neutral","Average",3),R("icon-face-happy","Good",4),R("icon-face-very-happy","Excellent",5)]});function R(W,X,Y){var Z="sap-icon://FeedbackRatingFaces/"+W;return new B({icon:Z,width:"20%",press:U.bind(this,X,Y)});}function U(W,X){n.setText(W);r=X;x.setEnabled(true);}return p;}function J(){u=new T("demokitFeedbackInput",{rows:13});u.setPlaceholder(i);return u;}function K(){t._oIncludeFeedbackContextCB.setText('Feedback is related to the current page');t._oIncludeFeedbackContextCB.attachChange(t.updateFeedbackContextText.bind(t));v=new a("feedbackContextDataLink",{wrapping:"false",text:"Show context data",tooltip:"Show context data",press:function(){if(t._oFeedbackContextText.getVisible()===false){v.setText("Hide context data");v.setTooltip("Hide context data");t._oFeedbackContextText.setVisible(true);}else{v.setText("Show context data");v.setTooltip("Show context data");t._oFeedbackContextText.setVisible(false);}}});return new H("feedbackContextButtons",{content:[t._oIncludeFeedbackContextCB,v]});}function M(){t._oFeedbackContextText.addStyleClass("feedbackContextData");t._oFeedbackContextText.setVisible(false);t.updateFeedbackContextText();return t._oFeedbackContextText;}function N(){var R=new a({text:"Privacy",tooltip:"Privacy",target:"_blank",href:"https://help.hana.ondemand.com/privacy.htm"});var U=new a({text:"Terms of Use",tooltip:"Terms of Use",target:"_blank",href:"https://help.hana.ondemand.com/terms_of_use.html"});var W=new a({text:"Legal Agreement",tooltip:"Legal Agreement",target:"_blank",href:"./legal_agreement_with_privacy.html"});var X=new F();var Y='Your feedback is anonymous, we do not collect any personal data. For more information see <embed data-index=\"0\">, <embed data-index=\"1\"> & <embed data-index=\"2\">.';X.addStyleClass("feedbackLicenseText");X.setHtmlText(Y);X.addControl(R);X.addControl(U);X.addControl(W);return X;}function O(){var R=new B({text:"Cancel",tooltip:"Cancel",press:function(){A();j.close();}});w=new B('closeBtn',{text:"Close",tooltip:"Close",press:function(){j.close();}});x=new B('sendBtn',{text:"Send",tooltip:"Send feedback",enabled:false,press:function(){var U={};if(t._oIncludeFeedbackContextCB.getChecked()){U={"texts":{"t1":u.getValue()},"ratings":{"r1":{"value":r}},"context":{"page":t._getCurrentPageRelativeURL(),"attr1":t._getUI5Distribution()+":"+sap.ui.version}};}else{U={"texts":{"t1":u.getValue()},"ratings":{"r1":{"value":r}},"context":{"attr1":t._getUI5Distribution()+":"+sap.ui.version}};}z();q.ajax({url:s,type:"POST",contentType:"application/json",data:JSON.stringify(U)}).done(function(){y(k);}).fail(function(){y(m);});}});k=new V({content:[new F('successMsg',{htmlText:'<h4>Your feedback was sent successfully.</h4>'})]});m=new V({content:[new F('errorMsg',{htmlText:'<h4>Your feedback was not sent.</h4>'})]});return new H('feedbackButtons',{content:[x,R]});}var P=new S({maxContainerCols:1,width:'400px',editable:true,layout:f.ResponsiveGridLayout,content:[new L({text:'Send us your feedback!'}),E(),G(),J(),K(),M(),N(),O()]});var Q="theme/img/themeswitch_";j=new e('feedBackPopup',{icon:'sap-icon://comment',iconHover:Q+'hover.png',iconSelected:Q+'selected.png',content:[P],defaultButton:x,closed:function(){this.removeAllContent();this.addContent(P);}});j.setTooltip("Send us your feedback!");return j;};return h;});
