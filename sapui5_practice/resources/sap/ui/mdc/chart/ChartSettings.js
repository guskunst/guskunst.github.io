/*
 * ! SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/mdc/p13n/Util",'sap/ui/mdc/library'],function(U,M){"use strict";var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");var C={showPanel:function(c,p,s,P){return new Promise(function(r,b){C["_getP13nStateOf"+p](c,P).then(function(m){U["showP13n"+p](s,m.baseData,m.runtimeData,c,r);});});},_getP13nStateOfChart:function(c,p){return new Promise(function(r,b){var A={Dimension:[{key:M.ChartItemRoleType.category,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_CATEGORY')},{key:M.ChartItemRoleType.category2,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_CATEGORY2')},{key:M.ChartItemRoleType.series,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_SERIES')}],Measure:[{key:M.ChartItemRoleType.axis1,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_AXIS1')},{key:M.ChartItemRoleType.axis2,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_AXIS2')},{key:M.ChartItemRoleType.axis3,text:a.getText('chart.PERSONALIZATION_DIALOG_CHARTROLE_AXIS3')}]};var d=a.getText('chart.PERSONALIZATION_DIALOG_TYPE_DIMENSION');var m=a.getText('chart.PERSONALIZATION_DIALOG_TYPE_MEASURE');var i={};p.forEach(function(o){i[o.name]=o;o.availableRoles=A[o.kind];o.visible=false;});r({baseData:{items:p},runtimeData:{items:this.getItems().map(function(I){return{id:I.getId(),name:I.getKey(),label:I.getLabel()||i[I.getKey()].label,tooltip:I.getLabel()||i[I.getKey()].label,visible:I.getVisible(),kind:I.getVizItemType()===M.ChartItemType.Dimension?d:m,role:I.getRole(),aggregationMethod:i[I.getKey()].aggregationMethod,propertyPath:i[I.getKey()].propertyPath,availableRoles:A[I.getVizItemType()]};})}});}.bind(c));},_getP13nStateOfSort:function(c,p){return new Promise(function(r,b){var s={};for(var i=0;i<p.length;i++){if(p[i].sortable&&this._aInResultProperties.indexOf(p[i].name)!=-1){s[p[i].name]=p[i];}}var g=function(k,I){var t;I.some(function(o){if(o.getKey()===k){t=o.getLabel();return true;}});return t||s[k].label;};var G=function(I){var P=[];for(var k in s){P.push({name:s[k].name,label:g(k,I),tooltip:g(k,I),sortOrder:undefined,selected:false});}return P;};var I=this.getItems();var S=this._getSorters()?this._getSorters():[];r({baseData:{items:G(I)},runtimeData:{items:S.map(function(o){return{name:o.sPath,label:g(o.sPath,I),tooltip:g(o.sPath,I),sortOrder:o.bDescending?"Descending":"Ascending",selected:true};})}});}.bind(c));}};return C;});
