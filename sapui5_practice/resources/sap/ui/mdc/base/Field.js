/*!
 * SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(['sap/ui/base/ManagedObjectObserver','./FieldBase','./FieldBaseRenderer','./Condition','sap/base/util/deepEqual'],function(M,F,a,C,d){"use strict";var b=F.extend("sap.ui.mdc.base.Field",{metadata:{library:"sap.ui.mdc",properties:{value:{type:"any",defaultValue:null},additionalValue:{type:"any",defaultValue:null}},events:{change:{parameters:{value:{type:"string"},valid:{type:"boolean"}}}},defaultProperty:"value"},renderer:a});b.prototype.init=function(){F.prototype.init.apply(this,arguments);this.setMaxConditions(1);this.setProperty("_onlyEEQ",true,true);this._oObserver.observe(this,{properties:["value","additionalValue"]});};b.prototype.exit=function(){F.prototype.exit.apply(this,arguments);};b.prototype.bindProperty=function(n,B){if(n==="value"&&!B.formatter){B.targetType="raw";if(!this._oDataType&&B.type){this._oDataType=B.type;}}F.prototype.bindProperty.apply(this,arguments);};b.prototype._handleModelContextChange=function(E){F.prototype._handleModelContextChange.apply(this,arguments);if(!this._oDataType){var B=this.getBinding("value");if(B){this._oDataType=B.getType();}}};b.prototype._initDataType=function(){F.prototype._initDataType.apply(this,arguments);var B=this.getBinding("value");if(B){this._oDataType=B.getType();}};b.prototype.setMaxConditions=function(m){if(m!==1){throw new Error("Only one condition allowed for Field "+this);}return this.setProperty("maxConditions",m,true);};b.prototype._observeChanges=function(o){F.prototype._observeChanges.apply(this,arguments);var f;var g;var v;var O;var s;if(o.name==="value"){var A=c.call(this);v=o.current;this._vValue=v;if(v!==undefined&&v!==null&&v!==""){if(A){f=C.createItemCondition(v,A);}else{f=C.createItemCondition(v);}g=this.getConditions();O=g[0]&&g[0].values[0];s=g[0]&&g[0].values[1];if(!g[0]||g[0].operator!=="EEQ"||!e.call(this,O,v)||s!==A){this.setConditions([f]);}}else{this.setConditions([]);}}if(o.name==="additionalValue"){this._vAdditionalValue=o.current;v=_.call(this);if(v!==undefined&&v!==null){if(o.current){f=C.createItemCondition(v,o.current);}else{f=C.createItemCondition(v);}g=this.getConditions();O=g[0]&&g[0].values[0];s=g[0]&&g[0].values[1];if(!g[0]||g[0].operator!=="EEQ"||!e.call(this,O,v)||s!==o.current){this.setConditions([f]);}}else{this.setConditions([]);}}};function _(){return this._vValue;}function c(){return this._vAdditionalValue;}function e(v,V){var E=v===V;if(!E&&this._oDataType&&(this._oDataType.isA("sap.ui.model.odata.type.Unit")||this._oDataType.isA("sap.ui.model.odata.type.Currency"))&&Array.isArray(v)&&Array.isArray(V)){if(v[0]===V[0]&&v[1]===V[1]&&((this._bUnitSet&&(!v[2]||!V[2]))||d(v[2],V[2]))){E=true;}if(v[2]||V[2]){this._bUnitSet=true;}}return E;}b.prototype._fireChange=function(f,v,w){var V;var A;if(v){if(f.length===0&&this._oDataType){V=this._oDataType.parseValue("","string");}else if(f.length===1){V=f[0].values[0];if(f[0].values.length>1){A=f[0].values[1];}}this._vValue=V;this._vAdditionalValue=A;this.setProperty("value",V,true);this.setProperty("additionalValue",A,true);}else{V=w;}this.fireChange({value:V,valid:v});};return b;},true);
