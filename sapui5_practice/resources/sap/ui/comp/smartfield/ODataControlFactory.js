/*
 * SAPUI5

		(c) Copyright 2009-2019 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/library","sap/m/library","sap/ui/comp/library","sap/m/TextArea","sap/m/Link","sap/m/CheckBox","sap/m/ComboBox","sap/m/DatePicker","sap/m/DateTimePicker","sap/m/FlexItemData","sap/m/HBox","sap/m/Input","sap/m/Select","sap/m/Text","sap/ui/core/Renderer","sap/ui/comp/navpopover/SmartLink","./ControlFactoryBase","./FieldControl","./ODataControlSelector","./ODataHelper","./ODataTypes","sap/m/ObjectNumber","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/TimePicker","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartfield/type/TextArrangementString","sap/ui/comp/smartfield/Configuration","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/navpopover/NavigationPopoverHandler","sap/ui/core/InvisibleText","sap/base/Log","sap/base/assert","sap/base/security/URLWhitelist","sap/base/util/merge"],function(c,m,l,T,L,C,a,D,b,F,H,I,S,d,R,e,f,g,O,h,i,j,k,o,p,q,r,s,t,M,N,u,v,w,U,x){"use strict";var V=c.ValueState;var y=c.TextAlign;var z=m.InputType;var A=m.FlexJustifyContent;var B=l.smartfield.TextInEditModeSource;var E=l.smartfield.CriticalityRepresentationType;var G=l.smartfield.ControlContextType;var J=c.TextDirection;var K=m.FlexAlignContent;var P;var Q=f.extend("sap.ui.comp.smartfield.ODataControlFactory",{constructor:function(n,W,X){f.call(this,n,W);this.sName="ODataControlFactory";this._oMetaData={annotations:{}};this._oMeta=X;this._oHelper=new h(n,this._oBinding);this._oFieldControl=new g(W,this._oHelper);this._oTypes=new i(W);this._oSelector=new O(this._oMetaData,W,this._oTypes);this._bInitialized=false;this.bPending=false;this._oAmountInputFlexItemData=null;this._oUOMInputFlexItemData=null;this._oUOMTextFlexItemData=null;this.oAmountField=null;this.bTextInEditModeSourceValidMetadata=false;P=sap.ui.require("sap/ui/comp/smartfield/SmartField");if(!P){throw new Error("SmartField module not loaded for "+this);}}});Q.prototype._init=function(n){this._oMetaData.model=n.model;this._oMetaData.path=n.path;this._oMetaData.entitySet=n.entitySetObject||this._oHelper.oMeta.getODataEntitySet(n.entitySet);if(this._oHelper.oMeta){w(this._oMetaData.entitySet,'The entity set named "'+n.entitySet+'" was not found in the "'+this._oHelper.oMeta.getODataEntityContainer().name+'" entity container of the service metadata document. - '+this.getMetadata().getName());}this._oMetaData.entityType=n.entityType||this._oHelper.oMeta.getODataEntityType(this._oMetaData.entitySet.entityType);this._oMetaData.navigationPath=n.navigationPath||null;if(this._oModel){this._oHelper.checkNavigationProperty(this._oMetaData,this._oParent);this._oHelper.getProperty(this._oMetaData);var W=this.getEdmProperty();w(!!W,'The EDM property "'+n.path+'" was not found in the "'+this._oMetaData.entityType.namespace+"."+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(W){this._oMetaData.annotations.text=this._oHelper.getTextProperty2(this._oMetaData);this._oMetaData.annotations.uom=this._oHelper.getUnitOfMeasure2(this._oMetaData);this._oHelper.getValueListData(this._oMetaData);this._oMetaData.annotations.lineitem=this._oHelper.getAnalyzer().getLineItemAnnotation(this._oMetaData.entitySet.entityType);this._oHelper.getUOMValueListAnnotationPath(this._oMetaData);this._oMetaData.annotations.semantic=M.getSemanticObjectsFromProperty(W);this._oMetaData.annotations.semanticKeys=this._oHelper.getAnalyzer().getSemanticKeyAnnotation(this._oMetaData.entitySet.entityType);if(this._oMetaData.annotations.uom){this._oMetaData.annotations.uom.annotations={};this._oHelper.getValueListData(this._oMetaData.annotations.uom);}this._oHelper.getUOMTextAnnotation(this._oMetaData);if(this._oParent&&this._oParent.getExpandNavigationProperties()){var X=this._oParent.getBindingContext(),Y=X&&X.getObject(),Z=Y&&Y.__metadata.created;if(!Z){var $=this._oHelper.getAutoExpandProperties(W);if($.length>0){this._oParent.bindElement({path:"",parameters:{expand:$,select:$}});}}}}}else{this._oMetaData.modelObject=n.modelObject;this._oMetaData.property=n.property;this._oMetaData.property.valueListAnnotation=null;this._oMetaData.property.valueListKeyProperty=null;this._oMetaData.property.valueListEntitySet=null;this._oMetaData.property.valueListEntityType=null;this._oMetaData.annotations.text=n.annotations.text;this._oMetaData.annotations.uom=n.annotations.uom;if(this._oMetaData.annotations.uom&&!this._oMetaData.annotations.uom.annotations){this._oMetaData.annotations.uom.annotations={};}this._oMetaData.annotations.valuelist=n.annotations.valuelist;this._oMetaData.annotations.valuelistType=n.annotations.valuelistType;this._oMetaData.annotations.lineitem=n.annotations.lineitem;this._oMetaData.annotations.semantic=n.annotations.semantic;this._oMetaData.annotations.valuelistuom=n.annotations.valuelistuom;}};Q.prototype._initValueList=function(n){var W=this._oMetaData.property,X=n.primaryValueListAnnotation;this._oMetaData.annotations.valueListData=X;W.valueListAnnotation=X;W.valueListKeyProperty=this._oHelper.getODataValueListKeyProperty(X);W.valueListEntitySet=this._oHelper.oMeta.getODataEntitySet(X.valueListEntitySetName);W.valueListEntityType=this._oHelper.oMeta.getODataEntityType(this._oHelper.oMeta.getODataEntitySet(X.valueListEntitySetName).entityType);};Q.prototype._createEdmDisplay=function(){var n,W,X,Y,Z=this,$={width:true,textAlign:true},_=this.getEdmProperty();if(_){Y=this._oHelper.oAnnotation.getText(_);}var a1=this._oParent.data("configdata");var b1=((a1&&(a1.isInnerControl!==true))||this._oParent.isContextTable());var c1=this._oSelector.checkComboBox(b1);if(c1.combobox&&(this._oParent.getFetchValueListReadOnly()||(Y===undefined))){return this._createComboBox({valueHelp:{annotation:c1.annotation,noDialog:true,noTypeAhead:true},edit:false});}if(this._checkLink()&&!this._oSelector.useObjectIdentifier()){return this._createLink();}var d1=this.createAttributes(null,this._oMetaData.property,$);var e1=this._oSelector.checkDatePicker()||((this._oMetaData.property&&this._oMetaData.property.property)?this._oMetaData.property.property.type.startsWith("Edm.Date"):false);var f1;if(e1){var g1=this.getFormatSettings("dateFormatSettings");f1=this._oTypes.getType(this._oMetaData.property,g1,{displayFormat:"Date"});d1.text={model:this._oMetaData.model,path:this._oMetaData.path,type:f1};}else{d1.text={model:this._oMetaData.model,path:this._oHelper.getEdmDisplayPath(this._oMetaData),type:this._oTypes.getType(this._oMetaData.property)};}if(_){W=this._oHelper.oAnnotation.isMasked(_);if(W){d1.text.formatter=i.maskValue;}if(Y){X=this._oSelector.useObjectIdentifier(e1,W);if(X){delete d1.width;delete d1.textAlign;d1.text={path:this._oMetaData.path};d1.title={path:this._oHelper.getEdmDisplayPath(this._oMetaData)};if(this._oParent.hasListeners("press")){d1.titleActive=true;d1.titlePress=function(k1){Z._oParent.firePress(k1);};}else if(this._oMetaData.annotations.semantic&&this._oMetaData.annotations.semantic.defaultSemanticObject){var h1;var i1;var j1=this._oMetaData.annotations.semantic.additionalSemanticObjects.concat(this._oMetaData.annotations.semantic.defaultSemanticObject);q.getDistinctSemanticObjects().then(function(k1){h1=q.hasDistinctSemanticObject(j1,k1);if(h1){var l1=Z._oParent.getBindingInfo("value");var m1=l1.parts[0].path;var n1=Z._oHelper.oAnnotation.getLabel(Z._oMetaData.property.property);if(Z._oMetaData.annotations.lineitem&&Z._oMetaData.annotations.lineitem.labels&&Z._oMetaData.annotations.lineitem.labels[m1]){n1=Z._oMetaData.annotations.lineitem.labels[m1];}i1=new N({semanticObject:Z._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:Z._oMetaData.annotations.semantic.additionalSemanticObjects,semanticObjectLabel:n1,fieldName:m1,navigationTargetsObtained:function(o1){var p1=sap.ui.getCore().byId(o1.getSource().getControl());var q1=o1.getParameters().mainNavigation;if(q1){q1.setDescription(p1.getText());}o1.getParameters().show(p1.getTitle(),q1,undefined,undefined);}});}});d1.titleActive={path:"$sapuicompsmartfield_distinctSO>/distinctSemanticObjects",formatter:function(k1){return q.hasDistinctSemanticObject(j1,k1);}};d1.titlePress=function(k1){if(h1&&i1){i1.setControl(k1.getSource(k1.getParameter("domRef")));i1.openPopover();}};}}else if(!(a1&&(a1.isInnerControl===true))){d1.text={};d1.text.parts=[];d1.text.parts.push(this._oMetaData.path);d1.text.parts.push(this._oHelper.getEdmDisplayPath(this._oMetaData));d1.text.formatter=function(k1,l1){if(c1.combobox){return Z._formatDisplayBehaviour("defaultComboBoxReadOnlyDisplayBehaviour",k1,l1);}if(e1){k1=f1.formatValue(k1,"string");}return Z._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",k1,l1);};}}else if(this._oSelector.checkCheckBox()){d1.text.formatter=function(k1){return Z._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",k1);};}}if(X){n=new k(this._oParent.getId()+"-objIdentifier",d1);if(this._oMetaData.annotations.semantic){n.setModel(q.getJSONModel(),"$sapuicompsmartfield_distinctSO");}}else{if(d1.text.type&&d1.text.type.isA("sap.ui.comp.smartfield.type.DateTime")&&d1.text.type.oConstraints&&d1.text.type.oConstraints.isDateOnly){d1.wrapping=false;}if(this._oParent.isContextTable()&&sap.ui.getCore().getConfiguration().getRTL()){d1.textDirection="LTR";}n=new d(this._oParent.getId()+"-text",d1);}if(!X&&a1&&a1.configdata&&a1.configdata.onText){a1.configdata.onText(n);}return{control:n,onCreate:"_onCreate",params:{noValidations:true}};};Q.prototype._createEdmTime=function(){var n={width:true,placeholder:true,valueState:true,valueStateText:true};var W=Q.getBoundPropertiesMapInfoForInnerControl(p.getMetadata().getName(),{propertyName:"value"})[0];var X={valueFormat:"HH:mm:ss"};X=Object.assign(X,this.createAttributes(W,this._oMetaData.property,n,{event:"change"}));if(X.width===""){X.width="100%";}var Y=new p(this._oParent.getId()+"-timePicker",X);return{control:Y,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:X.value.type,property:this._oMetaData.property}}};};Q.prototype._createObjectStatus=function(){var n=this.createAttributes(null,this._oMetaData.property,null),W=this._oHelper.oAnnotation.getText(this.getEdmProperty());var X=Q.getBoundPropertiesMapInfoForInnerControl(o.getMetadata().getName(),{propertyName:"value"})[0];if(W){n[X]={parts:[this._oHelper.getEdmDisplayPath(this._oMetaData)]};}else{n[X]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};}this._addObjectStatusAttributes(n);var Y=new o(this._oParent.getId()+"-objStatus",n);return{control:Y,onCreate:"_onCreate",params:{getValue:"getText",noValidation:true}};};Q.prototype._addObjectStatusAttributes=function(n){var W,X=this._oParent.getControlProposal(),Y=X.getObjectStatus();if(Y){W=Y.getBindingInfo("criticality");}var Z=function(_){var a1={0:V.None,1:V.Error,2:V.Warning,3:V.Success};var b1={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":V.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":V.Warning,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":V.Error,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":V.Success};return b1[_]||a1[_]||V.None;};var $=function(){var _,a1={"Error":"sap-icon://status-negative","Warning":"sap-icon://status-critical","Success":"sap-icon://status-positive","None":"sap-icon://status-inactive"};if(W){if(W.formatter){_=W.formatter.apply(null,arguments);}else{_=arguments[0];}}else{_=Y.getCriticality();}if((_===undefined)||(_===null)){return null;}return a1[Z(_)];};if(W){n.state={formatter:function(){var _;if(W.formatter){_=W.formatter.apply(null,arguments);}else{_=arguments[0];}return Z(_);},parts:W.parts};if(Y.getCriticalityRepresentationType()!==E.WithoutIcon){n.icon={formatter:$,parts:W.parts};}}else{if(Y){n.state=Z(Y.getCriticality());if(Y.getCriticalityRepresentationType()!==E.WithoutIcon){n.icon=$();}}else{n.icon=$();}}};Q.prototype._createEdmString=function(){if(this._oSelector.checkCheckBox()){return this._createCheckBox();}var n=this._oSelector.checkSelection();if(n.selection){return this._createSelect({valueHelp:Q.getValueHelpDropdownSettings(n)});}n=this._oSelector.checkComboBox();if(n.combobox){return this._createComboBox({valueHelp:Q.getValueHelpDropdownSettings(n),edit:true});}var W={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var X=this.getEdmProperty();if(this._oHelper.oAnnotation.isMultiLineText(X)){delete W["width"];return this._createMultiLineText({attributesNamesMap:W});}var Y=this._oParent.isTextInEditModeSourceNotNone(),Z=/Edm.String|Edm.Guid/.test(X.type);if(Y){w(Z,"The ValueList and NavigationProperty"+"members of the sap.ui.comp.smartfield.TextInEditModeSource enumeration are only supported for OData "+"EDM Properties typed as Edm.String or Edm.Guid. - "+this.getMetadata().getName());}var $=Q.getBoundPropertiesMapInfoForInnerControl(I.getMetadata().getName(),{propertyName:"value"})[0];var _=this._oParent.getTextInEditModeSource(),a1;this.bTextInEditModeSourceValidMetadata=Z&&this._checkTextInEditModeSourceRequiredMetadata(_);if(this.bTextInEditModeSourceValidMetadata){a1=this.createAttributes("",this._oMetaData.property,W);a1[$]=this.getTextArrangementBindingInfo();}else{a1=this.createAttributes($,this._oMetaData.property,W);}var b1=new I(this._oParent.getId()+"-input",a1);if(this.bTextInEditModeSourceValidMetadata&&(_===B.ValueList)){var c1="__sap.ui.comp.smartfield.type.TextArrangementModel",d1=a1.value.parts[1].path;if(d1!==""){var e1=d1.split("/")[1];b1.setModel(this._oModel,c1);b1.bindElement(c1+">/"+e1);}}if(this._oHelper.oAnnotation.isMasked(X)){b1.setType(z.Password);}this._handleEventingForEdmString(b1,this._oMetaData.property);var f1=this.getCustomDataConfiguration();if(f1&&(typeof f1.onInput==="function")){f1.onInput(b1);}return{control:b1,onCreate:"_onCreate",params:{valuehelp:{annotation:n.annotation,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"},getValue:"getValue",type:{type:a1.value.type,property:this._oMetaData.property}}};};Q.getValueHelpDropdownSettings=function(n){return{annotation:n.annotation,noDialog:true,noTypeAhead:true};};Q.prototype.getCustomDataConfiguration=function(){var n=this._oParent.data("configdata");return n&&n.configdata?n.configdata:null;};Q.prototype._checkTextInEditModeSourceRequiredMetadata=function(n){switch(n){case B.None:return false;case B.NavigationProperty:var W=this._oMetaData.annotations.text,X;if(W){X=W.entityType;}return this._oHelper.checkNavigationPropertyRequiredMetadata({propertyName:this._oMetaData.property.property.name,entityType:this._oMetaData.entityType,entityTypeOfNavigationProperty:X,textAnnotation:this._oMetaData.property.property["com.sap.vocabularies.Common.v1.Text"]});case B.ValueList:return this._oHelper.checkValueListRequiredMetadataForTextArrangment({propertyName:this._oMetaData.property.property.name,entityType:this._oMetaData.entityType,valueListAnnotation:this._oMetaData.property.valueListAnnotation});default:return false;}};Q.getTextArrangementPaths=function(n,W){switch(n){case B.NavigationProperty:var X=W.annotations.text;return{keyField:X.entityType.key.propertyRef[0].name,descriptionField:X.property.typePath,entitySetName:X.entitySet.name};case B.ValueList:var Y=W.property.valueListAnnotation;return{keyField:Y.keyField,descriptionField:Y.descriptionField,entitySetName:W.property.valueListEntitySet.name};}};Q.prototype.getTextArrangementBindingInfo=function(n){var W=n&&n.type,X=this._oMetaData;if(!W){var Y=this._oParent.getBindingInfo("value");W=(Y&&Y.type)||{};var Z=Q.getTextArrangementPaths(this._oParent.getTextInEditModeSource(),X);W=this._oTypes.getType(X.property,W.oFormatOptions,W.oConstraints,{composite:true,keyField:Z.keyField,descriptionField:Z.descriptionField});}return{model:X.model,type:W,parts:[{path:X.path},{path:this._getTextAnnotationPropertyPath(this._oParent.getTextInEditModeSource())}]};};Q.prototype._getTextAnnotationPropertyPath=function(n){switch(n){case B.NavigationProperty:return this._oHelper.getTextAnnotationPropertyPath(this._oMetaData);case B.ValueList:var W=this._oParent.getBinding("value"),X=this._oMetaData.property;return this._oHelper.getAbsolutePropertyPathToValueListEntity({entitySet:X.valueListEntitySet,entityID:W&&W.getValue(),property:X.valueListKeyProperty});case B.None:return"";default:return"";}};Q.prototype._getMaxLength=function(){return this._oTypes.getMaxLength(this._oMetaData.property,this._oParent.getBindingInfo("value"));};Q.prototype._addAriaLabelledBy=function(n){var W,X,Y;if((this._oParent.getControlContext()===G.None)||(this._oParent.getControlContext()===G.Form)||(this._oParent.getControlContext()===G.SmartFormGrid)){f.prototype._addAriaLabelledBy.apply(this,arguments);Y=this._oParent.data("configdata");if(Y&&Y.configdata.isInnerControl&&Y.configdata.isUOM){if(n){X=n.control;if(X instanceof H){if(X.getItems().length>0){X=X.getItems()[0];}}}if(X&&X.getAriaLabelledBy&&X.getAriaLabelledBy().length===0){var Z=this.getEdmProperty();if(this._oHelper.oAnnotation.getLabel(Z)){W=new u({text:this._oHelper.oAnnotation.getLabel(Z)});X.addAriaLabelledBy(W);this._oParent.addAggregation("_ariaLabelInvisibleText",W);}}}}};Q.prototype._handleEventingForEdmString=function(n,W){if(!n){return;}var X=this._oHelper.oAnnotation.isUpperCase(W.property),Y=this;n.attachChange(function onTextInputFieldChange(Z){var $={},_=Z&&Z.getParameters();if(_){var a1=_.value;if(X&&a1){a1=a1.toUpperCase();n.setValue(a1);}$.value=a1;$.newValue=a1;if(_.validated){$.validated=_.validated;}if(n._oSuggestionPopup&&n._oSuggestionPopup.isOpen()){if(!_.validated){if(n._iPopupListSelectedIndex>=0){return;}}}try{Y._oParent.fireChange($);}catch(b1){v.error(b1);}}});};Q.prototype._createComboBox=function(n){var W=null,X=this._oParent.data("configdata"),Y={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true};var Z=Q.getBoundPropertiesMapInfoForInnerControl(a.getMetadata().getName(),{propertyName:"value"})[0];var $={change:function(_){if(_.getParameter("itemPressed")){return;}var a1=_.getSource().getSelectedKey();this._oParent.fireChange({value:a1,newValue:a1});}.bind(this),selectionChange:this._oHelper.getSelectionChangeHandler(this._oParent)};$=Object.assign($,this.createAttributes(Z,this._oMetaData.property,Y));if($.width===""){$.width="100%";}if(n.edit){W=new a(this._oParent.getId()+"-comboBoxEdit",$);}else{W=this._createDisplayedComboBox($);}if(X&&X.configdata&&X.configdata.onText){X.configdata.onText(W);}return{control:W,onCreate:"_onCreate",params:{valuehelp:{annotation:n.valueHelp.annotation,aggregation:"items",noDialog:n.valueHelp.noDialog,noTypeAhead:n.valueHelp.noTypeAhead},getValue:"getSelectedKey",type:{type:$.selectedKey.type,property:this._oMetaData.property}}};};Q.prototype._createDisplayedComboBox=function(n){var W=a.extend("sap.ui.comp.smartfield.DisplayComboBox",{metadata:{library:"sap.ui.comp",properties:{wrapping:{type:"boolean",group:"Appearance",defaultValue:true}}},renderer:function(X,Y){var Z=Y.getWidth(),$=Y.getValue(),_=Y.getTextDirection(),a1=Y.getTextAlign(),b1=Y.getTooltip_AsString(),c1=Y.getWrapping();X.write("<span");X.writeControlData(Y);X.addClass("sapMText");X.addClass("sapUiSelectable");if(c1){if($&&($.length>0)&&!/\s/.test($)){X.addClass("sapMTextBreakWord");}}else{X.addClass("sapMTextNoWrap");}if(Z){X.addStyle("width",Z);}else{X.addClass("sapMTextMaxWidth");}if(_!==J.Inherit){X.writeAttribute("dir",_.toLowerCase());}if(b1){X.writeAttributeEscaped("title",b1);}if(a1){a1=R.getTextAlign(a1,_);if(a1){X.addStyle("text-align",a1);}}var d1=c1?"sapMTextRenderWhitespaceWrap":"sapMTextRenderWhitespace";X.addClass(d1);X.writeClasses();X.writeStyles();X.write(">");$.replace(/\r\n|\n\r|\r/g,"\n");X.writeEscaped($);X.write("</span>");},updateDomValue:function(X){if(!this.isActive()){return this;}X=this._getInputValue(X);if(this.$().text()!==X){this.$().text(X);this._bCheckDomValue=true;}return this;},getValue:function(){return this.getProperty("value");},getFocusDomRef:function(){return this.getDomRef();},getEditable:function(){return false;}});return new W(this._oParent.getId()+"-comboBoxDisp",n);};Q.prototype._createSelect=function(n){var W={width:true,name:true,valueState:true};var X=Q.getBoundPropertiesMapInfoForInnerControl(S.getMetadata().getName(),{propertyName:"value"})[0];var Y={change:this._oHelper.getSelectionChangeHandler(this._oParent),forceSelection:false};Y=Object.assign(Y,this.createAttributes(X,this._oMetaData.property,W));if(Y.width===""){Y.width="100%";}return{control:new S(this._oParent.getId()+"-select",Y),onCreate:"_onCreate",params:{valuehelp:{annotation:n.valueHelp.annotation,aggregation:"items",noDialog:n.valueHelp.noDialog,noTypeAhead:n.valueHelp.noTypeAhead},getValue:"getSelectedKey",type:{type:Y.selectedKey.type,property:this._oMetaData.property}}};};Q.prototype._createCheckBox=function(){var n=Q.getBoundPropertiesMapInfoForInnerControl(C.getMetadata().getName(),{propertyName:"value"})[0];var W=this.createAttributes(n,null,{},{event:"select",parameter:"selected"});W.editable=(this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable());W.selected.type=this._oTypes.getAbapBoolean();return{control:new C(this._oParent.getId()+"-cBox",W),onCreate:"_onCreate",params:{getValue:"getSelected"}};};Q.prototype._createEdmDateTime=function(){var n=this.getFormatSettings("dateFormatSettings"),W;var X={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var Y=this.createAttributes(null,this._oMetaData.property,X,{event:"change",parameter:"value"});if(this._oSelector.checkDatePicker()){W=Q.getBoundPropertiesMapInfoForInnerControl(D.getMetadata().getName(),{propertyName:"value"})[0];Y[W]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,n,{displayFormat:"Date"}),model:this._oMetaData.model};if(n&&n.style){Y.displayFormat=n.style;}return{control:new D(this._oParent.getId()+"-datePicker",Y),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:Y.value.type,property:this._oMetaData.property}}};}W=Q.getBoundPropertiesMapInfoForInnerControl(b.getMetadata().getName(),{propertyName:"value"})[0];Y[W]={path:this._oMetaData.path,model:this._oMetaData.model,type:this._oTypes.getType(this._oMetaData.property,n)};return{control:new b(this._oParent.getId()+"-input",Y),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:Y.value.type,property:this._oMetaData.property}}};};Q.prototype._createEdmDateTimeOffset=function(){var n=this.getFormatSettings("dateFormatSettings");if(n){n.UTC=false;}var W=Q.getBoundPropertiesMapInfoForInnerControl(b.getMetadata().getName(),{propertyName:"value"})[0];var X={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var Y=this.createAttributes(null,this._oMetaData.property,X,{event:"change",parameter:"value"});Y[W]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,n)};return{control:new b(this._oParent.getId()+"-input",Y),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:Y.value.type,property:this._oMetaData.property}}};};Q.prototype._createEdmNumeric=function(){var n=this._oSelector.checkComboBox();if(n.combobox){return this._createComboBox({valueHelp:{annotation:n.annotation,noDialog:true,noTypeAhead:true},edit:true});}var W={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var X=Q.getBoundPropertiesMapInfoForInnerControl(I.getMetadata().getName(),{propertyName:"value"})[0];var Y=this.createAttributes(X,this._oMetaData.property,W,{event:"change",parameter:"value"});if(this._oParent.isContextTable()&&sap.ui.getCore().getConfiguration().getRTL()){Y.textDirection="LTR";}return{control:new I(this._oParent.getId()+"-input",Y),onCreate:"_onCreate",params:{getValue:"getValue",type:{type:Y.value.type,property:this._oMetaData.property}}};};Q.prototype._createEdmUOM=function(){var n=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this._oMetaData.annotations.uom.property.property),W=this._createEdmUOMAttributes({currency:n}),X=this._oParent.getObjectBinding(this._oMetaData.model),Y=sap.ui.getCore().getConfiguration().getRTL(),Z=Y&&this._oParent.isContextTable(),$=this._oParent.getId(),_;this.addObjectBinding(W,X);if(Z){W.textDirection="LTR";}var a1=new I($+"-input",W);this.oAmountField=a1;if(this._oParent.data("suppressUnit")==="true"){var b1={getValue:"getValue"};if(!n){b1.type={type:W.value.type,property:this._oMetaData.property};}return{control:a1,onCreate:"_onCreate",params:b1};}if(!n){_={type:W.value.type,property:this._oMetaData.property};}var c1={change:this._oHelper.getUOMChangeHandler(this._oParent,true),textAlign:this._getEdmUOMTextAlignment()};var d1=Q.getBoundPropertiesMapInfoForInnerControl(P.getMetadata().getName(),{propertyName:"value"})[0];var e1=this._oHelper.getUOMPath(this._oMetaData);c1[d1]={model:this._oMetaData.model,path:e1};this.addObjectBinding(c1,X);this.mapBindings(c1,Q._getEmbeddedSmartFieldMapSettings());if(this._oParent.getConfiguration()){c1.configuration=new t({preventInitialDataFetchInValueHelpDialog:this._getPreventInitialDataFetchInVHDialog()});}var f1=new P($+"-sfEdit",c1),g1=this;f1.data("configdata",{"configdata":{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:e1,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,valuelistType:this._oMetaData.annotations.uom.annotations.valuelistType,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(i1){a1.setLayoutData(new F({growFactor:1}));f1.setLayoutData(g1._getStaticUOMTextFlexItemData({shrinkFactor:0,styleClass:"sapUiCompSmartFieldFlexItemUnitDisplay"}));f1.addStyleClass("sapUiCompSmartFieldUOMDisplayText");if(i1){if(Z&&(typeof i1.setTextDirection==="function")){i1.setTextDirection("LTR");}i1.addStyleClass("sapUiCompSmartFieldUnit");}},onInput:function(i1){a1.setLayoutData(g1._getDynamicAmountInputFlexItemData({control:f1}));f1.setLayoutData(g1._getStaticUOMInputFlexItemData({growFactor:0,styleClass:"sapUiCompSmartFieldFlexItemUnitEdit",minWidth:""}));if(i1){if(Z&&(typeof i1.setTextDirection==="function")){i1.setTextDirection("LTR");}i1.addStyleClass("sapUiCompSmartFieldUnit");}}}});f1.data("errorCheck","setComplexClientErrorSecondOperandNested");a1.addAriaLabelledBy(f1);if(f1.getVisible()){a1.addStyleClass("smartFieldPaddingRight");}a1.addStyleClass("sapUiCompSmartFieldValue");var h1=new H({justifyContent:A.End,items:[a1,f1],fitContainer:true,width:this._oParent.getWidth()});h1.addStyleClass("sapUiCompUOM");h1.enhanceAccessibilityState=function(i1,j1){this._oParent.enhanceAccessibilityState(i1,j1);}.bind(this);if(this._oParent.isContextTable()){if(Z){h1.addStyleClass("sapUiCompDirectionLTR");}h1.addStyleClass("sapUiCompUOMInTable");if(this._oParent.getMode()!=="edit"){h1.addStyleClass("sapUiCompUOMInTableDisplay");}}return{control:h1,onCreate:"_onCreateUOM",params:{getValue:true,valuehelp:true,type:_}};};Q.prototype._createEdmUOMAttributes=function(n){n=n||{};var W=this.createUOMDefaultAttributes();var X=Q.getBoundPropertiesMapInfoForInnerControl(I.getMetadata().getName(),{propertyName:"value"})[0];var Y=n.currency||(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this._oMetaData.annotations.uom.property.property));if(Y){W[X]={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)}],model:this._oMetaData.model,type:this._oTypes.getCurrencyType(this._oMetaData.property)};}else{W[X]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};}return W;};Q.prototype.createUOMDefaultAttributes=function(){return{textAlign:this._getEdmUOMTextAlignment(),placeholder:this.getAttribute("placeholder"),name:this.getAttribute("name"),change:this._oHelper.getUOMChangeHandler(this._oParent),valueState:this.getValueStateBindingInfoForRecommendationStateAnnotation()};};Q.prototype._getEdmUOMTextAlignment=function(){var n=this.getAttribute("textAlign");if(!n){n=y.Initial;}if(n===y.Initial){if(this._oParent.isContextTable()){return y.End;}return y.Begin;}return n;};Q.prototype._createEdmUOMDisplay=function(){var n=this,W=this._oHelper.getUOMPath(this._oMetaData),X=this._getEdmUOMTextAlignment(),Y=null,Z=this.getEdmProperty(),$=sap.ui.getCore().getConfiguration().getRTL(),_=$&&this._oParent.isContextTable();var a1=Q.getBoundPropertiesMapInfoForInnerControl(d.getMetadata().getName(),{propertyName:"value"})[0];var b1={textAlign:X};b1[a1]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:W}],model:this._oMetaData.model,formatter:this._oTypes.getDisplayFormatter(Z,{currency:this._oHelper.oAnnotation.isCurrency(Z),mask:this._oHelper.oAnnotation.isMasked(Z)}),useRawValues:true};if(_){b1.textDirection="LTR";}var c1=this._oParent.getObjectBinding(this._oMetaData.model);this.addObjectBinding(b1,c1);var d1=new d(this._oParent.getId()+"-text",b1);W=this._oHelper.getUOMPath(this._oMetaData);b1={change:this._oHelper.getUOMChangeHandler(this._oParent,true),textAlign:this._getEdmUOMTextAlignment()};a1=Q.getBoundPropertiesMapInfoForInnerControl(P.getMetadata().getName(),{propertyName:"value"})[0];b1[a1]={model:this._oMetaData.model,path:W};this.addObjectBinding(b1,c1);this.mapBindings(b1,Q._getEmbeddedSmartFieldMapSettings());d1.addStyleClass("smartFieldPaddingRight");d1.addStyleClass("sapUiCompSmartFieldValue");if(this._checkSuppressUnit()){return{control:d1};}Y=new P(this._oParent.getId()+"-sfDisp",b1);Y.data("configdata",{"configdata":{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:W,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(f1){if(f1){if(f1.setWrapping){f1.setWrapping(false);}if(_&&(typeof f1.setTextDirection==="function")){f1.setTextDirection("LTR");}f1.addStyleClass("sapUiCompSmartFieldUnit");}},onInput:function(f1){d1.setLayoutData(new F({growFactor:0}));Y.setLayoutData(new F({growFactor:0}));if(f1){if(_&&(typeof f1.setTextDirection==="function")){f1.setTextDirection("LTR");}f1.addStyleClass("sapUiCompSmartFieldUnit");}},getContextEditable:function(){return n._oParent.getContextEditable();}}});Y.data("errorCheck","setComplexClientErrorSecondOperandNested");var e1=new H({alignItems:K.Center,items:[d1,Y],fitContainer:true,width:this._oParent.getWidth()});e1.enhanceAccessibilityState=function(f1,g1){this._oParent.enhanceAccessibilityState(f1,g1);}.bind(this);if(this._oParent.isContextTable()){e1.setJustifyContent("End");this._oParent.addStyleClass("sapUiCompUOMInTable");if(_){e1.addStyleClass("sapUiCompDirectionLTR");}e1.addStyleClass("sapUiCompUOMInTable");}return{control:e1};};Q.prototype._createEdmUOMObjectStatus=function(){var n,W,X=this.getEdmProperty(),Y=this._oTypes.getDisplayFormatter(X,{currency:this._oHelper.oAnnotation.isCurrency(X)}),Z=this._oHelper.getUOMPath(this._oMetaData),$={};var _=Q.getBoundPropertiesMapInfoForInnerControl(o.getMetadata().getName(),{propertyName:"value"})[0];$[_]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:Z}],formatter:function(){var a1=Y.apply(this,arguments);return a1+arguments[1];},useRawValues:true};this._addObjectStatusAttributes($);n=this._oParent.getObjectBinding(this._oMetaData.model);this.addObjectBinding($,n);W=new o(this._oParent.getId()+"-objStatus",$);W.addStyleClass("sapUiCompUOM");return{control:W};};Q.prototype._createEdmUOMObjectNumber=function(){var n,W,X,Y=this._getEdmUOMTextAlignment();var Z=Q.getBoundPropertiesMapInfoForInnerControl(j.getMetadata().getName(),{propertyName:"value"});if(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this._oMetaData.annotations.uom.property.property)){n={model:this._oMetaData.model,textAlign:Y};n[Z[0]]={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)}],type:this._oTypes.getCurrencyType(this._oMetaData.property)};n[Z[1]]={path:this._oHelper.getUOMPath(this._oMetaData)};}else{n={model:this._oMetaData.model,textAlign:Y};n[Z[0]]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};n[Z[1]]={path:this._oHelper.getUOMPath(this._oMetaData)};}W=this._oParent.getObjectBinding(this._oMetaData.model);this.addObjectBinding(n,W);X=new j(this._oParent.getId()+"-objNumber",n);X.addStyleClass("sapUiCompUOM");return{control:X};};Q.prototype._createEdmSemantic=function(){var n,W=this,X=this._oParent.getBindingInfo("value"),Y=X.parts[0].path,Z=this.getEdmProperty(),$=this._oHelper.oAnnotation.getLabel(Z);if(this._oMetaData.annotations.lineitem&&this._oMetaData.annotations.lineitem.labels&&this._oMetaData.annotations.lineitem.labels[Y]){$=this._oMetaData.annotations.lineitem.labels[Y];}var _={semanticObject:this._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:this._oMetaData.annotations.semantic.additionalSemanticObjects,semanticObjectLabel:$,fieldName:Y,width:this.getAttribute("width"),createControlCallback:function(){var b1=this.createControl(true);if(b1){return b1.control;}return null;}.bind(this)};var a1=this._oHelper.oAnnotation.getText(Z);if(a1){_.text={parts:[this._oMetaData.path,this._oHelper.getEdmDisplayPath(this._oMetaData)],model:this._oMetaData.model,formatter:function(b1,c1){if(b1&&c1){return W._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",b1,c1);}return b1?b1:"";}};_.navigationTargetsObtained=function(b1){var c1=this.getBinding("text");if(!Array.isArray(c1.getValue())){b1.getParameters().show();return;}var d1=c1.getValue();var e1=W._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour")||"idOnly";var f1=r.getTextsFromDisplayBehaviour(e1,d1[0],d1[1]);var g1=b1.getParameters().mainNavigation;if(g1){g1.setDescription(f1.secondText);}b1.getParameters().show(f1.firstText,g1,undefined,undefined);};}else{n=this._oHelper.getUOMPath(this._oMetaData);if(n){_.text={parts:[{path:Y},{path:n}],model:this._oMetaData.model,formatter:this._oHelper.oAnnotation.isCurrency(this._oMetaData.annotations.uom.property.property)?r.getAmountCurrencyFormatter():r.getMeasureUnitFormatter(),useRawValues:true};_.uom={path:n};}else{_.text={path:Y,model:this._oMetaData.model};}}return{control:new e(this._oParent.getId()+"-sl",_),onCreate:"_onCreate",params:{getValue:"getInnerControlValue"}};};Q.prototype._createMultiLineText=function(n){var W=Q.getBoundPropertiesMapInfoForInnerControl(T.getMetadata().getName(),{propertyName:"value"})[0];var X=this.createAttributes(W,this._oMetaData.property,n.attributesNamesMap);var Y=this.getFormatSettings("multiLineSettings");X=x(X,Y);if(this._oParent.isContextTable()){X.width="100%";}var Z=new T(this._oParent.getId()+"-textArea",X);this._handleEventingForEdmString(Z,this._oMetaData.property);return{control:Z,onCreate:"_onCreate",params:{type:{type:X.value.type,property:this._oMetaData.property},getValue:"getValue"}};};Q.prototype._createLink=function(){var n=this,W=this._oParent,X=W.getBindingInfo("url");var Y={text:"",href:""};var Z=Q.getBoundPropertiesMapInfoForInnerControl(L.getMetadata().getName(),{propertyName:"url"})[0];if(X){Y[Z]=this._oBinding.toBinding(X);}else{Y[Z]=W.getUrl();}if(W.hasListeners("press")){Y.press=function(e1){e1.preventDefault();W.firePress(e1);};}var $=W.getBindingInfo("value");var _=Q.getBoundPropertiesMapInfoForInnerControl(L.getMetadata().getName(),{propertyName:"value"});if($){var a1=this._oMetaData,b1=a1.path,c1=a1.property.property;if(a1.annotations.text&&(c1.type==="Edm.String")){Y[_[0]]={parts:[a1.path,this._oHelper.getEdmDisplayPath(a1)],formatter:this._formatText.bind(n)};}else if(Q.isSpecialLink(c1)){var d1=Q[Q._getLinkFormatterFunctionName(c1)];Y[_[0]]={path:b1};Y[_[1]]={path:b1,formatter:null};if(typeof d1==="function"){Y[_[1]].formatter=d1;}}else{Y[_[0]]=this._oBinding.toBinding($);}}else{Y[_[0]]=W.getValue();}return{control:new L(W.getId()+"-link",Y),onCreate:"_onCreate",params:{noValidation:true}};};Q.prototype._createEdmBoolean=function(){var n=this._oSelector.checkComboBox(),W=this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable(),X=this,Y=null,Z;if(n.combobox){if(W||this._oParent.getFetchValueListReadOnly()){return this._createComboBox({valueHelp:{annotation:n.annotation,noDialog:true,noTypeAhead:true},edit:W});}}var $,_;if(W){_=Q.getBoundPropertiesMapInfoForInnerControl(C.getMetadata().getName(),{propertyName:"value"})[0];$=this.createAttributes(_,this._oMetaData.property,{},{event:"select",parameter:"selected"});Z=new C(this._oParent.getId()+"-cBoxBool",$);Y={getValue:"getSelected"};}else{_=Q.getBoundPropertiesMapInfoForInnerControl(d.getMetadata().getName(),{propertyName:"value"})[0];$=this.createAttributes(_,this._oMetaData.property,{width:true,textAlign:true});$[_]={model:this._oMetaData.model,path:this._oMetaData.path,formatter:function(a1){return X._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",a1);}};Z=new d(this._oParent.getId()+"-text",$);}return{control:Z,onCreate:"_onCreate",params:Y};};Q.prototype._createValueHelp=function(){var n=this._oParent.getContent();if(!n){return;}var W={annotation:this._oMetaData.annotations.valuelist,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"};this._getValueHelpDialogTitle(W);W.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:n,edmProperty:this.getEdmProperty(),valueHelp:W,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(X){this._oParent.fireValueListChanged({changes:X.mParameters.changes});}.bind(this)});};Q.prototype._checkSuppressUnit=function(){if(this._oParent.data("suppressUnit")==="true"){return true;}var n=this._oParent.getBindingInfo("uomVisible");return(!n&&!this._oParent.getUomVisible());};Q.prototype.getEdmProperty=function(){var n=this._oHelper;if(n){return n.getEdmProperty(this._oMetaData);}return null;};Q.prototype.getEntityType=function(){if(this._oMetaData){return this._oMetaData.entityType;}return null;};Q.prototype._checkLink=function(){var n=this._oParent.getBindingInfo("url"),W=this.getEdmProperty();if(n||this._oParent.getUrl()||Q.isSpecialLink(W)){return true;}return this._oParent.hasListeners("press");};Q._getEmbeddedSmartFieldMapSettings=function(){return{"uomEditable":"editable","uomEnabled":"enabled","uomVisible":"visible","mandatory":"mandatory"};};Q.getBoundPropertiesMapInfoForInnerControl=function(n,W){W=W||{};var X=null;switch(n){case"sap.m.Input":case"sap.m.TimePicker":case"sap.m.DatePicker":case"sap.m.DateTimePicker":case"sap.m.TextArea":X={value:["value"]};break;case"sap.m.Text":case"sap.m.ObjectIdentifier":case"sap.ui.comp.navpopover.SmartLink":X={value:["text"]};break;case"sap.m.Link":X={url:["href"],value:["text","href"]};break;case"sap.m.ObjectStatus":X={value:["text","state","icon"]};break;case"sap.m.ObjectNumber":X={value:["number","unit"]};break;case"sap.m.Select":case"sap.m.ComboBox":case"sap.ui.comp.smartfield.DisplayComboBox":X={value:["selectedKey"]};break;case"sap.m.CheckBox":X={value:["selected"]};break;case"sap.ui.comp.smartfield.SmartField":var Y=Object.keys(P.getMetadata().getProperties());X={};Y.forEach(function(Z,$,_){X[Z]=[_[$]];});break;}if(X&&W.propertyName){return X[W.propertyName]||null;}return X;};Q.isSpecialLink=function(n){return M.isEmailAddress(n)||M.isPhoneNumber(n)||M.isURL(n);};Q._getLinkFormatterFunctionName=function(n){return"_format"+M.getLinkDisplayFormat(n);};Q._formatEmailAddress=function(n){return"mailto:"+n;};Q._formatPhoneNumber=function(n){return"tel:"+n;};Q._formatURL=function(n){return U.validate(n)?n:"";};Q.prototype._formatText=function(n,W){if(n&&W){return this._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",n,W);}return n||"";};Q.prototype._getCreator=function(n){return this._oSelector.getCreator(n);};Q.prototype._onCreate=function(n,W){var X,Y,Z=true,$=this;if(W){if(W.noValidation){Z=false;}if(W.valuehelp&&this.shouldCreateValueHelpForControl(n)){this._getValueHelpDialogTitle(W.valuehelp);W.valuehelp.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:n,edmProperty:this.getEdmProperty(),valueHelp:W.valuehelp,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(_){$._oParent.fireValueListChanged({changes:_.mParameters.changes});}});}if(W.getValue){X=W.getValue;W.getValue=function(){return n[X]();};}if(W.type){Y=this._oFieldControl.getMandatoryCheck(W.type.property);if(Y){W.type.type.oFieldControl=Y;}}}if(Z){this.addValidations(n,this._oParent.data("errorCheck")||"setSimpleClientError");}if(!this._checkUOM()){n.addStyleClass("sapUiCompSmartFieldValue");}};Q.prototype._checkUOM=function(){var n=this._oParent.data("configdata");if(n&&n.configdata){if(n.configdata.onInput||n.configdata.onText){return true;}}return false;};Q.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(n,W,X){n=n||this.getEdmProperty();var Y=n&&n["com.sap.vocabularies.UI.v1.RecommendationState"];if(!Y){return null;}w(!(Y.Path===undefined),'Missing "Path" attribute of the "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+n.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());w(!(Y.Path===""),'Missing path name of "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+n.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());W=W||this._oHelper.findProperty(this._oMetaData.entityType.property,Y.Path);w(!!W,'The EDM property was not found in the "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(W&&(W.type==="Edm.Byte")){return{model:X||this._oMetaData.model,path:Y.Path,formatter:Q.formatRecommendationState};}w(W&&(W.type==="Edm.Byte"),'The EDM property "'+W.name+'" of "'+this._oMetaData.entityType.name+'" entity type must be typed as Edm.Byte. - '+this.getMetadata().getName());return null;};Q.formatRecommendationState=function(n){switch(n){case 0:return V.None;case 1:return V.Information;case 2:return V.Warning;default:return V.None;}};Q.prototype._getDynamicAmountInputFlexItemData=function(n){var W="sapUiCompSmartFieldFlexItemAmountEdit",X="",Y=n.control;if(Y&&!Y.getVisible()){W="sapUiCompSmartFieldFlexItemAmountNoUnitEdit";X="100%";}var Z=this._oAmountInputFlexItemData;if(Z&&!Z.bIsDestroyed){Z.setMaxWidth(X);Z.setStyleClass(W);return Z;}this._oAmountInputFlexItemData=new F({growFactor:1,maxWidth:X,styleClass:W});return this._oAmountInputFlexItemData;};Q.prototype._getStaticUOMInputFlexItemData=function(n){var W=this._oUOMInputFlexItemData;if(W&&!W.bIsDestroyed){return W;}this._oUOMInputFlexItemData=new F(n);return this._oUOMInputFlexItemData;};Q.prototype._getStaticUOMTextFlexItemData=function(n){var W=this._oUOMTextFlexItemData;if(W&&!W.bIsDestroyed){return W;}this._oUOMTextFlexItemData=new F(n);return this._oUOMTextFlexItemData;};Q.prototype._getValueHelpDialogTitle=function(n){n.dialogtitle=this._oParent.getTextLabel();if(!n.dialogtitle){var W=this.getEdmProperty();n.dialogtitle=this._oHelper.oAnnotation.getLabel(W)||W.name;}};Q.prototype._onCreateUOM=function(n,W){var X=n.getItems(),Y;this.addValidations(X[0],"setComplexClientErrorFirstOperand");if(W&&W.getValue){W.getValue=function(){return X[0].getValue();};}W.uom=function(){return X[1].getValue();};W.uomset=function(Z){X[1].setValue(Z);};if(W.type){Y=this._oFieldControl.getMandatoryCheck(W.type.property);if(Y){W.type.type.oFieldControl=Y;}}};Q.prototype.triggerCreationOfInnerControls=function(n,W){try{this._init(n);this._setUOMEditState();this._bind(W);}catch(X){v.error(X,null,this.getMetadata().getName());}};Q.prototype.bind=function(){if(!(!this._bInitialized&&!this.bPending)){return Promise.resolve();}this._bInitialized=true;var n=this._oFieldControl.getBindablePropertiesNames(),W=this._oParent.data("configdata");if(W&&W.configdata){this.triggerCreationOfInnerControls(this._oMeta,n);return Promise.resolve();}if(!this._oModel){return Promise.resolve();}var X=this._oParent&&this._oParent.isTextInEditModeSourceNotNone();if(!X&&this._oModel.bMetaModelLoaded){this.triggerCreationOfInnerControls(this._oMeta,n);return Promise.resolve();}this.bPending=true;var Y=this._oModel.getMetaModel().loaded();var Z=Y.then(function onMetaModelLoaded(){if(!this._oParent){this.bPending=false;return Promise.reject();}if(X){this._init(this._oMeta);var $=this._oMetaData.annotations.valuelist;if(typeof $==="string"){return this._oHelper.loadValueListAnnotation($);}else{this.bPending=false;this._setUOMEditState();this._bind(n);return Promise.reject();}}this.bPending=false;this.triggerCreationOfInnerControls(this._oMeta,n);}.bind(this));Y.catch(function($){v.error("The meta model could not be loaded.",$,this.getMetadata().getName());}.bind(this));if(X){Z.then(function($){if(!this._oParent){return;}this.bPending=false;if($){this._initValueList($);}this._setUOMEditState();this._bind(n);}.bind(this));}Z.catch(function($){if($){v.error($,null,this.getMetadata().getName()+".onMetaModelLoaded");}}.bind(this));return Z;};Q.prototype._bind=function(n){var W,X=this._oFieldControl.getControlProperties(this._oMetaData,n);for(var Y in X){W=this._oBinding.fromFormatter(this._oMetaData.model,X[Y]);this._oParent.bindProperty(Y,W);}this._addLabelAndQuickInfo();this._oParent.fireInitialise();};Q.prototype._addLabelAndQuickInfo=function(){var n=this.getDataProperty();n=n.property;var W=this._oHelper.oAnnotation.getLabel(n);var X=this._oHelper.oAnnotation.getQuickInfo(n);if(W&&this._oParent.isPropertyInitial("textLabel")){this._oParent.setTextLabel(W);}if(X&&this._oParent.isPropertyInitial("tooltipLabel")){this._oParent.setTooltipLabel(X);}};Q.prototype.rebindOnCreated=function(){var W,X=this._oFieldControl.getControlProperties(this._oMetaData,["editable"]);for(var n in X){W=this._oBinding.fromFormatter(this._oMetaData.model,X[n]);this._oParent.bindProperty(n,W);}};Q.prototype._setUOMEditState=function(){if(this._oFieldControl.hasUomEditState(this._oMetaData)){var n=this._oFieldControl.getUOMEditState(this._oMetaData);if(n){var W=this._oBinding.fromFormatter(this._oMetaData.model,n);this._oParent.bindProperty("uomEditState",W);}}};Q.prototype.getDataProperty=function(){return this._oMetaData.property;};Q.prototype.getDropdownItemKeyType=function(n){var W=n.getMetadata().getName();if((W==="sap.ui.comp.smartfield.DisplayComboBox")||(W==="sap.m.ComboBox")||(W==="sap.m.Select")){var X=Q.getBoundPropertiesMapInfoForInnerControl(W,{propertyName:"value"})[0];var Y=n.getBindingInfo(X);return(Y&&Y.type)||null;}return null;};Q.prototype.getMetaData=function(){return this._oMetaData;};Q.prototype.getODataHelper=function(){return this._oHelper;};Q.prototype.destroy=function(){if(this._oFieldControl){this._oFieldControl.destroy();}if(this._oSelector){this._oSelector.destroy();}if(this._oTypes){this._oTypes.destroy();}if(this._oHelper){this._oHelper.destroy();}this._oHelper=null;this._oFieldControl=null;this._oTypes=null;this._oSelector=null;this._oMetaData=null;this._oAmountInputFlexItemData=null;this._oUOMInputFlexItemData=null;this._oUOMTextFlexItemData=null;this.oAmountField=null;this.bTextInEditModeSourceValidMetadata=false;f.prototype.destroy.apply(this,arguments);};return Q;},true);
