sap.ui.define(["jquery.sap.global","sap/suite/ui/generic/template/changeHandler/util/ChangeHandlerUtils","sap/suite/ui/generic/template/changeHandler/util/AnnotationChangeUtilsV2"],function(q,U,A){"use strict";var D="com.sap.vocabularies.UI.v1.DataField";var I="com.sap.vocabularies.UI.v1.Importance";var a="com.sap.vocabularies.UI.v1.ImportanceType/High";var F="com.sap.vocabularies.UI.v1.FieldGroup";var b={};var h=function(c,s,p){var e={};var o={};var d={};var f="";var g=[];var C={};var m={};var G=p.modifier.bySelector(s.parentId,p.appComponent);var P=p.modifier.getSelector(s.parentId,p.appComponent);var M=U.getMetaModel(s,p);var t=U.getTemplatingInfo(G);e=M.getODataEntityType(t.target);f=(t.value.indexOf("/")>0)?t.value.split("/")[1].substr(1):t.value.substr(1);o=e[f];d=JSON.parse(JSON.stringify(o));g=(f.indexOf(F)>=0)?o.Data:o;var n=e.property.find(function(i){return i.name===s.bindingPath;});var N={Value:{Path:s.bindingPath},RecordType:D,EdmType:n&&n.type};N[I]={EnumMember:a};g.splice(s.index,0,N);C=A.createCustomAnnotationTermChange(t.target,o,d,f);C.targetIndex=s.index;C.parentElementId=G.getId();C.oParentSelector=P;C.bindingPath=s.bindingPath;C.oAnnotation=N;C.oEntityType=e;C.sAnnotation=f;m=A.createCustomChanges(C);m.noRefreshOnChange=true;q.extend(true,c.getContent(),m);};b.applyChange=function(c,C,p){var d=c.getDefinition();if(!d.transferred){var P=c.getContent().customChanges[0].parentElementId;var o=c.getContent().customChanges[0].oParentSelector;var e=p.modifier.bySelector(o);var B=c.getContent().customChanges[0].bindingPath;var t=c.getContent().customChanges[0].targetIndex;var f=c.getContent().customChanges[0].oAnnotation;var s=c.getContent().customChanges[0].sAnnotation;var E=c.getContent().customChanges[0].oEntityType;var T={"sap.ui.dt":{"annotation":{"annotation":s,"annotationContext":f,"path":s+"/Data/"+t,"target":E.namespace+"."+E.name,"value":B}}};var S=P.substring(0,P.lastIndexOf("::"))+"::"+B+"::Field";var g=P.substring(0,P.lastIndexOf("::"))+"::"+B+"::GroupElement";var i=new sap.ui.comp.smartfield.SmartField(S,{value:"{"+B+"}"});var G=new sap.ui.comp.smartform.GroupElement(g);G.insertElement(i);var j=new sap.ui.core.CustomData({"key":"sap-ui-custom-settings","value":T});G.addCustomData(j);e.insertGroupElement(G,t);}};b.revertChange=function(c,C,p){};b.completeChangeContent=function(c,s,p){s.custom={};s.custom.fnGetAnnotationIndex=U.getIndexFromInstanceMetadataPath;h(c,s,p);};return b;},true);
