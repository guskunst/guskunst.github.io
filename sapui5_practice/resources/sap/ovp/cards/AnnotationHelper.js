sap.ui.define(["jquery.sap.global","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ovp/cards/CommonUtils","sap/ui/model/odata/AnnotationHelper","sap/ui/model/FilterOperator","sap/ui/Device","sap/ui/model/analytics/odata4analytics","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ovp/app/resources"],function(q,N,D,C,O,F,a,o,S,b){"use strict";var f={count:0};var c={};var d={};var e={};var g={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};var A={TEXT:"com.sap.vocabularies.Common.v1.Text",TEXT_ARRANGEMENT:"com.sap.vocabularies.UI.v1.TextArrangement"};var T={TEXT_LAST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TEXT_FIRST:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TEXT_ONLY:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly",TEXT_SEPARATE:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"};var I={"List_condensed":{phone:5,tablet:5,desktop:5},"List_extended":{phone:3,tablet:3,desktop:3},"List_condensed_bar":{phone:5,tablet:5,desktop:5},"List_extended_bar":{phone:3,tablet:3,desktop:3},"Table":{phone:5,tablet:5,desktop:5},"Stack_simple":{phone:20,tablet:20,desktop:20},"Stack_complex":{phone:5,tablet:5,desktop:5}};function l(i,j){var k=i.getSetting('ovpCardProperties');var Z2=k.getProperty('/showLabelText');if(Z2==="true"){var $2=j.Address[0];if(typeof $2.country!=="undefined"){return"{path:'"+$2.country.Path+"'}";}else if(typeof $2.locality!=="undefined"){return"{path:'"+$2.locality.Path+"'}";}else if(typeof $2.street!=="undefined"){return"{path:'"+$2.street.Path+"'}";}else if(typeof $2.code!=="undefined"){return"{path:'"+$2.code.Path+"'}";}}else{return null;}}l.requiresIContext=true;function h(i,j){if(!j){return"";}if(j.Label){return j.Label.String;}var k=i.getSetting&&i.getSetting('ovpCardProperties');var Z2=k&&k.getProperty("/metaModel");var $2=k&&k.getProperty("/entityType");if(!Z2||!$2){return"";}var _2;if(j.Value){_2=j.Value.Path;}if(j.Target){var a3=E($2.$path,j);var b3=a3&&Z2.getProperty(a3);_2=b3&&b3.Value.Path;}if(!_2||!_2.length>0||_2===" "){return"";}var c3=Z2.getODataProperty($2,_2);if(!c3){return"";}var d3=c3["sap:label"]||(c3["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return d3;}h.requiresIContext=true;function m(i,k){if(i.getSetting){var j=i.getSetting("_ovpCache");if(j){return j[k];}}return undefined;}function s(i,k,j){if(i.getSetting){var Z2=i.getSetting("_ovpCache");if(Z2){Z2[k]=j;}}}function n(i,j){if(!f[j]){f[j]=0;}f[j]++;var k=j+f[j];f[k]=i;return"sap.ovp.cards.AnnotationHelper.formatFunctions."+k;}function p(i,j){var k;if(j){k=j.None;if(i&&i.EnumMember){var Z2=i.EnumMember;if(t(Z2,'Negative')){k=j.Negative;}else if(t(Z2,'Critical')){k=j.Critical;}else if(t(Z2,'Positive')){k=j.Positive;}}}return k;}function r(i){if(i=="Error"){i=1;}else if(i=="Warning"){i=2;}else if(i=="Success"){i=3;}else{i=0;}return i;}function t(i,j){return i&&i.indexOf(j,i.length-j.length)!==-1;}function u(i,j,k,Z2,$2,_2,a3){var b3={};b3.EnumMember="None";var c3=Number.NEGATIVE_INFINITY;var d3=Number.POSITIVE_INFINITY;if((!$2&&$2!==0)&&(k||k===0)){$2=k;}if((!_2&&_2!==0)&&(Z2||Z2===0)){_2=Z2;}if(!k&&k!==0){k=c3;}if(!Z2&&Z2!==0){Z2=d3;}if(i!==undefined){i=Number(i);if(t(j,"Minimize")||t(j,"Minimizing")){if((_2||_2===0)&&(Z2||Z2===0)){if(i<=parseFloat(_2)){b3.EnumMember="Positive";}else if(i>parseFloat(Z2)){b3.EnumMember="Negative";}else{b3.EnumMember="Critical";}}}else if(t(j,"Maximize")||t(j,"Maximizing")){if(($2||$2===0)&&(k||k===0)){if(i>=parseFloat($2)){b3.EnumMember="Positive";}else if(i<parseFloat(k)){b3.EnumMember="Negative";}else{b3.EnumMember="Critical";}}}else if(t(j,"Target")){if((_2||_2===0)&&(Z2||Z2===0)&&($2||$2===0)&&(k||k===0)){if(i>=parseFloat($2)&&i<=parseFloat(_2)){b3.EnumMember="Positive";}else if(i<parseFloat(k)||i>parseFloat(Z2)){b3.EnumMember="Negative";}else{b3.EnumMember="Critical";}}}}return p(b3,a3);}function v(i,j,k,Z2,$2){if(!i||!j){return;}i=Number(i);if(!Z2&&(i-j>=0)){return($2===false)?"sap-icon://trend-up":"Up";}if(!k&&(i-j<=0)){return($2===false)?"sap-icon://trend-down":"Down";}if(j&&Z2&&(i-j>=Z2)){return($2===false)?"sap-icon://trend-up":"Up";}if(j&&k&&(i-j<=k)){return($2===false)?"sap-icon://trend-down":"Down";}}function w(i,j){var k=i.getPath(0)+"-DataFields-Sorted";var Z2=m(i,k);if(!Z2){var $2=x(i,j);var _2=$2.map(function(a3){return a3.Value.Path;});_2=_2.filter(function(a3){return!!a3;});Z2=j.filter(function(a3){if(a3.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&_2.indexOf(a3.Value.Path)===-1){return true;}return false;});Z2=H(Z2);s(i,k,Z2);}return Z2;}w.requiresIContext=true;function x(j,k,Z2){var $2=j.getPath(0)+"-DataPoints-Sorted";var _2=m(j,$2);if(!_2){if(Z2){_2=k.filter(z);}else{_2=k.filter(y);}_2=H(_2);var a3;for(var i=0;i<_2.length;i++){a3=j.getPath(0).substr(0,j.getPath(0).lastIndexOf("/")+1);_2[i]=j.getModel(0).getProperty(E(a3,_2[i]));a3="";}s(j,$2,_2);}return _2;}x.requiresIContext=true;function y(i){if(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/)){return true;}return false;}function z(i){if((i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.UI.v1.DataPoint.*/))||(i.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&i.Target.AnnotationPath.match(/@com.sap.vocabularies.Communication.v1.Contact.*/))){return true;}return false;}function B(i){if(!i||!i.Criticality||!i.Criticality.Path){return;}return"{path:'"+i.Criticality.Path+"'}";}function E(i,j){if(i&&!t(i,'/')){i+='/';}return i+j.Target.AnnotationPath.slice(1);}function G(i){var j,k;if(i["com.sap.vocabularies.UI.v1.Importance"]){j=i["com.sap.vocabularies.UI.v1.Importance"].EnumMember;switch(j){case"com.sap.vocabularies.UI.v1.ImportanceType/High":k=1;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":k=2;break;case"com.sap.vocabularies.UI.v1.ImportanceType/Low":k=3;break;}}else{k=4;}return k;}function H(i){if(i.length<2){return i;}var j=parseInt(i.length/2,10);var k=i.slice(0,j);var Z2=i.slice(j,i.length);return J(H(k),H(Z2));}function J(i,j){var k=[];while(i.length&&j.length){var Z2=G(i[0]),$2=G(j[0]);if(Z2<=$2){k.push(i.shift());}else{k.push(j.shift());}}while(i.length){k.push(i.shift());}while(j.length){k.push(j.shift());}return k;}function K(i,j,k){var Z2=w(i,j)[k];if(Z2){return V(i,Z2);}return"";}function L(i,j,k){var Z2=w(i,j)[k];return h(i,Z2);}function M(i,j,k){var Z2=x(i,j)[k];if(Z2&&Z2.Title){return Z2.Title.String;}return"";}function P(i,j,k){var Z2=j.filter(y);Z2=H(Z2);if(!Z2||!Z2.length||!Z2.length>0){return"";}return h(i,Z2[0]);}function Q(i,j,k,Z2){var $2=x(i,j)[k];if(!$2){return"";}var _2=i.getSetting('ovpCardProperties');var a3=_2.getProperty("/entityType");var b3=_2.getProperty("/metaModel");return _(i,$2,a3,b3,Z2);}function R(i,j,k){var Z2=x(i,j)[k];if(Z2&&Z2.Criticality){return true;}}function U(i,j,k){var Z2=x(i,j)[k];var $2=Z2.Criticality.Path;return"{path:'"+$2+"'}";}function _(i,j,k,Z2,$2){if(!j||!j.Value){return"";}var _2=i.getSetting('ovpCardProperties');var a3=false;if(_2){var b3=_2.getProperty("/ignoreSapText");a3=b3==undefined?a3:b3;}var c3=Z2.getODataProperty(k,j.Value.Path);var d3=false;if(a3==true){if(c3&&(c3["com.sap.vocabularies.Analytics.v1.Measure"]||c3["sap:aggregation-role"]=="measure")){d3=true;}}if(!d3&&c3){var e3;if(c3["com.sap.vocabularies.Common.v1.Text"]){e3=c3["com.sap.vocabularies.Common.v1.Text"].String?c3["com.sap.vocabularies.Common.v1.Text"].String:c3["com.sap.vocabularies.Common.v1.Text"].Path;}else if(c3["sap:text"]){e3=c3["sap:text"];}if(e3){c3=Z2.getODataProperty(k,e3);j={Value:{Path:c3.name}};}}return V(i,j,$2);}function V(i,j,k,Z2){if(j.Value.Apply){return O.format(i,j.Value);}var $2=i.getSetting('ovpCardProperties');var _2=$2.getProperty("/entityType");var a3=$2.getProperty("/metaModel");return X(i,j,_2,a3,k,Z2);}V.requiresIContext=true;function W(i,j,k,Z2){if((!k)||(typeof Z2!=='string')){return Z2;}var $2=k[A.TEXT];if(!$2){return Z2;}var _2,a3;_2=k[A.TEXT_ARRANGEMENT];a3=_2&&_2.EnumMember;if(!a3){_2=$2&&$2[A.TEXT_ARRANGEMENT];a3=_2&&_2.EnumMember;}if(!a3){_2=j&&j[A.TEXT_ARRANGEMENT];a3=_2&&_2.EnumMember;}if(!a3){return Z2;}var b3=O.format(i,$2);if(!b3||b3===" "){return Z2;}var c3;switch(a3){case T.TEXT_FIRST:c3=b3+" ("+Z2+")";break;case T.TEXT_LAST:c3=Z2+" ("+b3+")";break;case T.TEXT_ONLY:c3=b3;break;case T.TEXT_SEPARATE:c3=Z2+" ("+b3+")";break;default:c3=Z2;break;}return c3;}function X(j,k,Z2,$2,_2,a3,b3){if(k.Value.Apply){return O.format(j,k.Value);}var c3=k.Value.Path?k.Value.Path:k.Value.String;var d3=$2.getODataProperty(Z2,c3),e3="",f3;var g3=j.getSetting("ovpCardProperties");var h3=g3&&g3.getProperty("/contentFragment");if(!a3){if(k.Value.Path&&k.Value.Path.split("/").length>1){d3=d1($2,Z2,k.Value.Path);}if(!d3){return"";}if(d3["type"]==='Edm.DateTime'||d3["type"]==='Edm.DateTimeOffset'){var i3=g3&&g3.getProperty("/showDateInRelativeFormat");f3=a1("dateFormatFunction",i3,d3["type"]==='Edm.DateTime'?true:false);e3=Y([k.Value.Path?k.Value.Path:d3.name],f3);}else if((k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)||d3["scale"]){var j3=(k.ValueFormat&&k.ValueFormat.NumberOfFractionalDigits)?k.ValueFormat.NumberOfFractionalDigits.Int:0,k3;var l3=(k.ValueFormat&&k.ValueFormat.ScaleFactor&&k.ValueFormat.ScaleFactor.Decimal);if(d3["Org.OData.Measures.V1.ISOCurrency"]){k3=d3["Org.OData.Measures.V1.ISOCurrency"].Path?d3["Org.OData.Measures.V1.ISOCurrency"].Path:d3["Org.OData.Measures.V1.ISOCurrency"].String;}else if(d3["Org.OData.Measures.V1.Unit"]){k3=d3["Org.OData.Measures.V1.Unit"].Path?d3["Org.OData.Measures.V1.Unit"].Path:d3["Org.OData.Measures.V1.Unit"].String;}else if(d3["sap:unit"]){k3=d3["sap:unit"];}var m3=k3?$2.getODataProperty(Z2,k3):null,n3=[k.Value.Path?k.Value.Path:d3.name];if(j3>2){j3=2;}if(d3["Org.OData.Measures.V1.ISOCurrency"]){var o3=d3["Org.OData.Measures.V1.ISOCurrency"];if(o3.Path){f3=b1(j3,l3);n3.push(o3.Path);}else if(o3.String){f3=b1(j3,o3.String,l3);}}else if(m3&&(m3["Org.OData.Measures.V1.ISOCurrency"]||m3["sap:semantics"]==="currency-code")){f3=b1(j3,l3);n3.push(k3);}else{f3=Z(j3,l3);}e3=Y(n3,f3);}else{if(b3){e3=O.simplePath(j,k.Value);}else{var p3=O.format(j.getModel()?j:j.getInterface(0),k.Value);var q3=p3.split(",");var r3=[];if(q3.length>1){for(var i=0;i<q3.length;i++){if(q3[i].indexOf("path:")>=0||q3[i].indexOf("type:")>=0){r3.push(q3[i]);}}if(r3.length>0){e3=e3+r3.join(',');if(e3.substring(e3.length-1)!=="}"){e3=e3+"}";}}}else{e3=p3;}}}if(h3){e3=W(j,Z2,d3,e3);}if(d3["Org.OData.Measures.V1.Unit"]){var s3=d3["Org.OData.Measures.V1.Unit"];if(s3.Path){e3+=(" "+Y([s3.Path]));}else if(s3.String){if(s3.String!=="%"){e3+=" ";}e3+=s3.String;}}}if(!_2){if(d3["Org.OData.Measures.V1.ISOCurrency"]){var o3=d3["Org.OData.Measures.V1.ISOCurrency"];if(o3.Path){e3+=(" "+Y([o3.Path]));}else if(o3.String){e3+=(" "+o3.String);}}}if(e3[0]===" "){e3=e3.substring(1);}return e3;}function Y(j,k){var Z2="",$2=j.length;if($2>1){Z2="{parts:[";for(var i=0;i<$2;i++){Z2+=("{path: '"+j[i]+"'}"+((i===$2-1)?"]":", "));}}else{Z2="{path: '"+j[0]+"'";}Z2+=(k?(", formatter: '"+k+"'"):"")+"}";return Z2;}function Z(i,j){var k="formatNumberCalculation"+i;if(!c[k]){c[k]=$(Number(i),j);}return"sap.ovp.cards.AnnotationHelper.NumberFormatFunctions."+k;}function $(i,j){return function(k){var Z2=N.getFloatInstance({style:'short',showMeasure:false,shortRefNumber:j,minFractionDigits:i,maxFractionDigits:i});return Z2.format(Number(k));};}function a1(i,j,k){var Z2={'relative':true,'relativeScale':'auto'};if(j!==undefined&&!j){Z2={'style':'medium'};}if(!d[i]){d[i]=function($2){var _2=D.getInstance(Z2);if(!$2){$2="";return $2;}return _2.format(new Date($2),k);};}return"sap.ovp.cards.AnnotationHelper.DateFormatFunctions."+i;}function b1(i,j,k){var Z2="formatCurrencyCalculation"+(j?j+i:i);if(!e[Z2]){e[Z2]=c1(i,j,k);}return"sap.ovp.cards.AnnotationHelper.CurrencyFormatFunctions."+Z2;}function c1(i,j,k){return function(Z2,$2){var _2="";var a3=N.getCurrencyInstance({style:'short',showMeasure:false,shortRefNumber:k,minFractionDigits:i,maxFractionDigits:i});if($2){_2=a3.format(Z2,$2);}else{_2=j?a3.format(Z2,j):a3.format(Z2);}return _2;};}function d1(j,k,Z2){var $2=Z2.split("/");if($2.length>1){for(var i=0;i<($2.length-1);i++){var _2=j.getODataAssociationEnd(k,$2[i]);if(_2){k=j.getODataEntityType(_2.type);}}return j.getODataProperty(k,$2[$2.length-1]);}}function e1(i,j,k){var Z2=x(i,j);var $2=g.StateValues;var _2=Z2[k];if(!_2){return $2.None;}if(_2.Criticality){return i1(i,_2,$2);}return k1(i,_2,$2);}function f1(i,j,k){var Z2=x(i,j);if(Z2&&Z2.length){var $2=Z2[0];if($2&&($2.Criticality||$2.CriticalityCalculation)){return true;}}return false;}function g1(i,j,k){if(f1(i,j,k)){return'';}return'#5cbae6';}g1.requiresIContext=true;function h1(i,j,k){var Z2=x(i,j),$2=g.ColorValues;var _2=$2.None;if(Z2.length>k){var a3=Z2[k];if(a3&&a3.Criticality){_2=i1(i,a3,$2);}else{_2=k1(i,a3,$2);}}return _2;}function i1(i,j,k){var Z2=k.None;var $2;var _2=j.Criticality;if(_2){$2="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+k.Negative+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+k.Critical+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+k.Positive+"'' : "+"''"+k.None+"'' '}'";if(_2.Path){var a3='$'+O.simplePath(i,_2);Z2=q.sap.formatMessage($2,a3);}else if(_2.EnumMember){var b3="'"+_2.EnumMember+"'";Z2=q.sap.formatMessage($2,b3);}else{q.sap.log.warning("Case not supported, returning the default Neutral state");}}else{q.sap.log.warning("Case not supported, returning the default Neutral state");}return Z2;}function j1(i,j,k){var Z2=x(i,j);var $2="None";if(Z2.length>k){var _2=Z2[k];if(_2&&_2.Criticality&&_2.Criticality.Path){$2=U(i,j,k);}else{$2=k1(i,_2,g.StateValues);$2=r($2);}}return $2;}function k1(i,j,k){var Z2=k.None;if(j.Criticality){Z2=p(j.Criticality,k);}else if(j.CriticalityCalculation&&j.Value&&j.Value&&j.Value.Path){Z2=l1(i,j,k);}return Z2;}function l1(i,j,k){var Z2=C1(j.Value);var $2=j.CriticalityCalculation.ImprovementDirection.EnumMember;var _2=C1(j.CriticalityCalculation.DeviationRangeLowValue);var a3=C1(j.CriticalityCalculation.DeviationRangeHighValue);var b3=C1(j.CriticalityCalculation.ToleranceRangeLowValue);var c3=C1(j.CriticalityCalculation.ToleranceRangeHighValue);var d3=m1(_2);var e3=m1(a3);var f3=m1(b3);var g3=m1(c3);var h3="parts: ["+Z2;h3+=d3?","+_2:"";h3+=e3?","+a3:"";h3+=f3?","+b3:"";h3+=g3?","+c3:"";h3+="]";var i3=function(){var k3=1;return u(arguments[0],$2,d3?arguments[k3++]:_2,e3?arguments[k3++]:a3,f3?arguments[k3++]:b3,g3?arguments[k3++]:c3,k);};var j3=n(i3,"formatCriticalityCalculation");return"{"+h3+", formatter: '"+j3+"'}";}function m1(i){return(typeof i==="string")&&i.charAt(0)==="{";}function n1(j,k,Z2){var $2="";var _2=Z2.split("/");if(_2.length>1){for(var i=0;i<(_2.length-1);i++){var a3=j.getODataAssociationEnd(k,_2[i]);if(a3){k=j.getODataEntityType(a3.type);if($2){$2=$2+"/";}$2=$2+_2[i];}else{return $2;}}}return $2;}function o1(i){var j;if(i&&typeof i.getData==='function'){var k=i.getData();if(k.tabs){var Z2=0;var $2=k.selectedKey;if($2&&k.tabs.length>=$2){Z2=$2-1;}j=k.tabs[Z2].mFilterPreference;}else{j=k.mFilterPreference;}}return!!j;}function p1(j,k){var Z2=j.getSetting('ovpCardProperties');var $2=Z2.getProperty("/addODataSelect");var _2=Z2.getProperty("/metaModel");var a3=_2.getODataEntityType(k.entityType);var b3=a3[Z2.getProperty('/selectionAnnotationPath')];var c3=a3[Z2.getProperty('/presentationAnnotationPath')];var d3="/"+k.name;var e3=Array.prototype.slice.call(arguments,2);var f3=j.getSetting('ovpCardProperties'),g3=f3.getProperty('/parameters');if(b3||!!g3){if((b3&&b3.Parameters&&b3.Parameters.length>0)||!!g3){d3=w2(j.getSetting('dataModel'),k,b3,g3);}}if(Z2.getProperty("/cardLayout")&&Z2.getProperty("/cardLayout/noOfItems")){var h3="{path: '"+d3+"', length: "+ +(Z2.getProperty("/cardLayout/noOfItems"));}else{var h3="{path: '"+d3+"', length: "+D1(Z2);}var i3=[];if($2){i3=r1(j,_2,a3,e3);var j3=Z2.getProperty("/template");if(j3!="sap.ovp.cards.charts.analytical"&&j3!="sap.ovp.cards.charts.smart.chart"){var k3=u1(c3);for(var i=0;i<k3.length;i++){if(!i3.includes(k3[i])){i3.push(k3[i]);}}}}var l3=q1(_2,a3,e3);var m3=o1(Z2);if(m3||i3.length>0||l3.length>0){h3=h3+", parameters: {";}if(i3.length>0||l3.length>0){if(i3.length>0){h3=h3+"select: '"+i3.join(',')+"'";}if(l3.length>0){if(i3.length>0){h3=h3+", ";}h3=h3+"expand: '"+l3.join(',')+"'";}if(m3){h3=h3+", ";}}if(m3){h3=h3+"custom: {cardId: '"+Z2.getProperty("/cardId")+"'}";}if(m3||i3.length>0||l3.length>0){h3=h3+"}";}var n3=t1(Z2,c3);if(n3.length>0){h3=h3+", sorter:"+JSON.stringify(n3);}var o3=y1(Z2,b3);if(o3.length>0){h3=h3+", filters:"+JSON.stringify(o3);}h3=h3+"}";return h3;}p1.requiresIContext=true;function q1(k,Z2,$2){var _2=[];var a3,b3,c3,d3;for(var i=0;i<$2.length;i++){if(!$2[i]){continue;}a3=Z2.$path+"/"+$2[i];b3=k.createBindingContext(a3);c3=b3.getObject();c3=c3?c3:[];for(var j=0;j<c3.length;j++){if(c3[j].Value&&c3[j].Value.Path){d3=n1(k,Z2,c3[j].Value.Path);if(d3&&_2.indexOf(d3)===-1){_2.push(d3);}}}}return _2;}function r1(Z2,$2,_2,a3){var b3=[];var c3,d3,e3;for(var i=0;i<a3.length;i++){if(!a3[i]){continue;}c3=_2.$path+"/"+a3[i];d3=$2.createBindingContext(c3);var f3={};if(Z2&&Z2.bDummyContext){q.extend(f3,Z2,d3,true);}else{f3=Z2;}e3=d3.getObject();if(!e3){e3=[];}else if(q.isPlainObject(e3)){if(e3.Data){e3=e3.Data;}else{e3=[];}}var g3;var h3;var i3;var j3;for(var j=0;j<e3.length;j++){h3=[];g3=e3[j];i3="";j3=g3.RecordType;if(j3==="com.sap.vocabularies.UI.v1.DataField"){i3=X(f3,g3,_2,$2,undefined,undefined,true);}else if(j3==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){var k3=E(_2.$path,g3);i3=_(f3,$2.getProperty(k3),_2,$2);var l3=B($2.getProperty(k3));if(l3&&l3.length>0){i3+=l3;}}else if(j3==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"&&g3.Url){var m3;if(!g3.Url.UrlRef){m3=O.format(f3,g3.Url);}if(m3&&m3.substring(0,2)==="{="){i3=m3;}}if(i3){var n3=O.simplePath(f3,g3.Value);if(i3.indexOf("(")<0&&i3!==n3){i3=[].concat(n3,i3).join(" ");}h3=s1(i3);}if(h3&&h3.length>0){var o3;for(var k=0;k<h3.length;k++){o3=h3[k];if(!b3[o3]){b3[o3]=true;var p3=C.getUnitColumn(o3,_2);if(p3&&p3!==o3){b3[p3]=true;}var q3=X2($2,_2,o3);if(q3&&q3!==o3){b3[q3]=true;}}}}}}return Object.keys(b3);}function s1(j){var i,k=0,Z2=j.length,$2="",_2;for(i=0;i<Z2;i++){_2=j.charAt(i);if(!_2){return;}switch(_2){case"{":k++;break;case"}":k--;break;default:if(k<=0){continue;}break;}$2+=_2;}j=$2;var a3=/\${([a-zA-Z0-9\_|\/]*)/g;var b3=/[^[{]*[a-zA-Z0-9\_]/g;var c3=/path *\: *\'([a-zA-Z0-9\_]+)*\'/g;var d3,e3,f3=[];if(j.indexOf("{parts:[")!==-1){j=j.replace("{parts:[","");}if(j.substring(0,2)==="{="){d3=a3;e3=1;}else if(j.indexOf("path")!==-1){var g3=b3.exec(j);while(g3){if(g3[0].indexOf("path")===-1&&g3[0].indexOf("@i18n")!==0){f3.push(g3[0]);}g3=b3.exec(j);}d3=c3;e3=1;}else{d3=b3;e3=0;}var h3=d3.exec(j);while(h3){if(h3[e3]&&h3[e3].indexOf("@i18n")!==0){f3.push(h3[e3]);}h3=d3.exec(j);}return f3;}function t1(j,k){var Z2=[];var $2,_2;var a3=j.getProperty("/sortBy");if(a3){var b3=j.getProperty('/sortOrder');if(b3&&b3.toLowerCase()!=='descending'){_2=false;}else{_2=true;}$2={path:a3,descending:_2};Z2.push($2);}var c3=k&&k.SortOrder||undefined;var d3,a3;if(c3){for(var i=0;i<c3.length;i++){d3=c3[i];a3=d3.Property.PropertyPath;_2=z1(d3.Descending,true);$2={path:a3,descending:_2};Z2.push($2);}}return Z2;}function u1(j){var k=[];var Z2=j&&j.RequestAtLeast||undefined;if(Z2){for(var i=0;i<Z2.length;i++){if(Z2[i].PropertyPath){k.push(Z2[i].PropertyPath);}}}return k;}function v1(i){var j=i.getProperty('/entityType');var k=j[i.getProperty('/selectionAnnotationPath')];return{filters:y1(i,k),parameters:x1(k)};}function w1(j){if(!j){return;}var k=j.getProperty('/entityType');var Z2=k[j.getProperty('/presentationAnnotationPath')];var $2=t1(j,Z2);var _2=[];var i,a3=$2.length;for(i=0;i<a3;i++){if(!$2[i].path){continue;}_2.push({Property:$2[i].path,Descending:$2[i].descending});}if(_2.length>0){return{SortOrder:_2};}}function x1(j){var k,Z2=[];if(!j||!j.Parameters){return Z2;}var $2=j.Parameters.length;for(var i=0;i<$2;i++){k=j.Parameters[i];if(!k.PropertyName||!k.PropertyName.PropertyPath){continue;}if(!k.PropertyValue){q.sap.log.error("Missing value for parameter "+k.PropertyName.PropertyPath);continue;}Z2[Z2.length]={path:k.PropertyName.PropertyPath,value:B1(k.PropertyValue)};}return Z2;}function y1(k,Z2){var $2=[];var _2;var a3=k.getProperty("/filters");if(a3){$2=$2.concat(a3);}if(Z2&&Z2.SelectOptions){_2=Z2.SelectOptions;}else{_2=Z2;}var b3,c3,d3;if(_2){for(var i=0;i<_2.length;i++){b3=_2[i];c3=b3.PropertyName.PropertyPath;for(var j=0;j<b3.Ranges.length;j++){d3=b3.Ranges[j];if(d3.Sign.EnumMember){var e3={path:c3,operator:d3.Option.EnumMember.split("/")[1],value1:B1(d3.Low),value2:B1(d3.High),sign:d3.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"?"I":"E"};if(e3.sign==="E"&&e3.operator!==F.EQ){q.sap.log.error("Exclude sign is supported only with EQ operator");continue;}if(e3.sign==="E"&&e3.operator===F.EQ){e3.operator=F.NE;e3.sign="I";}if(e3.operator==="CP"&&e3.sign==="I"){var f3=F.Contains;var g3=e3.value1;if(g3){var h3=g3.indexOf('*');var i3=g3.lastIndexOf('*');if(h3>-1){if((h3===0)&&(i3!==(g3.length-1))){f3=F.EndsWith;g3=g3.substring(1,g3.length);}else if((h3!==0)&&(i3===(g3.length-1))){f3=F.StartsWith;g3=g3.substring(0,g3.length-1);}else{g3=g3.substring(1,g3.length-1);}}}e3.operator=f3;e3.value1=g3;}$2.push(e3);}}}}return $2;}function z1(i,j){if(i&&i.Boolean){if(i.Boolean.toLowerCase()==="true"){return true;}else if(i.Boolean.toLowerCase()==="false"){return false;}}else if(i&&i.Bool){if(i.Bool.toLowerCase()==="true"){return true;}else if(i.Bool.toLowerCase()==="false"){return false;}}return j;}function A1(i){var j;if(i){if(i.String){j=Number(i.String);}else if(i.Int){j=Number(i.Int);}else if(i.Decimal){j=Number(i.Decimal);}else if(i.Double){j=Number(i.Double);}else if(i.Single){j=Number(i.Single);}}return j;}function B1(i){var j;if(i){if(i.String||i.String===""){j=i.String;}else if(i.Boolean||i.Bool){j=z1(i);}else if(i.DateTime){j=i.DateTime;}else if(i.DateTimeOffset){j=i.DateTimeOffset;}else{j=A1(i);}}return j;}function C1(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return B1(i);}}else{return"";}}function D1(i){var j=i.getProperty('/contentFragment');var k=i.getProperty('/listType');var Z2=i.getProperty('/listFlavor');var $2;var _2="desktop";if(a.system.phone){_2="phone";}else if(a.system.tablet){_2="tablet";}if(j=="sap.ovp.cards.list.List"){if(k=="extended"){if(Z2=="bar"){$2=I["List_extended_bar"];}else{$2=I["List_extended"];}}else if(Z2=="bar"){$2=I["List_condensed_bar"];}else{$2=I["List_condensed"];}}else if(j=="sap.ovp.cards.table.Table"){$2=I["Table"];}else if(j=="sap.ovp.cards.stack.Stack"){if(i.getProperty('/objectStreamCardsNavigationProperty')){$2=I["Stack_complex"];}else{$2=I["Stack_simple"];}}if($2){return $2[_2];}return 5;}function E1(i){var j=i.getObject();var k=x(i,j,true);var Z2=k.map(function($2){if($2&&$2.Value&&$2.Value.Path){return $2.Value.Path;}else if($2&&$2.fn&&$2.fn.Path){return $2.fn.Path;}});j.filter(function($2,_2){if($2.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&Z2.indexOf($2.Value.Path)>-1){j.splice(_2,1);}});}E1.requiresIContext=true;function F1(i,j){if(j.charAt(0)==='/'||j.indexOf("http")===0){return j;}var k=i.getModel(0).getProperty("/baseUrl");if(k){return k+"/"+j;}return j;}F1.requiresIContext=true;function G1(i,j){var k=x(i,j);return k.length;}G1.requiresIContext=true;function H1(i,j){return J1(i,j,0);}H1.requiresIContext=true;function I1(i,j){return J1(i,j,1);}I1.requiresIContext=true;function J1(i,j,k){var Z2=x(i,j),$2=Z2[k];if($2&&$2.Value&&$2.Value.Path){return $2.Value.Path;}return"";}function K1(i,j){return L(i,j,0);}K1.requiresIContext=true;function L1(i,j){return L(i,j,1);}L1.requiresIContext=true;function M1(i,j){return L(i,j,2);}M1.requiresIContext=true;function N1(i,j){return L(i,j,3);}N1.requiresIContext=true;function O1(i,j){return L(i,j,4);}O1.requiresIContext=true;function P1(i,j,k){return K(i,j,k);}P1.requiresIContext=true;function Q1(i,j,k){return Q(i,j,k);}Q1.requiresIContext=true;function R1(i,j,k,Z2){var $2=G1(i,j);if($2>0){return Q1(i,j,k);}else{return P1(i,j,Z2);}}R1.requiresIContext=true;function S1(i,j,k){return l2(i,j,k);}S1.requiresIContext=true;function T1(i,j){return M(i,j,0);}T1.requiresIContext=true;function U1(i,j){return M(i,j,1);}U1.requiresIContext=true;function V1(i,j){return M(i,j,2);}V1.requiresIContext=true;function W1(i,j){return P(i,j,0);}W1.requiresIContext=true;function X1(j,k){for(var i=0;i<k.length;i++){var Z2=k[i];if(Z2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){if(Z2.IconUrl&&Z2.IconUrl.String){return Z2.IconUrl.String;}if(Z2.IconUrl&&Z2.IconUrl.Path){return O.simplePath(j,Z2.IconUrl);}}}}X1.requiresIContext=true;function Y1(i,j,k){var Z2="";var $2;if(q.isArray(j)){$2=x(i,j)[k];}else{var _2=q.extend({},j);var a3=q.extend({},i);$2=j2(a3,_2);}if(!$2||!$2.Value){return Z2;}var b3=i.getSetting('ovpCardProperties');var c3=b3&&b3.getProperty("/entityType");var d3=b3&&b3.getProperty("/metaModel");var e3=d3&&d3.getODataProperty(c3,$2.Value.Path);var f3=e3&&e3["Org.OData.Measures.V1.ISOCurrency"];if(f3&&f3.Path){Z2+=(" "+Y([f3.Path]));}else if(f3&&f3.String){Z2+=(" "+f3.String);}return Z2;}Y1.requiresIContext=true;function Z1(i,j,k,Z2){return Q(i,j,k,Z2);}Z1.requiresIContext=true;function $1(i,j){return e1(i,j,0);}$1.requiresIContext=true;function _1(i,j){return h1(i,j,0);}_1.requiresIContext=true;function a2(i,j){return e1(i,j,1);}a2.requiresIContext=true;function b2(i,j){return e1(i,j,2);}b2.requiresIContext=true;function c2(i,j){return j1(i,j,0);}c2.requiresIContext=true;function d2(i){var j={};j.EnumMember="None";if(Number(i)===1){j.EnumMember="Negative";}else if(Number(i)===2){j.EnumMember="Critical";}else if(Number(i)===3){j.EnumMember="Positive";}return p(j,g.ColorValues);}function e2(i,j){if(j&&j.Criticality&&j.Criticality.Path){return"{parts: [{path:'"+j.Criticality.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.kpiValueCriticality'}";}else{return k1(i,j,g.ColorValues);}}e2.requiresIContext=true;function f2(i,j){return R(i,j,0);}f2.requiresIContext=true;function g2(i,j){var k=x(i,j)[0];if(k&&(k.Criticality||k.CriticalityCalculation)){return true;}return false;}g2.requiresIContext=true;function h2(i,j){return R(i,j,1);}h2.requiresIContext=true;function i2(i,j){return R(i,j,2);}i2.requiresIContext=true;function j2(i,j){var k=i.getPath(0);var Z2=k.slice(0,k.lastIndexOf("/"));Z2=Z2.slice(0,Z2.lastIndexOf("/"));var $2=E(Z2,j);j=i.getModel(0).getProperty($2);return j;}function k2(i,j){if(!j){return"";}return V(i,j);}k2.requiresIContext=true;function l2(j,k,Z2,$2){var _2;var a3=$2==undefined?Z2:w(j,Z2)[$2];var b3=j.getSetting('ovpCardProperties');var c3=b3.getProperty("/metaModel");var d3=c3.getODataEntityType(k.entityType);var e3=d3.property;if(e3){for(var i=0;i<e3.length;i++){if(a3.Value.Path===e3[i].name){_2=e3[i]["com.sap.vocabularies.Common.v1.SemanticObject"];if(_2){return O.format(j,_2);}else{return"";}}}}}function m2(i,j,k){var Z2=k===undefined?j.Value.Path:j[k].Value.Path;var $2=(Z2.indexOf("/")!=-1)?Z2.split('/')[0]:"";return $2;}m2.requiresIContext=true;function n2(i,j){var k=i.getSetting('ovpCardProperties');var Z2=k.getProperty("/metaModel");var $2=Z2.getODataEntityType(j.entityType);if($2["com.sap.vocabularies.Communication.v1.Contact"]){return true;}return false;}n2.requiresIContext=true;function o2(i,j,k){if(!j){return"";}var Z2=i.getSetting('ovpCardProperties');var $2=Z2.getProperty("/entityType");var _2=Z2.getProperty("/metaModel");var a3=q.extend({},j);var b3=q.extend({},i);j=j2(b3,a3);return _(i,j,$2,_2,k);}o2.requiresIContext=true;function p2(i,j){var k=q.extend({},j);var Z2=q.extend({},i);var $2="None",_2=g.StateValues;j=j2(Z2,k);if(j&&j.Criticality){$2=i1(i,j,_2);}else{$2=k1(i,j,_2);}return $2;}p2.requiresIContext=true;function q2(i,j){var k=q.extend({},j);var Z2=q.extend({},i);j=j2(Z2,k);if(j&&j.Criticality){return true;}}q2.requiresIContext=true;function r2(i,j){var k=q.extend({},j);var Z2=q.extend({},i);var $2=i.getSetting('ovpCardProperties');var _2=$2.getProperty("/entityType");var a3=$2.getProperty("/metaModel");j=j2(Z2,k);if(!j){return;}var b3=a3.getODataProperty(_2,j.Value.Path);if(j&&b3&&b3.type=="Edm.String"&&(j.Criticality||j.CriticalityCalculation)){return true;}}r2.requiresIContext=true;function s2(i,j){var k=q.extend({},j);var Z2=q.extend({},i);j=j2(Z2,k);var $2="None";if(j&&j.Criticality&&j.Criticality.Path){$2="{path:'"+j.Criticality.Path+"'}";}else{$2=k1(i,j,g.StateValues);$2=r($2);}return $2;}s2.requiresIContext=true;function t2(j,k){var Z2;for(var i=0;i<k.length;i++){Z2=k[i];if(Z2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||Z2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||Z2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){return 1;}}return 0;}t2.requiresIContext=true;function u2(i,j){var k=x(i,j)[0];if(k&&k.Value&&k.Value.Path){var Z2=i.getPath(0).substr(0,i.getPath(0).lastIndexOf("/")+1);var $2=i.getModel(0);var _2=$2.getProperty(Z2);var a3=$2.getODataProperty(_2,k.Value.Path);if(a3&&a3["Org.OData.Measures.V1.Unit"]){return a3["Org.OData.Measures.V1.Unit"].String==="%";}}return false;}u2.requiresIContext=true;function v2(i){var j=i.getObject();var k=i.getModel();var Z2=k.getProperty("/metaModel");var $2=Z2.getODataEntitySet(k.getProperty("/entitySet"));var _2=Z2.getODataEntityType($2.entityType);j=_2.$path+"/"+j;return Z2.createBindingContext(j);}function w2(j,k,Z2,$2,_2){var a3="";var b3=new o.Model(o.Model.ReferenceByModel(j));var c3=b3.findQueryResultByName(k.name);if(!c3){a3="/"+k.name;return a3;}var d3=new o.QueryResultRequest(c3);var e3=c3.getParameterization();if(!e3){a3="/"+k.name;return a3;}if(_2){var f3=_2.getAnalyticalParameters();}if(e3){var g3;d3.setParameterizationRequest(new o.ParameterizationRequest(e3));if(Z2&&Z2.Parameters){q.each(Z2.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){g3=this.PropertyNameFrom.PropertyPath.split("/");d3.getParameterizationRequest().setParameterValue(g3[g3.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{g3=this.PropertyName.PropertyPath.split("/");d3.getParameterizationRequest().setParameterValue(g3[g3.length-1],this.PropertyValue.String);}});}else if($2){q.each($2,function(){d3.getParameterizationRequest().setParameterValue(this.path,this.value);});}else if(f3&&f3.length>0){var h3=_2&&_2.getUiState({allFilters:false});var i3=h3?JSON.stringify(h3.getSelectionVariant()):"{}";var Z2=new S(i3);for(var j3 in e3.getAllParameters()){for(var i=0;i<f3.length;i++){if(f3[i]&&(f3[i].name==j3)){var k3=f3[i].name;var l3=Z2.getParameter(k3);if(!l3){var m3=Z2.getSelectOption(k3);l3=m3&&m3[0]&&m3[0].Low;}d3.getParameterizationRequest().setParameterValue(j3,l3);}}}}else{a3="/"+k.name;q.sap.log.error("SelectionParameters","There are no parameters to resolve");return a3;}}try{a3=d3.getURIToQueryResultEntitySet();}catch(n3){c3=d3.getQueryResult();a3="/"+c3.getEntitySet().getQName();q.sap.log.error("getEntitySetPathWithParameters","binding path with parameters failed - "+n3||n3.message);}return a3;}function x2(j,k,ns){var Z2=j.getServiceMetadata().dataServices.schema[0].association;for(var i=0;i<Z2.length;i++){if(ns+"."+Z2[i].name===k){return Z2[i];}}}function y2(i,j){var k=i.filter(function($2){if($2.RecordType==="com.sap.vocabularies.UI.v1.DataField"){return true;}return false;});var Z2=H(k);if(Z2){return Z2[j];}return;}function z2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=y2(k,0);return l2(i,j,k);}z2.requiresIContext=true;function A2(i,j,k){if(!k||!k.length||k.length===0){return false;}k=y2(k,1);return l2(i,j,k);}A2.requiresIContext=true;function B2(i,j){var k=i.filter(function($2){if($2.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&$2.Target.AnnotationPath.indexOf("@com.sap.vocabularies.Communication.v1.Contact")!==-1){return true;}return false;});var Z2=H(k);if(Z2){return Z2[j];}return;}function C2(i){if(!i||!i.length||i.length===0){return false;}var j=B2(i,0);if(j){return true;}return false;}function D2(i,j,k,Z2){var $2,_2,a3;if(k&&k.Value&&k.Value.Path){$2=k.Value.Path;}else if(k&&k.Description&&k.Description.Value&&k.Description.Value.Path){$2=k.Description.Value.Path;}if(k&&k.Description&&k.Description.Path){_2=k.Description.Path;}else if(k&&k.Title&&k.Title.Path){a3=k.Title.Path;}var b3="";var c3=Z2&&Z2.Parameters;var d3="";var e3=i.getSetting('ovpCardProperties'),f3=e3.getProperty('/parameters');c3=c3||!!f3;if(c3){var g3=i.getSetting("dataModel");var h3=w2(g3,j,Z2,f3);b3+="{path: '"+h3+"'";}else{b3+="{path: '/"+j.name+"'";}b3+=", length: 1";var i3=i.getSetting('ovpCardProperties');var j3=i3.getProperty("/entityType");var k3=C.getUnitColumn($2,j3);var l3=y1(i3,Z2);if(l3.length>0){d3+=", filters: "+JSON.stringify(l3);}var m3=[];m3.push($2);if(_2){m3.push(_2);}else if(a3){m3.push(a3);}if(k&&k.Criticality&&k.Criticality.Path){m3.push(k.Criticality.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeLowValue&&k.CriticalityCalculation.DeviationRangeLowValue.Path){m3.push(k.CriticalityCalculation.DeviationRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeLowValue&&k.CriticalityCalculation.ToleranceRangeLowValue.Path){m3.push(k.CriticalityCalculation.ToleranceRangeLowValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.DeviationRangeHighValue&&k.CriticalityCalculation.DeviationRangeHighValue.Path){m3.push(k.CriticalityCalculation.DeviationRangeHighValue.Path);}if(k&&k.CriticalityCalculation&&k.CriticalityCalculation.ToleranceRangeHighValue&&k.CriticalityCalculation.ToleranceRangeHighValue.Path){m3.push(k.CriticalityCalculation.ToleranceRangeHighValue.Path);}if(k3){m3.push(k3);}if(k&&k.TrendCalculation&&k.TrendCalculation.ReferenceValue&&k.TrendCalculation.ReferenceValue.Path){m3.push(k.TrendCalculation.ReferenceValue.Path);}var n3=o1(e3);var o3=n3?", custom: {cardId: '"+e3.getProperty("/cardId")+"'}":"";return b3+", parameters:{select:'"+m3.join(",")+"'"+o3+"}"+d3+"}";}D2.requiresIContext=true;function E2(k){if(isNaN(k)){return k;}var i,j,Z2=false;if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits){i=Number(this.oPropagatedProperties.oModels.ovpCardProperties.oData.NumberOfFractionalDigits);}if(this.oPropagatedProperties.oModels.ovpCardProperties.oData.percentageAvailable){Z2=true;}if(!i||i<0){i=0;}else if(i>2){i=2;}j=k;if(k){var $2=N.getFloatInstance({minFractionDigits:i,maxFractionDigits:i,style:"short",showScale:true,shortRefNumber:j});if(Z2){return $2.format(Number(k))+" %";}else{return $2.format(Number(k));}}}function F2(i){if(!i||!i.Value||!i.Value.Path){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var Z2=j.getProperty("/metaModel");var $2=Z2.getODataProperty(k,i.Value.Path);if($2["Org.OData.Measures.V1.Unit"]){var _2=$2["Org.OData.Measures.V1.Unit"];if(_2.String=="%"){this.getModel("ovpCardProperties").oData.percentageAvailable=true;}}return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.KpiValueFormatter'}";}function G2(i,j,k){if(!j||!j.Value||!j.Value.Path||!j.TrendCalculation){return"";}var Z2=C1(j.Value);var $2=C1(j.TrendCalculation.ReferenceValue);var _2=C1(j.TrendCalculation.DownDifference);var a3=C1(j.TrendCalculation.UpDifference);var b3=m1($2);var c3=m1(_2);var d3=m1(a3);var e3="parts: ["+Z2;e3+=b3?","+$2:"";e3+=c3?","+_2:"";e3+=d3?","+a3:"";e3+="]";var f3=function(){var h3=1;return v(arguments[0],b3?arguments[h3++]:$2,c3?arguments[h3++]:_2,d3?arguments[h3++]:a3,k);};var g3=n(f3,"formatTrendDirection");return"{"+e3+", formatter: '"+g3+"'}";}G2.requiresIContext=true;function H2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){this.getModel("ovpCardProperties").oData.NumberOfFractionalDigits=i.ValueFormat.NumberOfFractionalDigits.Int;}if(i.TrendCalculation.ReferenceValue.Path){return"{parts: [{path:'"+i.Value.Path+"'}, {path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}else{return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.returnPercentageChange'}";}}function I2(k,i){var j,Z2,$2,_2,a3=false;if(isNaN(+k)){return"";}if(k==0){_2=i;}else{_2=k;}Z2=this.getModel('ovpCardProperties');if(Z2.getProperty("/iNumberOfFractionalDigits")){$2=+(Z2.getProperty("/iNumberOfFractionalDigits"));}if(Z2.getProperty("/bPercentageAvailableForTarget")){a3=true;}if(i){j=i;}else{if(Z2.getProperty("/sManifestTargetValue")){j=Z2.getProperty("/sManifestTargetValue");}}if(!$2||$2<0){$2=0;}else if($2>2){$2=2;}if(j){var b3=N.getFloatInstance({minFractionDigits:$2,maxFractionDigits:$2,style:"short",showScale:true,shortRefNumber:_2});if(a3){return b3.format(+(j))+" %";}else{return b3.format(+(j));}}}function J2(i){if(!i||!i.TrendCalculation||!i.TrendCalculation.ReferenceValue){return"";}if(!i||!i.Value||!i.Value.Path){return"";}var j=this.getModel('ovpCardProperties');var k=j.getProperty("/entityType");var Z2=j.getProperty("/metaModel");if(i&&i.ValueFormat&&i.ValueFormat.NumberOfFractionalDigits&&i.ValueFormat.NumberOfFractionalDigits.Int){j.setProperty("/iNumberOfFractionalDigits",i.ValueFormat.NumberOfFractionalDigits.Int);}if(i.TrendCalculation.ReferenceValue){if(i.TrendCalculation.ReferenceValue.String){j.setProperty("/sManifestTargetValue",i.TrendCalculation.ReferenceValue.String);return"{parts: [{path:'"+i.Value.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}if(i.TrendCalculation.ReferenceValue.Path){var $2=Z2.getODataProperty(k,i.TrendCalculation.ReferenceValue.Path);if($2["Org.OData.Measures.V1.Unit"]){var _2=$2["Org.OData.Measures.V1.Unit"];if(_2.String=="%"){j.setProperty("/bPercentageAvailableForTarget",true);}}return"{parts: [{path:'"+i.Value.Path+"'},{path:'"+i.TrendCalculation.ReferenceValue.Path+"'}], formatter: 'sap.ovp.cards.AnnotationHelper.TargetValueFormatter'}";}}}function K2(k,i){var j,Z2,$2;if(isNaN(+k)){return"";}k=+(k);$2=this.getModel('ovpCardProperties');if($2.getProperty("/iNumberOfFractionalDigits")){j=+($2.getProperty("/iNumberOfFractionalDigits"));}if(i){Z2=+(i);}else{if($2.getProperty("/sManifestTargetValue")){Z2=+($2.getProperty("/sManifestTargetValue"));}}if(!j||j<0){j=0;}else if(j>2){j=2;}if(Z2){var _2=((k-Z2)/Z2);var a3=N.getPercentInstance({style:'short',minFractionDigits:j,maxFractionDigits:j,showScale:true});return a3.format(_2);}}function L2(i){if(i&&i.GroupBy&&!(q.isEmptyObject(i.GroupBy))&&i.GroupBy[0].hasOwnProperty('PropertyPath')){return true;}else{return false;}}function M2(j,k){var Z2;for(var i=0;j&&i<j.length;i++){if(j[i].value==k){Z2=j[i];break;}}return Z2?Z2.name:null;}function N2(i,k){return M2(i,k);}function O2(i,k){var j=M2(i,k);return j?j:b.getText("OVP_KEYUSER_LABEL_NO_NAVIGATION");}function P2(i){var j="";var k=i&&i.GroupBy;if(!k){return j;}var Z2=this.getModel('ovpCardProperties').getProperty("/metaModel");var $2=this.getModel('ovpCardProperties').getProperty("/entityType");var _2;if(i.GroupBy.constructor===Array){_2=i.GroupBy;}else if(!i.GroupBy.Collection){return j;}else{_2=i.GroupBy.Collection;}var a3;q.each(_2,function(){a3=W2(Z2,$2,this.PropertyPath);if(!a3){return;}j+=a3;j+=", ";});if(j[j.length-1]===" "&&j[j.length-2]===","){j=j.substring(0,j.length-2);}return j==""?"":b.getText("By",[j]);}function Q2(i,j,k){var Z2=true;var $2=k["SelectOptions"].length-1;if(j.PropertyName.PropertyPath===k["SelectOptions"][$2].PropertyName.PropertyPath){Z2=false;}j=[j];var _2=i.getSetting('ovpCardProperties');var a3=_2.getProperty("/entityType");var b3=_2.getProperty("/metaModel");var c3=y1(_2,j);if(c3.length==0){return"";}var d3;var e3;d3=c3[0].path;e3=X2(b3,a3,d3);if(e3!==d3){return"";}var f3=b3.getODataProperty(a3,j[0].PropertyName.PropertyPath)["type"];var g3=U2(c3,f3);if(Z2===true){return g3+", ";}return g3;}Q2.requiresIContext=true;function R2(i,j,k){var Z2=!(j.index===(k.length-1));var $2=i.getSetting('ovpCardProperties');var _2=$2.getProperty("/metaModel");var a3=$2.getProperty("/entityType");var b3=_2.getODataProperty(a3,k[j.index].path)["type"];var c3=U2([k[j.index]],b3);if(Z2===true){return c3+", ";}return c3;}R2.requiresIContext=true;function S2(i){return i.id;}function T2(i){return i.id;}function U2(j,k){var Z2=[];for(var i=0;i<j.length;i++){Z2.push(V2(j[i],k));}return Z2.join(', ');}function V2(i,j){var k=false;var Z2,$2=D.getInstance({'style':'medium'});if(j==='Edm.DateTime'){Z2=$2.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){Z2=$2.format(new Date(i.value1),true);}else{Z2=i.value1;}if(i.operator[0]==="N"){k=true;}if(i.value2){if(j==='Edm.DateTime'){Z2+=" - "+$2.format(new Date(i.value1));}else if(j==='Edm.DateTimeOffset'){Z2+=" - "+$2.format(new Date(i.value1),true);}else{Z2+=" - "+i.value1;}}if(k){Z2=b.getText("kpiHeader_Filter_NotOperator",[Z2]);}return Z2;}function W2(i,j,k){return Y2(i,j,k,"com.sap.vocabularies.Common.v1.Label");}function X2(i,j,k){return Y2(i,j,k,"sap:text");}function Y2(i,j,k,Z2){var $2=i.getODataProperty(j,k);if(!$2){q.sap.log.error("No Property Found for with Name '"+k+" For Entity-Type '"+j.name+"'");return;}var _2=$2[Z2];if(_2){if(Z2==="com.sap.vocabularies.Common.v1.Label"){return _2.String;}return _2;}return $2.name;}return{NumberFormatFunctions:c,DateFormatFunctions:d,CurrencyFormatFunctions:e,formatFunctions:f,criticalityConstants:g,TextArrangementType:T,getLabelForDataItem:h,colorPaletteForComparisonMicroChart:g1,formatField:V,checkFilterPreference:o1,formatItems:p1,getCardSelections:v1,getCardSorters:w1,getFilters:y1,getPrimitiveValue:B1,getAnnotationLabel:N2,getApplicationName:O2,removeDuplicateDataField:E1,formatUrl:F1,getDataPointsCount:G1,getFirstDataPointValue:H1,getFirstDataFieldName:K1,getSecondDataFieldName:L1,getRequestFields:u1,getThirdDataFieldName:M1,formatDataFieldValueOnIndex:P1,formatDataPointValueOnIndex:Q1,formatDataPointOrField:R1,formatsemanticObjectOfDataFieldGeneric:S1,getLabelForFirstDataPoint:W1,formatImageUrl:X1,formatUnit:Y1,formatObjectNumber:Z1,formatFirstDataPointState:$1,formatFirstDataPointColor:_1,formatSecondDataPointState:a2,formatThirdDataPointState:b2,formatFirstDataPointStateForSmartField:c2,formatKPIHeaderState:e2,isFirstDataPointCriticality:f2,isFirstDataPointCriticalityForTableStatus:g2,getSortedDataFields:w,getSortedDataPoints:x,formatDataFieldValueGeneric:k2,formatDataPointValue:o2,formatDataPointStateGeneric:p2,checkCriticalityGeneric:q2,checkCriticalityGenericForTableStatus:r2,formatDataPointStateForSmartFieldGeneric:s2,hasActions:t2,isFirstDataPointPercentageUnit:u2,resolveEntityTypePath:v2,resolveParameterizedEntitySet:w2,getAssociationObject:x2,semanticObjectOfFirstDataField:z2,semanticObjectOfSecondDataField:A2,isFirstContactAnnotation:C2,getAggregateNumber:D2,KpiValueFormatter:E2,kpiValueCriticality:d2,formThePathForAggregateNumber:F2,formThePathForTrendIcon:G2,formPathForPercentageChange:H2,TargetValueFormatter:I2,formPathForTargetValue:J2,returnPercentageChange:K2,isPresentationVarientPresent:L2,listGroupBy:P2,formTheFilterByString:Q2,formTheFilterByStringNotFromSelVar:R2,formTheIdForFilter:S2,formTheIdForFilterNotFromSelVar:T2,_criticality2state:p,_calculateCriticalityState:u,_calculateTrendDirection:v,_getPropertiesFromBindingString:s1,sortCollectionByImportance:H,checkNavTargetForContactAnno:m2,checkForContactAnnotation:n2};},true);
